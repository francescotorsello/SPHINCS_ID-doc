<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Image caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state DD2-SF RDF 1.8 from the CompOSE database. The solution was computed with \texttt{LORENE}, and the particles placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>particles_apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>More</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>particles_apm 
    <small>Submodule</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a></li> 
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="10.2% of total for modules and submodules.">1156 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/submodule_particles_apm.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/submodule_particles_apm.f90.html'>submodule_particles_apm.f90</a></li>
    
  
     <li class="active">particles_apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/particles_apm.html#proc-correct_center_of_mass">correct_center_of_mass</a>
      
      <a class="list-group-item" href="../module/particles_apm.html#proc-get_neighbours_bf">get_neighbours_bf</a>
      
    </div>
  </div>
</div>





<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#modprocs-0">Module Procedures</a></h3></div>
  <div id="modprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/particles_apm.html#proc-perform_apm">perform_apm</a>
      
    </div>
  </div>
</div>







</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <p>This SUBMODULE contains the
  implementation of the method
  perform_apm of TYPE particles.</p>
<p>FT 04.06.2021</p>
<hr>
      <br>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      
      <li class="list-group-item">
  <ul class="list-inline">
    <li><h5>Ancestors:</h5></li>
    
    <li><a href='../module/particles_id.html'>particles_id</a></li>
    
    
  </ul>
      </li>
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: module~~particles_apm~~UsesGraph Pages: 1 -->
<svg id="moduleparticles_apmUsesGraph" width="370pt" height="94pt"
 viewBox="0.00 0.00 370.00 94.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="module~~particles_apm~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 90)">
<title>module~~particles_apm~~UsesGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-90 366,-90 366,4 -4,4"/>
<!-- module~particles_apm -->
<g id="module~~particles_apm~~UsesGraph_node1" class="node">
<title>module~particles_apm</title>
<polygon fill="none" stroke="#000000" points="362,-66 283,-66 283,-42 362,-42 362,-66"/>
<text text-anchor="middle" x="322.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">particles_apm</text>
</g>
<!-- module~particles_id -->
<g id="module~~particles_apm~~UsesGraph_node2" class="node">
<title>module~particles_id</title>
<g id="a_module~~particles_apm~~UsesGraph_node2"><a xlink:href=".././module/particles_id.html" xlink:title="particles_id">
<polygon fill="#337ab7" stroke="#337ab7" points="247,-66 180,-66 180,-42 247,-42 247,-66"/>
<text text-anchor="middle" x="213.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">particles_id</text>
</a>
</g>
</g>
<!-- module~particles_apm&#45;&gt;module~particles_id -->
<g id="module~~particles_apm~~UsesGraph_edge1" class="edge">
<title>module~particles_apm&#45;&gt;module~particles_id</title>
<path fill="none" stroke="#000000" d="M282.8402,-54C274.5313,-54 265.7243,-54 257.2754,-54"/>
<polygon fill="#000000" stroke="#000000" points="257.2046,-50.5001 247.2046,-54 257.2046,-57.5001 257.2046,-50.5001"/>
</g>
<!-- timing -->
<g id="module~~particles_apm~~UsesGraph_node3" class="node">
<title>timing</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-86 0,-86 0,-62 54,-62 54,-86"/>
<text text-anchor="middle" x="27" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">timing</text>
</g>
<!-- module~particles_id&#45;&gt;timing -->
<g id="module~~particles_apm~~UsesGraph_edge4" class="edge">
<title>module~particles_id&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M180.7214,-66.0601C169.2689,-69.6934 156.2199,-73.1941 144,-75 117.5123,-78.9143 87.2828,-78.5326 64.1871,-77.2411"/>
<polygon fill="#000000" stroke="#000000" points="64.32,-73.7426 54.1166,-76.5959 63.8723,-80.7283 64.32,-73.7426"/>
</g>
<!-- module~id_base -->
<g id="module~~particles_apm~~UsesGraph_node4" class="node">
<title>module~id_base</title>
<g id="a_module~~particles_apm~~UsesGraph_node4"><a xlink:href=".././module/id_base.html" xlink:title="id_base">
<polygon fill="#337ab7" stroke="#337ab7" points="144,-66 90,-66 90,-42 144,-42 144,-66"/>
<text text-anchor="middle" x="117" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">id_base</text>
</a>
</g>
</g>
<!-- module~particles_id&#45;&gt;module~id_base -->
<g id="module~~particles_apm~~UsesGraph_edge2" class="edge">
<title>module~particles_id&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M179.749,-54C171.5708,-54 162.78,-54 154.443,-54"/>
<polygon fill="#000000" stroke="#000000" points="154.2058,-50.5001 144.2058,-54 154.2057,-57.5001 154.2058,-50.5001"/>
</g>
<!-- module~utility -->
<g id="module~~particles_apm~~UsesGraph_node5" class="node">
<title>module~utility</title>
<g id="a_module~~particles_apm~~UsesGraph_node5"><a xlink:href=".././module/utility.html" xlink:title="utility">
<polygon fill="#337ab7" stroke="#337ab7" points="144,-24 90,-24 90,0 144,0 144,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utility</text>
</a>
</g>
</g>
<!-- module~particles_id&#45;&gt;module~utility -->
<g id="module~~particles_apm~~UsesGraph_edge3" class="edge">
<title>module~particles_id&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M185.847,-41.9645C175.869,-37.6217 164.4442,-32.6493 153.8069,-28.0196"/>
<polygon fill="#000000" stroke="#000000" points="154.8894,-24.6736 144.3234,-23.8921 152.0958,-31.0921 154.8894,-24.6736"/>
</g>
<!-- module~id_base&#45;&gt;timing -->
<g id="module~~particles_apm~~UsesGraph_edge5" class="edge">
<title>module~id_base&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M89.997,-60.0007C81.8842,-61.8035 72.8369,-63.814 64.1869,-65.7362"/>
<polygon fill="#000000" stroke="#000000" points="63.2976,-62.3484 54.295,-67.9345 64.8161,-69.1817 63.2976,-62.3484"/>
</g>
<!-- matrix -->
<g id="module~~particles_apm~~UsesGraph_node6" class="node">
<title>matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">matrix</text>
</g>
<!-- module~utility&#45;&gt;matrix -->
<g id="module~~particles_apm~~UsesGraph_edge6" class="edge">
<title>module~utility&#45;&gt;matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M89.997,-12C81.9723,-12 73.0335,-12 64.4691,-12"/>
<polygon fill="#000000" stroke="#000000" points="64.295,-8.5001 54.295,-12 64.2949,-15.5001 64.295,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="490pt" height="32pt"
 viewBox="0.00 0.00 489.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 485.5,-28 485.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="139.5,-24 72.5,-24 72.5,0 139.5,0 139.5,-24"/>
<text text-anchor="middle" x="106" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="222,-24 158,-24 158,0 222,0 222,-24"/>
<text text-anchor="middle" x="190" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="294,-24 240,-24 240,0 294,0 294,-24"/>
<text text-anchor="middle" x="267" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="366,-24 312,-24 312,0 366,0 366,-24"/>
<text text-anchor="middle" x="339" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="481.5,-24 384.5,-24 384.5,0 481.5,0 481.5,-24"/>
<text text-anchor="middle" x="433" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    

    
    

    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/particles_apm.html#proc-correct_center_of_mass">correct_center_of_mass</a>
      
      <a class="list-group-item" href="../module/particles_apm.html#proc-get_neighbours_bf">get_neighbours_bf</a>
      
    </div>
  </div>
</div>





<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#modprocs-1">Module Procedures</a></h3></div>
  <div id="modprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/particles_apm.html#proc-perform_apm">perform_apm</a>
      
    </div>
  </div>
</div>







    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    

    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-correct_center_of_mass"></span><h3>
subroutine <a href='../proc/correct_center_of_mass.html'>correct_center_of_mass</a>(npart_real, pos, nu, get_density, validate_pos, com_star, verbose)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Translate the particles so that their center of mass
  coincides with the center of mass of the star, given by
  LORENE</p><a href="../proc/correct_center_of_mass.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(3,npart_real)</td><td>::</td>
  <td><strong>pos</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(npart_real)</td><td>::</td>
  <td><strong>nu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
function get_density(x, y, z) result(density)
    
    
   
</h5>
    
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h6>Return Value <small>double precision
  </small></h6>
  
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
function validate_pos(x, y, z) result(answer)
    
    
   
</h5>
    
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h6>Return Value <small>integer
  </small></h6>
  
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>com_star</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>verbose</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_neighbours_bf"></span><h3>
subroutine <a href='../proc/get_neighbours_bf.html'>get_neighbours_bf</a>(ipart, npart, pos, h, dimensions, nnei, neilist)
    
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>just for test purposes: get neighbours of particle ipart in
  a "brute force" way; ipart is ALSO on the neighbour list;
  SKR 8.2.2010</p><a href="../proc/get_neighbours_bf.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ipart</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>pos</strong>(dimensions,npart)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>h</strong>(npart)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dimensions</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nnei</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>neilist</strong>(npart)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    </section>    
    <br>
    
    
    
    
        

        

        
        <section>
        <h2>Module Procedures</h2>
        
        
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-perform_apm"></span><h3>
module procedure <a href='../proc/perform_apm.html'>perform_apm</a> <small>module module subroutine perform_apm(get_density, get_nstar_p, pos_input, pvol, h_output, nu_output, center, com_star, mass, radx_comp, radx_opp, rady, radz, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, namefile_pos_id, namefile_pos, namefile_results, validate_position)</small>
    
    
   <a href='../interface/perform_apm.html'><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
    
   
</h3></div>
  <div class="panel-body">
       
    







<p>Compute the particle positions as follows:</p><a href="../proc/perform_apm.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
function get_density(x, y, z) result(density)
    
    
   
</h5>
    



<p>Returns the baryon mass density at the desired point</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h6>Return Value <small>double precision
  </small></h6>
  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
subroutine get_nstar_p(npart_real, x, y, z, nstar_p)
    
    
   
</h5>
    



<p>Computes the proper baryon number density at the particle positions</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong>(npart_real)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong>(npart_real)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong>(npart_real)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nstar_p</strong>(npart_real)</td><td><p>Array to store the computed proper baryon number density</p></td>
  
</tr>

</tbody>
</table>

      
    
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:,:)</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radx_comp</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radx_opp</strong></td><td><p>Radius of the star in the x direction, opposite to companion</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rady</strong></td><td><p>Radius of the star in the y direction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radz</strong></td><td><p>Radius of the star in the z direction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(validate_position_int),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

        
        </section>    
        
    
    
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2021 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
             on 2021-11-14 16:41:50 
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>