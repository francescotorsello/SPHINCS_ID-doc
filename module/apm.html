<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>More</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>apm 
    <small>Submodule</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 9.2% of total for modules and submodules.">1393 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/submodule_sph_particles_apm.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/submodule_sph_particles_apm.f90.html'>submodule_sph_particles_apm.f90</a></li>
     <li class="active">apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#types-0">Derived Types</a></h3></div>
  <div id="types-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/apm.html#type-apm_fields">apm_fields</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      <a class="list-group-item" href="../module/apm.html#proc-allocate_apm_fields">allocate_apm_fields</a>
      <a class="list-group-item" href="../module/apm.html#proc-correct_center_of_mass">correct_center_of_mass</a>
      <a class="list-group-item" href="../module/apm.html#proc-deallocate_apm_fields">deallocate_apm_fields</a>
      <a class="list-group-item" href="../module/apm.html#proc-get_neighbours_bf">get_neighbours_bf</a>
      <a class="list-group-item" href="../module/apm.html#proc-impose_equatorial_plane_symmetry_apm">impose_equatorial_plane_symmetry_apm</a>
      <a class="list-group-item" href="../module/apm.html#proc-reallocate_apm_fields">reallocate_apm_fields</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#modprocs-0">Module Procedures</a></h3></div>
  <div id="modprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/apm.html#proc-perform_apm">perform_apm</a>
    </div>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <hr>
<p>Copyright (C) 2020, 2021, 2022 Francesco Torsello                     *
                                                                       *
 This file is part of SPHINCS_ID                                       *
                                                                       *
 SPHINCS_ID is free software: you can redistribute it and/or modify    *
 it under the terms of the GNU General Public License as published by  *
 the Free Software Foundation, either version 3 of the License, or     *
 (at your option) any later version.                                   *
                                                                       *
 SPHINCS_ID is distributed in the hope that it will be useful,         *
 but WITHOUT ANY WARRANTY; without even the implied warranty of        *
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the          *
 GNU General Public License for more details.                          *
                                                                       *
 You should have received a copy of the GNU General Public License     *
 along with SPHINCS_ID. If not, see <a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.   *
 The copy of the GNU General Public License should be in the file      *
 'COPYING'.                                                            *</p>
<hr>
<p>This SUBMODULE contains the
  implementation of the method
  perform_apm of TYPE particles.</p>
<p>FT 04.06.2021</p>
<hr>
<br>        <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      <li class="list-group-item">
  <ul class="list-inline">
    <li>metric_on_particles</li>
    <li>gradient</li>
    <li><a href='../module/utility.html'>utility</a></li>
    <li>RCB_tree_3D</li>
    <li>sph_variables</li>
    <li>constants</li>
    <li>set_h</li>
  </ul>
      </li>
      <li class="list-group-item">
  <ul class="list-inline">
    <li><h5>Ancestors:</h5></li>
    <li><a href='../module/sph_particles.html'>sph_particles</a></li>
  </ul>
      </li>
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: module~~apm~~UsesGraph Pages: 1 -->
<svg id="moduleapmUsesGraph" width="395pt" height="322pt"
 viewBox="0.00 0.00 395.00 322.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="module~~apm~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 318)">
<title>module~~apm~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-318 391,-318 391,4 -4,4"/>
<!-- module~apm -->
<g id="module~~apm~~UsesGraph_node1" class="node">
<title>module~apm</title>
<polygon fill="none" stroke="black" points="387,-168 333,-168 333,-144 387,-144 387,-168"/>
<text text-anchor="middle" x="360" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50">apm</text>
</g>
<!-- metric_on_particles -->
<g id="module~~apm~~UsesGraph_node2" class="node">
<title>metric_on_particles</title>
<polygon fill="#337ab7" stroke="#337ab7" points="297,-314 180,-314 180,-290 297,-290 297,-314"/>
<text text-anchor="middle" x="238.5" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">metric_on_particles</text>
</g>
<!-- module~apm&#45;&gt;metric_on_particles -->
<g id="module~~apm~~UsesGraph_edge1" class="edge">
<title>module~apm&#45;&gt;metric_on_particles</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M356.21,-168.16C349.92,-192.88 332.37,-249.33 297,-281 295.52,-282.33 293.94,-283.58 292.29,-284.75"/>
<polygon fill="#000000" stroke="#000000" points="290.36,-281.83 283.59,-289.98 293.96,-287.83 290.36,-281.83"/>
</g>
<!-- gradient -->
<g id="module~~apm~~UsesGraph_node3" class="node">
<title>gradient</title>
<polygon fill="#337ab7" stroke="#337ab7" points="267.5,-272 209.5,-272 209.5,-248 267.5,-248 267.5,-272"/>
<text text-anchor="middle" x="238.5" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">gradient</text>
</g>
<!-- module~apm&#45;&gt;gradient -->
<g id="module~~apm~~UsesGraph_edge2" class="edge">
<title>module~apm&#45;&gt;gradient</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.88,-168.19C343.3,-186.12 323.12,-219.57 297,-239 291.08,-243.41 284.14,-246.97 277.17,-249.82"/>
<polygon fill="#000000" stroke="#000000" points="275.92,-246.54 267.74,-253.27 278.33,-253.12 275.92,-246.54"/>
</g>
<!-- module~sph_particles -->
<g id="module~~apm~~UsesGraph_node4" class="node">
<title>module~sph_particles</title>
<g id="a_module~~apm~~UsesGraph_node4"><a xlink:href=".././module/sph_particles.html" xlink:title="sph_particles">
<polygon fill="#337ab7" stroke="#337ab7" points="279.5,-230 197.5,-230 197.5,-206 279.5,-206 279.5,-230"/>
<text text-anchor="middle" x="238.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sph_particles</text>
</a>
</g>
</g>
<!-- module~apm&#45;&gt;module~sph_particles -->
<g id="module~~apm~~UsesGraph_edge8" class="edge">
<title>module~apm&#45;&gt;module~sph_particles</title>
<path fill="none" stroke="#000000" d="M343.05,-168.05C330.89,-176.87 313.48,-188.69 297,-197 293.47,-198.78 289.75,-200.49 285.98,-202.1"/>
<polygon fill="#000000" stroke="#000000" points="284.5,-198.93 276.55,-205.92 287.13,-205.41 284.5,-198.93"/>
</g>
<!-- RCB_tree_3D -->
<g id="module~~apm~~UsesGraph_node5" class="node">
<title>RCB_tree_3D</title>
<polygon fill="#337ab7" stroke="#337ab7" points="278.5,-188 198.5,-188 198.5,-164 278.5,-164 278.5,-188"/>
<text text-anchor="middle" x="238.5" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">RCB_tree_3D</text>
</g>
<!-- module~apm&#45;&gt;RCB_tree_3D -->
<g id="module~~apm~~UsesGraph_edge3" class="edge">
<title>module~apm&#45;&gt;RCB_tree_3D</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.78,-160.39C319.94,-162.54 304.04,-165.2 289.04,-167.71"/>
<polygon fill="#000000" stroke="#000000" points="288.12,-164.31 278.84,-169.42 289.28,-171.22 288.12,-164.31"/>
</g>
<!-- module~utility -->
<g id="module~~apm~~UsesGraph_node6" class="node">
<title>module~utility</title>
<g id="a_module~~apm~~UsesGraph_node6"><a xlink:href=".././module/utility.html" xlink:title="utility">
<polygon fill="#337ab7" stroke="#337ab7" points="144,-168 90,-168 90,-144 144,-144 144,-168"/>
<text text-anchor="middle" x="117" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility</text>
</a>
</g>
</g>
<!-- module~apm&#45;&gt;module~utility -->
<g id="module~~apm~~UsesGraph_edge4" class="edge">
<title>module~apm&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M332.76,-155.48C321.72,-155.29 308.73,-155.09 297,-155 245,-154.58 232,-154.58 180,-155 171.75,-155.07 162.88,-155.18 154.51,-155.31"/>
<polygon fill="#000000" stroke="#000000" points="154.19,-151.82 144.24,-155.48 154.3,-158.82 154.19,-151.82"/>
</g>
<!-- sph_variables -->
<g id="module~~apm~~UsesGraph_node7" class="node">
<title>sph_variables</title>
<polygon fill="#337ab7" stroke="#337ab7" points="281,-108 196,-108 196,-84 281,-84 281,-108"/>
<text text-anchor="middle" x="238.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sph_variables</text>
</g>
<!-- module~apm&#45;&gt;sph_variables -->
<g id="module~~apm~~UsesGraph_edge5" class="edge">
<title>module~apm&#45;&gt;sph_variables</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M337.98,-143.95C326.07,-137.25 310.84,-128.91 297,-122 290.4,-118.7 283.29,-115.34 276.39,-112.17"/>
<polygon fill="#000000" stroke="#000000" points="277.75,-108.95 267.2,-108.01 274.86,-115.32 277.75,-108.95"/>
</g>
<!-- constants -->
<g id="module~~apm~~UsesGraph_node8" class="node">
<title>constants</title>
<polygon fill="#337ab7" stroke="#337ab7" points="270.5,-66 206.5,-66 206.5,-42 270.5,-42 270.5,-66"/>
<text text-anchor="middle" x="238.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">constants</text>
</g>
<!-- module~apm&#45;&gt;constants -->
<g id="module~~apm~~UsesGraph_edge6" class="edge">
<title>module~apm&#45;&gt;constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.64,-143.81C342.9,-126.25 322.69,-93.88 297,-75 291.89,-71.24 286.03,-68.09 280.05,-65.48"/>
<polygon fill="#000000" stroke="#000000" points="281.24,-62.18 270.66,-61.79 278.69,-68.7 281.24,-62.18"/>
</g>
<!-- set_h -->
<g id="module~~apm~~UsesGraph_node9" class="node">
<title>set_h</title>
<polygon fill="#337ab7" stroke="#337ab7" points="265.5,-24 211.5,-24 211.5,0 265.5,0 265.5,-24"/>
<text text-anchor="middle" x="238.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_h</text>
</g>
<!-- module~apm&#45;&gt;set_h -->
<g id="module~~apm~~UsesGraph_edge7" class="edge">
<title>module~apm&#45;&gt;set_h</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M356.05,-143.66C349.58,-119.14 331.84,-63.99 297,-33 290.86,-27.54 283.18,-23.46 275.45,-20.43"/>
<polygon fill="#000000" stroke="#000000" points="276.35,-17.03 265.75,-17.12 274.09,-23.66 276.35,-17.03"/>
</g>
<!-- module~sph_particles&#45;&gt;module~utility -->
<g id="module~~apm~~UsesGraph_edge10" class="edge">
<title>module~sph_particles&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M200.45,-205.92C193.53,-203.26 186.45,-200.25 180,-197 167,-190.44 153.41,-181.7 142.29,-173.97"/>
<polygon fill="#000000" stroke="#000000" points="144.13,-170.99 133.95,-168.05 140.08,-176.7 144.13,-170.99"/>
</g>
<!-- module~id_base -->
<g id="module~~apm~~UsesGraph_node10" class="node">
<title>module~id_base</title>
<g id="a_module~~apm~~UsesGraph_node10"><a xlink:href=".././module/id_base.html" xlink:title="id_base">
<polygon fill="#337ab7" stroke="#337ab7" points="144,-220 90,-220 90,-196 144,-196 144,-220"/>
<text text-anchor="middle" x="117" y="-205.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">id_base</text>
</a>
</g>
</g>
<!-- module~sph_particles&#45;&gt;module~id_base -->
<g id="module~~apm~~UsesGraph_edge9" class="edge">
<title>module~sph_particles&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.38,-214.64C183.44,-213.48 167.89,-212.18 154.28,-211.04"/>
<polygon fill="#000000" stroke="#000000" points="154.56,-207.55 144.31,-210.2 153.98,-214.52 154.56,-207.55"/>
</g>
<!-- timing -->
<g id="module~~apm~~UsesGraph_node11" class="node">
<title>timing</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-230 0,-230 0,-206 54,-206 54,-230"/>
<text text-anchor="middle" x="27" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timing</text>
</g>
<!-- module~sph_particles&#45;&gt;timing -->
<g id="module~~apm~~UsesGraph_edge11" class="edge">
<title>module~sph_particles&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M197.41,-224.5C167.73,-228.46 126.32,-232.2 90,-229 81.56,-228.26 72.55,-226.96 64.09,-225.5"/>
<polygon fill="#000000" stroke="#000000" points="64.58,-222.03 54.11,-223.68 63.32,-228.92 64.58,-222.03"/>
</g>
<!-- matrix -->
<g id="module~~apm~~UsesGraph_node12" class="node">
<title>matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-168 0,-168 0,-144 54,-144 54,-168"/>
<text text-anchor="middle" x="27" y="-153.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrix</text>
</g>
<!-- module~utility&#45;&gt;matrix -->
<g id="module~~apm~~UsesGraph_edge12" class="edge">
<title>module~utility&#45;&gt;matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M89.6,-156C81.61,-156 72.69,-156 64.18,-156"/>
<polygon fill="#000000" stroke="#000000" points="64.08,-152.5 54.08,-156 64.08,-159.5 64.08,-152.5"/>
</g>
<!-- module~id_base&#45;&gt;timing -->
<g id="module~~apm~~UsesGraph_edge13" class="edge">
<title>module~id_base&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M89.6,-211C81.61,-211.91 72.69,-212.92 64.18,-213.89"/>
<polygon fill="#000000" stroke="#000000" points="63.62,-210.43 54.08,-215.04 64.41,-217.38 63.62,-210.43"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      </ul>
    </div>

    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#types-1">Derived Types</a></h3></div>
  <div id="types-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/apm.html#type-apm_fields">apm_fields</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      <a class="list-group-item" href="../module/apm.html#proc-allocate_apm_fields">allocate_apm_fields</a>
      <a class="list-group-item" href="../module/apm.html#proc-correct_center_of_mass">correct_center_of_mass</a>
      <a class="list-group-item" href="../module/apm.html#proc-deallocate_apm_fields">deallocate_apm_fields</a>
      <a class="list-group-item" href="../module/apm.html#proc-get_neighbours_bf">get_neighbours_bf</a>
      <a class="list-group-item" href="../module/apm.html#proc-impose_equatorial_plane_symmetry_apm">impose_equatorial_plane_symmetry_apm</a>
      <a class="list-group-item" href="../module/apm.html#proc-reallocate_apm_fields">reallocate_apm_fields</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#modprocs-1">Module Procedures</a></h3></div>
  <div id="modprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../module/apm.html#proc-perform_apm">perform_apm</a>
    </div>
  </div>
</div>

    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    <section>
     <h2>Derived Types</h2>
     <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="type-apm_fields"></span><h3>type :: <a href='../type/apm_fields.html'>apm_fields</a>  </h3></div>
  <div class="panel-body">
    <p>Data structure containing the fields used during the APM iteration</p>
     <h4>Components</h4>
    <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th><th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-all_pos"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>all_pos</strong></td><td></td><td></td><td><p>Array storing the real particles and the ghost particles, in this order</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-all_pos_prev_dump"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>all_pos_prev_dump</strong></td><td></td><td></td><td><p>Array storing the real particles and the ghost particles, in this order,
 from the previous dump (for plotting purposes only)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-art_pr"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>art_pr</strong></td><td></td><td></td><td><p>Artificial pressure</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-cnt_move"></span>integer,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>cnt_move</strong></td><td></td><td></td><td><p>Array storing <script type="math/tex">0</script> if a particle does not move at an APM step,
 <script type="math/tex">1</script> if it moves</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-correction_pos"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>correction_pos</strong></td><td></td><td></td><td><p>Array storing the correction to the positions of the real particles and
 the ghost particles. Thoe for the ghost particles are zero</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-dnstar"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>dNstar</strong></td><td></td><td></td><td><p>Relative difference between the proper baryon number density computed
 from the \(\mathrm{ID}\) and its \(\mathrm{SPH}\) estimate</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-good_rho"></span>logical,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>good_rho</strong></td><td></td><td></td><td><p>Array storing <code>.TRUE.</code> if the density is acceptable, <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h_guess"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h_guess</strong></td><td></td><td></td><td><p>First guesses for the smoothing lengths</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nstar_id"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nstar_id</strong></td><td></td><td></td><td><p>Proper baryon number density computed from the \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nstar_sph"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nstar_sph</strong></td><td></td><td></td><td><p>\(\mathrm{SPH}\) estimate of the proper baryon number density</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nu_tmp"></span>double precision,</td>
<td>private,</td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu_tmp</strong></td><td></td><td></td><td><p>Cache-array used to temporarily store the baryon number nu</p></td>
</tr>
</tbody>
</table>

     
     <h4>Type-Bound Procedures</h4>
      <table class="table table-striped varlist">
      <tbody>
       <tr><td>procedure, public :: <strong><a href='../type/apm_fields.html#boundprocedure-allocate_apm_fields'>allocate_apm_fields</a></strong>  </td>
       <td><p>Allocates the APM fields member of TYPE <a href="../type/apm_fields.html">apm_fields</a></p></td></tr>
       <tr><td>procedure, public :: <strong><a href='../type/apm_fields.html#boundprocedure-deallocate_apm_fields'>deallocate_apm_fields</a></strong>  </td>
       <td><p>Deallocates the APM fields member of TYPE <a href="../type/apm_fields.html">apm_fields</a></p></td></tr>
       <tr><td>procedure, public :: <strong><a href='../type/apm_fields.html#boundprocedure-reallocate_apm_fields'>reallocate_apm_fields</a></strong>  </td>
       <td><p>Reallocates the APM fields member of TYPE <a href="../type/apm_fields.html">apm_fields</a></p></td></tr>
       </tbody>
       </table>
  </div>
</div>

    </section>
  <br>
    

    <section>
    <h2>Subroutines</h2>
      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-allocate_apm_fields"></span><h3>subroutine <a href='../proc/allocate_apm_fields.html'>allocate_apm_fields</a>(this, npart_real, npart_ghost)</h3></div>
  <div class="panel-body">
       
<p>Allocates the APM fields member of TYPE <a href="../type/apm_fields.html">apm_fields</a></p><a href="../proc/allocate_apm_fields.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/apm_fields.html'>apm_fields</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>this</strong></td><td><p>The <a href="../type/apm_fields.html">apm_fields</a> object that this PROCEDURE is a member of</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td><p>The number of real particles</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_ghost</strong></td><td><p>The number of ghost particles</p></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-correct_center_of_mass"></span><h3>subroutine <a href='../proc/correct_center_of_mass.html'>correct_center_of_mass</a>(npart_real, pos, nu, get_density, validate_pos, com_star, verbose)</h3></div>
  <div class="panel-body">
       
<p>Translate the particles so that their center of mass
  coincides with the center of mass of the star, given by
  LORENE</p><a href="../proc/correct_center_of_mass.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(3,npart_real)</td><td>::</td>
  <td><strong>pos</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(npart_real)</td><td>::</td>
  <td><strong>nu</strong></td><td></td>
</tr>
<tr>
  <td colspan="7">
      <small><h5>function get_density(x, y, z) result(density)</h5>    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>double precision</small></h6>  
</small>
  </td> 
</tr>
<tr>
  <td colspan="7">
      <small><h5>function validate_pos(x, y, z) result(answer)</h5>    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>logical</small></h6>  
</small>
  </td> 
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>com_star</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>verbose</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-deallocate_apm_fields"></span><h3>subroutine <a href='../proc/deallocate_apm_fields.html'>deallocate_apm_fields</a>(this)</h3></div>
  <div class="panel-body">
       
<p>Deallocates the APM fields member of TYPE <a href="../type/apm_fields.html">apm_fields</a></p><a href="../proc/deallocate_apm_fields.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/apm_fields.html'>apm_fields</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>this</strong></td><td><p>The <a href="../type/apm_fields.html">apm_fields</a> object that this PROCEDURE is a member of</p></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-get_neighbours_bf"></span><h3>subroutine <a href='../proc/get_neighbours_bf.html'>get_neighbours_bf</a>(ipart, npart, pos, h, dimensions, nnei, neilist)</h3></div>
  <div class="panel-body">
       
<p>just for test purposes: get neighbours of particle ipart in
  a "brute force" way; ipart is ALSO on the neighbour list;
  SKR 8.2.2010</p><a href="../proc/get_neighbours_bf.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ipart</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>pos</strong>(dimensions,npart)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>h</strong>(npart)</td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>dimensions</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nnei</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>neilist</strong>(npart)</td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-impose_equatorial_plane_symmetry_apm"></span><h3>subroutine <a href='../proc/impose_equatorial_plane_symmetry_apm.html'>impose_equatorial_plane_symmetry_apm</a>(npart_all, npart_real, npart_ghost, pos, fld, nu, com_star, verbose)</h3></div>
  <div class="panel-body">
       
<p>Mirror the particle with z&gt;0 with respect to the xy plane,
  to impose the equatorial-plane symmetry</p><a href="../proc/impose_equatorial_plane_symmetry_apm.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_all</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_ghost</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>type(<a href='../type/apm_fields.html'>apm_fields</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>fld</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>com_star</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(in),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>verbose</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-reallocate_apm_fields"></span><h3>subroutine <a href='../proc/reallocate_apm_fields.html'>reallocate_apm_fields</a>(this, npart_real, npart_ghost)</h3></div>
  <div class="panel-body">
       
<p>Reallocates the APM fields member of TYPE <a href="../type/apm_fields.html">apm_fields</a></p><a href="../proc/reallocate_apm_fields.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/apm_fields.html'>apm_fields</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>this</strong></td><td><p>The <a href="../type/apm_fields.html">apm_fields</a> object that this PROCEDURE is a member of</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td><p>The number of real particles</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_ghost</strong></td><td><p>The number of ghost particles</p></td>
</tr>
</tbody>
</table>


  </div>
  </div>

    </section>    
    <br>
    
    


        <section>
        <h2>Module Procedures</h2>
          <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-perform_apm"></span><h3>module procedure <a href='../proc/perform_apm.html'>perform_apm</a> <small>module module subroutine perform_apm(get_density, get_nstar_id, npart_output, pos_input, pvol, h_output, nu_output, center, com_star, mass, sizes, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, ghost_dist, use_atmosphere, remove_atmosphere, print_step, namefile_pos_id, namefile_pos, namefile_results, validate_position)</small>   <a href='../interface/perform_apm.html'><button type="button" class="btn btn-info depwarn">Interface &rarr;</button></a>
</h3></div>
  <div class="panel-body">
       
<p>Compute the particle positions as follows:</p><a href="../proc/perform_apm.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td colspan="7">
      <small><h5>function get_density(x, y, z) result(density)</h5><p>Returns the baryon mass density at the desired point</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>double precision</small></h6>  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
</small>
  </td> 
</tr>
<tr>
  <td colspan="7">
      <small><h5>subroutine get_nstar_id(npart_real, x, y, z, nstar_p)</h5><p>Computes the proper baryon number density at the particle positions</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong>(npart_real)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong>(npart_real)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(npart_real)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_p</strong>(npart_real)</td><td><p>Array to store the computed proper baryon number density</p></td>
</tr>
</tbody>
</table>

</small>
  </td> 
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_output</strong></td><td><p>Initial particle number</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(6)</td><td>::</td>
  <td><strong>sizes</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Radius of the star in the x direction, opposite to companion
Radius of the star in the y direction
Radius of the star in the z direction
Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ghost_dist</strong></td><td><p>Distance between the ghost particles and the surface</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_atmosphere</strong></td><td><p>If .TRUE., allows particles to move where the density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>remove_atmosphere</strong></td><td><p>If .TRUE., removes the particles placed where the density is 0,</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>print_step</strong></td><td><p>Prints he particle positions to a formatted file every print_step steps</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>procedure(validate_position_int),</td>
<td></td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
</tr>
</tbody>
</table>


  </div>
  </div>

        </section>    
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-04-02 15:56:56           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>