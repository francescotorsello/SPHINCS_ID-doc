
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>perform_apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.6</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>About</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>perform_apm
   <small>Interface</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">191 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/module_sph_particles.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/module_sph_particles.f90.html'>module_sph_particles.f90</a></li>
     <li><a href='../module/sph_particles.html'>sph_particles</a></li>
     <li class="active">perform_apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<em>None</em>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>interface</h2>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: interface~~perform_apm~~CallsGraph Pages: 1 -->
<svg id="interfaceperform_apmCallsGraph" width="641pt" height="878pt"
 viewBox="0.00 0.00 641.00 878.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="interface~~perform_apm~~CallsGraph" class="graph" transform="scale(1.74 1.74) rotate(0) translate(4 1528)">
<title>interface~~perform_apm~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1528 1114,-1528 1114,4 -4,4"/>
<!-- interface~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node1" class="node">
<title>interface~perform_apm</title>
<polygon fill="none" stroke="black" points="85,-734 0,-734 0,-710 85,-710 85,-734"/>
<text text-anchor="middle" x="42.5" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50">perform_apm</text>
</g>
<!-- proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node2" class="node">
<title>proc~perform_apm</title>
<g id="a_interface~~perform_apm~~CallsGraph_node2"><a xlink:href=".././proc/perform_apm.html" xlink:title="perform_apm">
<polygon fill="#d9534f" stroke="#d9534f" points="206,-734 121,-734 121,-710 206,-710 206,-734"/>
<text text-anchor="middle" x="163.5" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_apm</text>
</a>
</g>
</g>
<!-- interface~perform_apm&#45;&gt;proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_edge1" class="edge">
<title>interface~perform_apm&#45;&gt;proc~perform_apm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M85.12,-722C93.32,-722 102.01,-722 110.5,-722"/>
<polygon fill="#000000" stroke="#000000" points="110.7,-725.5 120.7,-722 110.7,-718.5 110.7,-725.5"/>
</g>
<!-- none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_node3" class="node">
<title>none~reallocate_output_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="414,-1461 275,-1461 275,-1437 414,-1437 414,-1461"/>
<text text-anchor="middle" x="344.5" y="-1446.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reallocate_output_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge2" class="edge">
<title>proc~perform_apm&#45;&gt;none~reallocate_output_fields</title>
<path fill="none" stroke="#000000" d="M164.36,-734.13C163.64,-815.73 163.03,-1284.93 242,-1398 253.15,-1413.96 270.79,-1425.2 288.26,-1432.98"/>
<polygon fill="#000000" stroke="#000000" points="287.33,-1436.38 297.91,-1436.95 290,-1429.91 287.33,-1436.38"/>
</g>
<!-- none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_node4" class="node">
<title>none~place_and_print_ghost_particles</title>
<polygon fill="#d9534f" stroke="#d9534f" points="436,-1354 253,-1354 253,-1330 436,-1330 436,-1354"/>
<text text-anchor="middle" x="344.5" y="-1339.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">place_and_print_ghost_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge3" class="edge">
<title>proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles</title>
<path fill="none" stroke="#000000" d="M164.26,-734.39C163.05,-811.88 160.38,-1229.35 242,-1319 243.58,-1320.74 245.26,-1322.36 247.03,-1323.87"/>
<polygon fill="#000000" stroke="#000000" points="245.14,-1326.82 255.3,-1329.81 249.22,-1321.13 245.14,-1326.82"/>
</g>
<!-- position_correction -->
<g id="interface~~perform_apm~~CallsGraph_node5" class="node">
<title>position_correction</title>
<polygon fill="#777777" stroke="#777777" points="401,-1150 288,-1150 288,-1126 401,-1126 401,-1150"/>
<text text-anchor="middle" x="344.5" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">position_correction</text>
</g>
<!-- proc~perform_apm&#45;&gt;position_correction -->
<g id="interface~~perform_apm~~CallsGraph_edge4" class="edge">
<title>proc~perform_apm&#45;&gt;position_correction</title>
<path fill="none" stroke="#000000" d="M165.13,-734.29C168.5,-794.83 186.33,-1060.75 242,-1117 251.68,-1126.78 264.63,-1132.59 278.03,-1135.93"/>
<polygon fill="#000000" stroke="#000000" points="277.33,-1139.36 287.83,-1137.95 278.74,-1132.5 277.33,-1139.36"/>
</g>
<!-- ncand -->
<g id="interface~~perform_apm~~CallsGraph_node6" class="node">
<title>ncand</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1108 317.5,-1108 317.5,-1084 371.5,-1084 371.5,-1108"/>
<text text-anchor="middle" x="344.5" y="-1093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ncand</text>
</g>
<!-- proc~perform_apm&#45;&gt;ncand -->
<g id="interface~~perform_apm~~CallsGraph_edge5" class="edge">
<title>proc~perform_apm&#45;&gt;ncand</title>
<path fill="none" stroke="#000000" d="M165.43,-734.09C169.97,-790.3 191.79,-1025.39 242,-1075 258.94,-1091.74 285.49,-1096.78 307.19,-1097.75"/>
<polygon fill="#000000" stroke="#000000" points="307.33,-1101.25 317.39,-1097.93 307.45,-1094.25 307.33,-1101.25"/>
</g>
<!-- iorig -->
<g id="interface~~perform_apm~~CallsGraph_node7" class="node">
<title>iorig</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1066 317.5,-1066 317.5,-1042 371.5,-1042 371.5,-1066"/>
<text text-anchor="middle" x="344.5" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iorig</text>
</g>
<!-- proc~perform_apm&#45;&gt;iorig -->
<g id="interface~~perform_apm~~CallsGraph_edge6" class="edge">
<title>proc~perform_apm&#45;&gt;iorig</title>
<path fill="none" stroke="#000000" d="M165.8,-734.03C171.66,-785.93 197.26,-990.02 242,-1033 259.06,-1049.39 285.37,-1054.48 306.93,-1055.56"/>
<polygon fill="#000000" stroke="#000000" points="306.99,-1059.06 317.07,-1055.8 307.16,-1052.07 306.99,-1059.06"/>
</g>
<!-- allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node8" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="409.5,-1024 279.5,-1024 279.5,-1000 409.5,-1000 409.5,-1024"/>
<text text-anchor="middle" x="344.5" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge7" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M163.95,-734.13C162.75,-776.54 164.81,-919.5 242,-991 249.8,-998.23 259.41,-1003.24 269.58,-1006.67"/>
<polygon fill="#000000" stroke="#000000" points="268.88,-1010.11 279.46,-1009.49 270.81,-1003.38 268.88,-1010.11"/>
</g>
<!-- allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node9" class="node">
<title>allocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="427,-982 262,-982 262,-958 427,-958 427,-982"/>
<text text-anchor="middle" x="344.5" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge8" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M164.7,-734.1C166,-772.14 175.49,-890.32 242,-949 245.26,-951.88 248.82,-954.4 252.58,-956.61"/>
<polygon fill="#000000" stroke="#000000" points="251.18,-959.82 261.68,-961.21 254.33,-953.58 251.18,-959.82"/>
</g>
<!-- h -->
<g id="interface~~perform_apm~~CallsGraph_node10" class="node">
<title>h</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1230 558.5,-1230 558.5,-1206 612.5,-1206 612.5,-1230"/>
<text text-anchor="middle" x="585.5" y="-1215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~perform_apm&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge9" class="edge">
<title>proc~perform_apm&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M164.29,-734.34C163.38,-806.27 162.74,-1170.74 242,-1239 311.04,-1298.46 356.15,-1245.9 447,-1239 481.59,-1236.37 520.65,-1230.08 548.28,-1225.07"/>
<polygon fill="#000000" stroke="#000000" points="549.08,-1228.48 558.28,-1223.22 547.81,-1221.6 549.08,-1228.48"/>
</g>
<!-- none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_node11" class="node">
<title>none~allocate_apm_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-940 285.5,-940 285.5,-916 403.5,-916 403.5,-940"/>
<text text-anchor="middle" x="344.5" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_apm_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge10" class="edge">
<title>proc~perform_apm&#45;&gt;none~allocate_apm_fields</title>
<path fill="none" stroke="#000000" d="M165.76,-734.22C169.87,-767.6 186.09,-860.95 242,-907 251.59,-914.9 263.39,-920.07 275.51,-923.4"/>
<polygon fill="#000000" stroke="#000000" points="274.73,-926.81 285.26,-925.69 276.33,-920 274.73,-926.81"/>
</g>
<!-- allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node12" class="node">
<title>allocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="431,-898 258,-898 258,-874 431,-874 431,-898"/>
<text text-anchor="middle" x="344.5" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge11" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M167.39,-734.28C174.65,-762.3 196.44,-831.15 242,-865 244.15,-866.6 246.39,-868.08 248.71,-869.45"/>
<polygon fill="#000000" stroke="#000000" points="247.48,-872.76 257.97,-874.25 250.7,-866.54 247.48,-872.76"/>
</g>
<!-- none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_node13" class="node">
<title>none~dump_apm_pos</title>
<polygon fill="#d9534f" stroke="#d9534f" points="393,-1310 296,-1310 296,-1286 393,-1286 393,-1310"/>
<text text-anchor="middle" x="344.5" y="-1295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dump_apm_pos</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_edge12" class="edge">
<title>proc~perform_apm&#45;&gt;none~dump_apm_pos</title>
<path fill="none" stroke="#000000" d="M164.45,-734.34C164.39,-807.97 167.73,-1189.01 242,-1272 253.2,-1284.52 269.53,-1291.39 285.82,-1295.05"/>
<polygon fill="#000000" stroke="#000000" points="285.45,-1298.54 295.92,-1296.95 286.74,-1291.66 285.45,-1298.54"/>
</g>
<!-- interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node14" class="node">
<title>interface~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node14"><a xlink:href=".././interface/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#a7506f" stroke="#a7506f" points="413.5,-776 275.5,-776 275.5,-752 413.5,-752 413.5,-776"/>
<text text-anchor="middle" x="344.5" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge13" class="edge">
<title>proc~perform_apm&#45;&gt;interface~correct_center_of_mass</title>
<path fill="none" stroke="#000000" d="M206.21,-733.8C217.77,-736.93 230.34,-740.22 242,-743 251.88,-745.36 262.34,-747.7 272.64,-749.91"/>
<polygon fill="#000000" stroke="#000000" points="271.94,-753.34 282.45,-751.99 273.39,-746.49 271.94,-753.34"/>
</g>
<!-- deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node15" class="node">
<title>deallocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="404,-654 285,-654 285,-630 404,-630 404,-654"/>
<text text-anchor="middle" x="344.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge14" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_gradient</title>
<path fill="none" stroke="#000000" d="M178.4,-709.98C193.23,-697.75 217.85,-679.07 242,-668 252.36,-663.25 263.73,-659.27 274.99,-655.97"/>
<polygon fill="#000000" stroke="#000000" points="276.13,-659.28 284.83,-653.23 274.26,-652.54 276.13,-659.28"/>
</g>
<!-- none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_node16" class="node">
<title>none~validate_position_final</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="410,-612 279,-612 279,-588 410,-588 410,-612"/>
<text text-anchor="middle" x="344.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position_final</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_edge15" class="edge">
<title>proc~perform_apm&#45;&gt;none~validate_position_final</title>
<path fill="none" stroke="#000000" d="M170.2,-709.77C180.97,-688.14 206.42,-643.31 242,-621 250.2,-615.86 259.44,-611.95 268.92,-608.98"/>
<polygon fill="#000000" stroke="#000000" points="270.15,-612.27 278.85,-606.22 268.27,-605.53 270.15,-612.27"/>
</g>
<!-- deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node17" class="node">
<title>deallocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="438,-570 251,-570 251,-546 438,-546 438,-570"/>
<text text-anchor="middle" x="344.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge16" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M167.39,-709.72C174.65,-681.7 196.44,-612.85 242,-579 243.88,-577.6 245.83,-576.3 247.83,-575.07"/>
<polygon fill="#000000" stroke="#000000" points="249.79,-577.99 256.98,-570.21 246.5,-571.81 249.79,-577.99"/>
</g>
<!-- nu -->
<g id="interface~~perform_apm~~CallsGraph_node18" class="node">
<title>nu</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1188 558.5,-1188 558.5,-1164 612.5,-1164 612.5,-1188"/>
<text text-anchor="middle" x="585.5" y="-1173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu</text>
</g>
<!-- proc~perform_apm&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge17" class="edge">
<title>proc~perform_apm&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M164.7,-734.03C166.07,-798.34 175.96,-1100.79 242,-1159 286.47,-1198.19 468.99,-1186.7 547.89,-1179.66"/>
<polygon fill="#000000" stroke="#000000" points="548.67,-1183.1 558.31,-1178.7 548.03,-1176.13 548.67,-1183.1"/>
</g>
<!-- rpart -->
<g id="interface~~perform_apm~~CallsGraph_node19" class="node">
<title>rpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-528 317.5,-528 317.5,-504 371.5,-504 371.5,-528"/>
<text text-anchor="middle" x="344.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;rpart -->
<g id="interface~~perform_apm~~CallsGraph_edge18" class="edge">
<title>proc~perform_apm&#45;&gt;rpart</title>
<path fill="none" stroke="#000000" d="M165.76,-709.78C169.87,-676.4 186.09,-583.05 242,-537 260.06,-522.12 285.96,-516.94 307.08,-515.44"/>
<polygon fill="#000000" stroke="#000000" points="307.48,-518.93 317.31,-514.97 307.16,-511.94 307.48,-518.93"/>
</g>
<!-- deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node20" class="node">
<title>deallocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="433.5,-486 255.5,-486 255.5,-462 433.5,-462 433.5,-486"/>
<text text-anchor="middle" x="344.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge19" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M164.7,-709.9C166,-671.86 175.49,-553.68 242,-495 243.52,-493.66 245.1,-492.4 246.73,-491.21"/>
<polygon fill="#000000" stroke="#000000" points="248.69,-494.12 255.32,-485.85 244.98,-488.18 248.69,-494.12"/>
</g>
<!-- assign_h -->
<g id="interface~~perform_apm~~CallsGraph_node21" class="node">
<title>assign_h</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-444 315.5,-444 315.5,-420 373.5,-420 373.5,-444"/>
<text text-anchor="middle" x="344.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">assign_h</text>
</g>
<!-- proc~perform_apm&#45;&gt;assign_h -->
<g id="interface~~perform_apm~~CallsGraph_edge20" class="edge">
<title>proc~perform_apm&#45;&gt;assign_h</title>
<path fill="none" stroke="#000000" d="M163.95,-709.87C162.75,-667.46 164.81,-524.5 242,-453 258.83,-437.41 284.06,-432.14 305.16,-430.78"/>
<polygon fill="#000000" stroke="#000000" points="305.58,-434.26 315.44,-430.39 305.31,-427.27 305.58,-434.26"/>
</g>
<!-- exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_node22" class="node">
<title>exact_nei_tree_update</title>
<polygon fill="#777777" stroke="#777777" points="410.5,-402 278.5,-402 278.5,-378 410.5,-378 410.5,-402"/>
<text text-anchor="middle" x="344.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_nei_tree_update</text>
</g>
<!-- proc~perform_apm&#45;&gt;exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_edge21" class="edge">
<title>proc~perform_apm&#45;&gt;exact_nei_tree_update</title>
<path fill="none" stroke="#000000" d="M165.8,-709.97C171.66,-658.07 197.26,-453.98 242,-411 249.52,-403.77 258.84,-398.74 268.76,-395.28"/>
<polygon fill="#000000" stroke="#000000" points="269.82,-398.62 278.42,-392.43 267.83,-391.91 269.82,-398.62"/>
</g>
<!-- none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_node23" class="node">
<title>none~get_nstar_id_atm</title>
<polygon fill="#d9534f" stroke="#d9534f" points="396,-734 293,-734 293,-710 396,-710 396,-734"/>
<text text-anchor="middle" x="344.5" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id_atm</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_edge22" class="edge">
<title>proc~perform_apm&#45;&gt;none~get_nstar_id_atm</title>
<path fill="none" stroke="#000000" d="M206.02,-722C228.8,-722 257.47,-722 282.73,-722"/>
<polygon fill="#000000" stroke="#000000" points="282.95,-725.5 292.95,-722 282.95,-718.5 282.95,-725.5"/>
</g>
<!-- timer -->
<g id="interface~~perform_apm~~CallsGraph_node24" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-360 317.5,-360 317.5,-336 371.5,-336 371.5,-360"/>
<text text-anchor="middle" x="344.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~perform_apm&#45;&gt;timer -->
<g id="interface~~perform_apm~~CallsGraph_edge23" class="edge">
<title>proc~perform_apm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M165.43,-709.91C169.97,-653.7 191.79,-418.61 242,-369 258.94,-352.26 285.49,-347.22 307.19,-346.25"/>
<polygon fill="#000000" stroke="#000000" points="307.45,-349.75 317.39,-346.07 307.33,-342.75 307.45,-349.75"/>
</g>
<!-- none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_node25" class="node">
<title>none~discard_atmosphere</title>
<polygon fill="#d9534f" stroke="#d9534f" points="405,-1230 284,-1230 284,-1206 405,-1206 405,-1230"/>
<text text-anchor="middle" x="344.5" y="-1215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">discard_atmosphere</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_edge24" class="edge">
<title>proc~perform_apm&#45;&gt;none~discard_atmosphere</title>
<path fill="none" stroke="#000000" d="M164.77,-734.25C166.49,-801.19 178.03,-1122.18 242,-1192 250.58,-1201.37 262.03,-1207.56 274.15,-1211.61"/>
<polygon fill="#000000" stroke="#000000" points="273.39,-1215.03 283.97,-1214.42 275.32,-1208.3 273.39,-1215.03"/>
</g>
<!-- interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node26" class="node">
<title>interface~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node26"><a xlink:href=".././interface/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#a7506f" stroke="#a7506f" points="415.5,-318 273.5,-318 273.5,-294 415.5,-294 415.5,-318"/>
<text text-anchor="middle" x="344.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge25" class="edge">
<title>proc~perform_apm&#45;&gt;interface~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M165.13,-709.71C168.5,-649.17 186.33,-383.25 242,-327 248.14,-320.8 255.6,-316.19 263.66,-312.8"/>
<polygon fill="#000000" stroke="#000000" points="265.1,-316 273.35,-309.35 262.75,-309.4 265.1,-316"/>
</g>
<!-- density -->
<g id="interface~~perform_apm~~CallsGraph_node27" class="node">
<title>density</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-276 317.5,-276 317.5,-252 371.5,-252 371.5,-276"/>
<text text-anchor="middle" x="344.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density</text>
</g>
<!-- proc~perform_apm&#45;&gt;density -->
<g id="interface~~perform_apm~~CallsGraph_edge26" class="edge">
<title>proc~perform_apm&#45;&gt;density</title>
<path fill="none" stroke="#000000" d="M164.88,-709.72C167.13,-645.41 180.78,-347.99 242,-285 258.6,-267.92 285.16,-262.89 306.95,-262.01"/>
<polygon fill="#000000" stroke="#000000" points="307.24,-265.51 317.2,-261.88 307.15,-258.51 307.24,-265.51"/>
</g>
<!-- deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node28" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="416,-234 273,-234 273,-210 416,-210 416,-234"/>
<text text-anchor="middle" x="344.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge27" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M164.67,-709.91C165.88,-642.42 175.15,-312.83 242,-243 247.99,-236.74 255.32,-232.09 263.27,-228.67"/>
<polygon fill="#000000" stroke="#000000" points="264.64,-231.9 272.85,-225.2 262.26,-225.32 264.64,-231.9"/>
</g>
<!-- proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_node29" class="node">
<title>proc~find_h_backup</title>
<g id="a_interface~~perform_apm~~CallsGraph_node29"><a xlink:href=".././proc/find_h_backup.html" xlink:title="find_h_backup">
<polygon fill="#d94e8f" stroke="#d94e8f" points="389,-192 300,-192 300,-168 389,-168 389,-192"/>
<text text-anchor="middle" x="344.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_h_backup</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_edge28" class="edge">
<title>proc~perform_apm&#45;&gt;proc~find_h_backup</title>
<path fill="none" stroke="#000000" d="M164.5,-709.8C164.75,-638.64 169.61,-277.59 242,-201 254.24,-188.05 272.21,-181.97 289.64,-179.39"/>
<polygon fill="#000000" stroke="#000000" points="290.24,-182.85 299.79,-178.25 289.46,-175.89 290.24,-182.85"/>
</g>
<!-- com -->
<g id="interface~~perform_apm~~CallsGraph_node30" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-814 784.5,-814 784.5,-790 838.5,-790 838.5,-814"/>
<text text-anchor="middle" x="811.5" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">com</text>
</g>
<!-- proc~perform_apm&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge29" class="edge">
<title>proc~perform_apm&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M174.56,-734.01C188.08,-749.16 213.72,-774.48 242,-785 339.96,-821.45 664.67,-809.24 774.12,-803.92"/>
<polygon fill="#000000" stroke="#000000" points="774.51,-807.41 784.32,-803.42 774.16,-800.42 774.51,-807.41"/>
</g>
<!-- proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_node31" class="node">
<title>proc~is_finite_number</title>
<g id="a_interface~~perform_apm~~CallsGraph_node31"><a xlink:href=".././proc/is_finite_number.html" xlink:title="is_finite_number">
<polygon fill="#d94e8f" stroke="#d94e8f" points="861.5,-736 761.5,-736 761.5,-712 861.5,-712 861.5,-736"/>
<text text-anchor="middle" x="811.5" y="-721.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_finite_number</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge30" class="edge">
<title>proc~perform_apm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M205.73,-709.94C217.39,-706.77 230.14,-703.53 242,-701 348.04,-678.34 374.9,-671.47 483,-663 573.83,-655.88 599.31,-642.14 688,-663 723.48,-671.34 760.42,-691.59 784.34,-706.48"/>
<polygon fill="#000000" stroke="#000000" points="782.52,-709.47 792.84,-711.89 786.28,-703.57 782.52,-709.47"/>
</g>
<!-- allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node32" class="node">
<title>allocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="397.5,-150 291.5,-150 291.5,-126 397.5,-126 397.5,-150"/>
<text text-anchor="middle" x="344.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge31" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_gradient</title>
<path fill="none" stroke="#000000" d="M164.35,-709.81C163.7,-635.36 164,-242.42 242,-159 252.23,-148.05 266.55,-142.01 281.21,-138.83"/>
<polygon fill="#000000" stroke="#000000" points="282.12,-142.22 291.37,-137.06 280.92,-135.33 282.12,-142.22"/>
</g>
<!-- lpart -->
<g id="interface~~perform_apm~~CallsGraph_node33" class="node">
<title>lpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-108 317.5,-108 317.5,-84 371.5,-84 371.5,-108"/>
<text text-anchor="middle" x="344.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;lpart -->
<g id="interface~~perform_apm~~CallsGraph_edge32" class="edge">
<title>proc~perform_apm&#45;&gt;lpart</title>
<path fill="none" stroke="#000000" d="M164.22,-709.92C162.72,-632.61 158.35,-207.31 242,-117 258.36,-99.33 285.35,-94.4 307.38,-93.71"/>
<polygon fill="#000000" stroke="#000000" points="307.43,-97.21 317.42,-93.67 307.41,-90.21 307.43,-97.21"/>
</g>
<!-- density_loop -->
<g id="interface~~perform_apm~~CallsGraph_node34" class="node">
<title>density_loop</title>
<polygon fill="#777777" stroke="#777777" points="384,-66 305,-66 305,-42 384,-42 384,-66"/>
<text text-anchor="middle" x="344.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density_loop</text>
</g>
<!-- proc~perform_apm&#45;&gt;density_loop -->
<g id="interface~~perform_apm~~CallsGraph_edge33" class="edge">
<title>proc~perform_apm&#45;&gt;density_loop</title>
<path fill="none" stroke="#000000" d="M165.11,-709.84C169.49,-625.02 197.18,-123.79 242,-75 255.31,-60.51 275.77,-54.57 294.84,-52.51"/>
<polygon fill="#000000" stroke="#000000" points="295.23,-55.99 304.94,-51.76 294.71,-49.01 295.23,-55.99"/>
</g>
<!-- proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_node35" class="node">
<title>proc~spherical_from_cartesian</title>
<g id="a_interface~~perform_apm~~CallsGraph_node35"><a xlink:href=".././proc/spherical_from_cartesian.html" xlink:title="spherical_from_cartesian">
<polygon fill="#d9534f" stroke="#d9534f" points="658.5,-1398 512.5,-1398 512.5,-1374 658.5,-1374 658.5,-1398"/>
<text text-anchor="middle" x="585.5" y="-1383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spherical_from_cartesian</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge34" class="edge">
<title>proc~perform_apm&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M165.05,-734.12C169.01,-818.62 194.36,-1317.83 242,-1363 278.13,-1397.25 412.96,-1396.59 502.29,-1392"/>
<polygon fill="#000000" stroke="#000000" points="502.61,-1395.49 512.4,-1391.46 502.23,-1388.5 502.61,-1395.49"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node36" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node36"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="447,-856 242,-856 242,-832 447,-832 447,-856"/>
<text text-anchor="middle" x="344.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge35" class="edge">
<title>proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M170.83,-734.11C182.21,-754.66 208.12,-796.23 242,-818 248.31,-822.06 255.23,-825.48 262.38,-828.37"/>
<polygon fill="#000000" stroke="#000000" points="261.67,-831.84 272.26,-831.99 264.07,-825.26 261.67,-831.84"/>
</g>
<!-- nic -->
<g id="interface~~perform_apm~~CallsGraph_node37" class="node">
<title>nic</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-24 317.5,-24 317.5,0 371.5,0 371.5,-24"/>
<text text-anchor="middle" x="344.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nic</text>
</g>
<!-- proc~perform_apm&#45;&gt;nic -->
<g id="interface~~perform_apm~~CallsGraph_edge36" class="edge">
<title>proc~perform_apm&#45;&gt;nic</title>
<path fill="none" stroke="#000000" d="M165.02,-709.91C168.88,-622.17 194.35,-85.25 242,-33 258.23,-15.21 285.22,-10.28 307.29,-9.63"/>
<polygon fill="#000000" stroke="#000000" points="307.35,-13.13 317.35,-9.6 307.34,-6.13 307.35,-13.13"/>
</g>
<!-- h_output -->
<g id="interface~~perform_apm~~CallsGraph_node38" class="node">
<title>h_output</title>
<polygon fill="#777777" stroke="#777777" points="615,-1482 556,-1482 556,-1458 615,-1458 615,-1482"/>
<text text-anchor="middle" x="585.5" y="-1467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;h_output -->
<g id="interface~~perform_apm~~CallsGraph_edge38" class="edge">
<title>none~reallocate_output_fields&#45;&gt;h_output</title>
<path fill="none" stroke="#000000" d="M414.31,-1455.05C456.92,-1458.79 510.1,-1463.46 545.56,-1466.58"/>
<polygon fill="#000000" stroke="#000000" points="545.7,-1470.1 555.96,-1467.49 546.31,-1463.13 545.7,-1470.1"/>
</g>
<!-- pos_input -->
<g id="interface~~perform_apm~~CallsGraph_node44" class="node">
<title>pos_input</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-1440 553.5,-1440 553.5,-1416 617.5,-1416 617.5,-1440"/>
<text text-anchor="middle" x="585.5" y="-1425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pos_input</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge37" class="edge">
<title>none~reallocate_output_fields&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M414.31,-1442.95C456.1,-1439.28 508.05,-1434.72 543.49,-1431.6"/>
<polygon fill="#000000" stroke="#000000" points="543.82,-1435.09 553.48,-1430.73 543.21,-1428.11 543.82,-1435.09"/>
</g>
<!-- nu_output -->
<g id="interface~~perform_apm~~CallsGraph_node46" class="node">
<title>nu_output</title>
<polygon fill="#777777" stroke="#777777" points="618.5,-1524 552.5,-1524 552.5,-1500 618.5,-1500 618.5,-1524"/>
<text text-anchor="middle" x="585.5" y="-1509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;nu_output -->
<g id="interface~~perform_apm~~CallsGraph_edge39" class="edge">
<title>none~reallocate_output_fields&#45;&gt;nu_output</title>
<path fill="none" stroke="#000000" d="M381.72,-1461.07C409.3,-1470.01 448.3,-1482.13 483,-1491 502.42,-1495.96 524.15,-1500.58 542.51,-1504.22"/>
<polygon fill="#000000" stroke="#000000" points="541.84,-1507.65 552.33,-1506.13 543.18,-1500.78 541.84,-1507.65"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge42" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M410.81,-1354.02C441.24,-1359.63 477.62,-1366.32 509.2,-1372.14"/>
<polygon fill="#000000" stroke="#000000" points="508.8,-1375.62 519.27,-1373.99 510.07,-1368.74 508.8,-1375.62"/>
</g>
<!-- get_density -->
<g id="interface~~perform_apm~~CallsGraph_node40" class="node">
<title>get_density</title>
<polygon fill="#777777" stroke="#777777" points="622,-1272 549,-1272 549,-1248 622,-1248 622,-1272"/>
<text text-anchor="middle" x="585.5" y="-1257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_density</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge40" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M421.65,-1329.97C430.49,-1327.07 439.15,-1323.47 447,-1319 467.22,-1307.49 462.68,-1292.32 483,-1281 499.9,-1271.59 520.5,-1266.38 538.72,-1263.5"/>
<polygon fill="#000000" stroke="#000000" points="539.42,-1266.94 548.84,-1262.09 538.46,-1260 539.42,-1266.94"/>
</g>
<!-- center -->
<g id="interface~~perform_apm~~CallsGraph_node41" class="node">
<title>center</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1314 558.5,-1314 558.5,-1290 612.5,-1290 612.5,-1314"/>
<text text-anchor="middle" x="585.5" y="-1299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">center</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;center -->
<g id="interface~~perform_apm~~CallsGraph_edge41" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;center</title>
<path fill="none" stroke="#000000" d="M417.21,-1330C460.45,-1322.76 513.68,-1313.85 548.32,-1308.06"/>
<polygon fill="#000000" stroke="#000000" points="549.16,-1311.46 558.44,-1306.36 548,-1304.56 549.16,-1311.46"/>
</g>
<!-- sizes -->
<g id="interface~~perform_apm~~CallsGraph_node43" class="node">
<title>sizes</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1356 558.5,-1356 558.5,-1332 612.5,-1332 612.5,-1356"/>
<text text-anchor="middle" x="585.5" y="-1341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sizes</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;sizes -->
<g id="interface~~perform_apm~~CallsGraph_edge43" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;sizes</title>
<path fill="none" stroke="#000000" d="M436.2,-1342.76C475.13,-1343.08 518.39,-1343.45 548.09,-1343.7"/>
<polygon fill="#000000" stroke="#000000" points="548.36,-1347.2 558.39,-1343.78 548.42,-1340.2 548.36,-1347.2"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge44" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M366.75,-1354C393.22,-1368.49 440.18,-1392.68 483,-1407 502.44,-1413.5 524.67,-1418.38 543.37,-1421.78"/>
<polygon fill="#000000" stroke="#000000" points="542.9,-1425.25 553.35,-1423.53 544.1,-1418.36 542.9,-1425.25"/>
</g>
<!-- none~dump_apm_pos&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge45" class="edge">
<title>none~dump_apm_pos&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M393,-1290.45C435.39,-1283.71 497.03,-1273.91 538.84,-1267.26"/>
<polygon fill="#000000" stroke="#000000" points="539.43,-1270.71 548.76,-1265.68 538.33,-1263.8 539.43,-1270.71"/>
</g>
<!-- proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node45" class="node">
<title>proc~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node45"><a xlink:href=".././proc/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#d9534f" stroke="#d9534f" points="654.5,-776 516.5,-776 516.5,-752 654.5,-752 654.5,-776"/>
<text text-anchor="middle" x="585.5" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge46" class="edge">
<title>interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.67,-764C442.42,-764 476.08,-764 505.88,-764"/>
<polygon fill="#000000" stroke="#000000" points="506.24,-767.5 516.24,-764 506.24,-760.5 506.24,-767.5"/>
</g>
<!-- validate_position -->
<g id="interface~~perform_apm~~CallsGraph_node39" class="node">
<title>validate_position</title>
<polygon fill="#777777" stroke="#777777" points="637,-612 534,-612 534,-588 637,-588 637,-612"/>
<text text-anchor="middle" x="585.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position</text>
</g>
<!-- none~validate_position_final&#45;&gt;validate_position -->
<g id="interface~~perform_apm~~CallsGraph_edge47" class="edge">
<title>none~validate_position_final&#45;&gt;validate_position</title>
<path fill="none" stroke="#000000" d="M410.18,-600C445.53,-600 489.06,-600 523.78,-600"/>
<polygon fill="#000000" stroke="#000000" points="523.79,-603.5 533.79,-600 523.79,-596.5 523.79,-603.5"/>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge49" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M396.15,-722.22C482.82,-722.59 659.12,-723.35 751.31,-723.75"/>
<polygon fill="#000000" stroke="#000000" points="751.3,-727.25 761.32,-723.79 751.33,-720.25 751.3,-727.25"/>
</g>
<!-- get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_node47" class="node">
<title>get_nstar_id</title>
<polygon fill="#777777" stroke="#777777" points="624,-696 547,-696 547,-672 624,-672 624,-696"/>
<text text-anchor="middle" x="585.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id</text>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_edge48" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;get_nstar_id</title>
<path fill="none" stroke="#000000" d="M396.19,-713.94C437.74,-707.33 496.15,-698.05 536.86,-691.58"/>
<polygon fill="#000000" stroke="#000000" points="537.48,-695.02 546.8,-689.99 536.38,-688.11 537.48,-695.02"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge51" class="edge">
<title>none~discard_atmosphere&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M405.19,-1218C450.18,-1218 510.41,-1218 548.34,-1218"/>
<polygon fill="#000000" stroke="#000000" points="548.41,-1221.5 558.41,-1218 548.41,-1214.5 548.41,-1221.5"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge52" class="edge">
<title>none~discard_atmosphere&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M405.19,-1207.51C450.18,-1199.6 510.41,-1189.02 548.34,-1182.35"/>
<polygon fill="#000000" stroke="#000000" points="549.17,-1185.76 558.41,-1180.58 547.96,-1178.87 549.17,-1185.76"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge50" class="edge">
<title>none~discard_atmosphere&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M405.19,-1228.49C446.52,-1235.75 500.7,-1245.27 538.65,-1251.94"/>
<polygon fill="#000000" stroke="#000000" points="538.44,-1255.46 548.9,-1253.74 539.65,-1248.57 538.44,-1255.46"/>
</g>
<!-- proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node48" class="node">
<title>proc~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node48"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="656.5,-318 514.5,-318 514.5,-294 656.5,-294 656.5,-318"/>
<text text-anchor="middle" x="585.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- interface~check_particle_positions&#45;&gt;proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge53" class="edge">
<title>interface~check_particle_positions&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M415.59,-306C443.44,-306 475.63,-306 504.39,-306"/>
<polygon fill="#000000" stroke="#000000" points="504.41,-309.5 514.41,-306 504.41,-302.5 504.41,-309.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node42" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node42"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="688,-856 483,-856 483,-832 688,-832 688,-856"/>
<text text-anchor="middle" x="585.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge54" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.2,-844C455.7,-844 464.31,-844 472.87,-844"/>
<polygon fill="#000000" stroke="#000000" points="472.89,-847.5 482.89,-844 472.89,-840.5 472.89,-847.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge56" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M650.69,-831.96C690.7,-824.46 740.74,-815.08 774.06,-808.83"/>
<polygon fill="#000000" stroke="#000000" points="775.07,-812.2 784.25,-806.92 773.78,-805.32 775.07,-812.2"/>
</g>
<!-- interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node49" class="node">
<title>interface~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node49"><a xlink:href=".././interface/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="886.5,-898 736.5,-898 736.5,-874 886.5,-874 886.5,-898"/>
<text text-anchor="middle" x="811.5" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge55" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" d="M650.69,-856.04C677.4,-861.04 708.58,-866.89 736.27,-872.08"/>
<polygon fill="#000000" stroke="#000000" points="735.83,-875.56 746.3,-873.96 737.12,-868.68 735.83,-875.56"/>
</g>
<!-- interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node51" class="node">
<title>interface~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node51"><a xlink:href=".././interface/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="899,-856 724,-856 724,-832 899,-832 899,-856"/>
<text text-anchor="middle" x="811.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge57" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" d="M688.01,-844C696.49,-844 705.05,-844 713.49,-844"/>
<polygon fill="#000000" stroke="#000000" points="713.72,-847.5 723.72,-844 713.72,-840.5 713.72,-847.5"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge58" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M654.62,-775.56C694.11,-782.26 742.24,-790.42 774.48,-795.89"/>
<polygon fill="#000000" stroke="#000000" points="773.92,-799.34 784.36,-797.57 775.09,-792.44 773.92,-799.34"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge59" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M653.71,-752C684.85,-746.44 721.53,-739.89 751.58,-734.52"/>
<polygon fill="#000000" stroke="#000000" points="752.27,-737.95 761.5,-732.75 751.04,-731.06 752.27,-737.95"/>
</g>
<!-- indexx -->
<g id="interface~~perform_apm~~CallsGraph_node50" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-318 784.5,-318 784.5,-294 838.5,-294 838.5,-318"/>
<text text-anchor="middle" x="811.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="interface~~perform_apm~~CallsGraph_edge60" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M656.76,-306C695.72,-306 742.55,-306 774.21,-306"/>
<polygon fill="#000000" stroke="#000000" points="774.33,-309.5 784.33,-306 774.33,-302.5 774.33,-309.5"/>
</g>
<!-- proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node52" class="node">
<title>proc~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node52"><a xlink:href=".././proc/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1097.5,-898 947.5,-898 947.5,-874 1097.5,-874 1097.5,-898"/>
<text text-anchor="middle" x="1022.5" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge61" class="edge">
<title>interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M886.77,-886C903.1,-886 920.5,-886 937.18,-886"/>
<polygon fill="#000000" stroke="#000000" points="937.47,-889.5 947.47,-886 937.47,-882.5 937.47,-889.5"/>
</g>
<!-- proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node53" class="node">
<title>proc~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node53"><a xlink:href=".././proc/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1110,-856 935,-856 935,-832 1110,-832 1110,-856"/>
<text text-anchor="middle" x="1022.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge62" class="edge">
<title>interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M899.02,-844C907.49,-844 916.13,-844 924.7,-844"/>
<polygon fill="#000000" stroke="#000000" points="924.71,-847.5 934.71,-844 924.71,-840.5 924.71,-847.5"/>
</g>
</g>
</svg>
</div><script>var paninterfaceperform_apmCallsGraph = svgPanZoom('#interfaceperform_apmCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>
      <h2>public module module subroutine perform_apm(this, get_density, get_nstar_id, npart_output, pos_input, pvol, h_output, nu_output, center, com_star, mass, sizes, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, ghost_dist, use_atmosphere, remove_atmosphere, print_step, namefile_pos_id, namefile_pos, namefile_results, validate_position)   <a href='../proc/perform_apm.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
</h2>

    

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-this~53"></span>class(<a href='../type/particles.html'>particles</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>this</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
</tr>
<tr>
  <td colspan="7">
      <small><h5>function get_density(x, y, z) result(density)</h5><p>Returns the baryon mass density at the desired point</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>double precision</small></h6>  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
</small>
  </td> 
</tr>
<tr>
  <td colspan="7">
      <small><h5>subroutine get_nstar_id(npart, x, y, z, nstar_sph, nstar_id, nlrf_sph, sqg)</h5><p>Computes the proper baryon number density at the particle positions</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong>(npart)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong>(npart)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(npart)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_sph</strong>(npart)</td><td><p>\(\mathrm{SPH}\) proper baryon density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_id</strong>(npart)</td><td><p>Array to store the computed proper baryon number density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nlrf_sph</strong>(npart)</td><td><p>Array to store the local rest frame baryon density computed from
 the \(\mathrm{SPH}\) proper baryon density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>sqg</strong>(npart)</td><td><p>Square root of minus the determinant of the spacetime metric</p></td>
</tr>
</tbody>
</table>

</small>
  </td> 
</tr>
<tr>
  <td><span class="anchor" id="variable-npart_output"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_output</strong></td><td><p>Initial particle number</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos_input"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pvol~2"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nu_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-center~3"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-com_star~3"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass~3"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sizes~2"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(6)</td><td>::</td>
  <td><strong>sizes</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-apm_max_it"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max_inc"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass_it"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-correct_nu~2"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_thres"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_des"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nx_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ny_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nz_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ghost_dist"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ghost_dist</strong></td><td><p>Distance between the ghost particles and the surface
 of the matter object considered (star, ejecta, etc...)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-use_atmosphere~2"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_atmosphere</strong></td><td><p>If .TRUE., allows particles to move where the density
 is 0, and displace them using only the smoothing term.
 This can be useful when the system has an irregular
 geometry, as, for example, an ejecta; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-remove_atmosphere"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>remove_atmosphere</strong></td><td><p>If .TRUE., removes the particles placed where the density is 0,
 at the end of the APM iteration; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-print_step"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>print_step</strong></td><td><p>Prints the particle positions to a formatted file every
 print_step steps</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos_id"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions
 and the ghost positions will be printed</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions
 and the ghost positions will be printed every 15 iterations</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_results"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related
 to the particle distribution, the baryon number particle and the
 kernel estimate of the density will be printed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-validate_position"></span>procedure(validate_position_int),</td>
<td></td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
</tr>
</tbody>
</table>

    <h3>Description</h3>
    <p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
    <br>

 </div>
</div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-07-06 15:48:30           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>