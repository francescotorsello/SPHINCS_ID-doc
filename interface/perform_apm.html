
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>perform_apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.5</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>About</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>perform_apm
   <small>Interface</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">191 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/module_sph_particles.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/module_sph_particles.f90.html'>module_sph_particles.f90</a></li>
     <li><a href='../module/sph_particles.html'>sph_particles</a></li>
     <li class="active">perform_apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<em>None</em>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>interface</h2>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: interface~~perform_apm~~CallsGraph Pages: 1 -->
<svg id="interfaceperform_apmCallsGraph" width="641pt" height="842pt"
 viewBox="0.00 0.00 641.00 841.67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="interface~~perform_apm~~CallsGraph" class="graph" transform="scale(1.74 1.74) rotate(0) translate(4 1464)">
<title>interface~~perform_apm~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1464 1114,-1464 1114,4 -4,4"/>
<!-- interface~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node1" class="node">
<title>interface~perform_apm</title>
<polygon fill="none" stroke="black" points="85,-738 0,-738 0,-714 85,-714 85,-738"/>
<text text-anchor="middle" x="42.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50">perform_apm</text>
</g>
<!-- proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node2" class="node">
<title>proc~perform_apm</title>
<g id="a_interface~~perform_apm~~CallsGraph_node2"><a xlink:href=".././proc/perform_apm.html" xlink:title="perform_apm">
<polygon fill="#d9534f" stroke="#d9534f" points="206,-738 121,-738 121,-714 206,-714 206,-738"/>
<text text-anchor="middle" x="163.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_apm</text>
</a>
</g>
</g>
<!-- interface~perform_apm&#45;&gt;proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_edge1" class="edge">
<title>interface~perform_apm&#45;&gt;proc~perform_apm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M85.12,-726C93.32,-726 102.01,-726 110.5,-726"/>
<polygon fill="#000000" stroke="#000000" points="110.7,-729.5 120.7,-726 110.7,-722.5 110.7,-729.5"/>
</g>
<!-- lpart -->
<g id="interface~~perform_apm~~CallsGraph_node3" class="node">
<title>lpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1460 317.5,-1460 317.5,-1436 371.5,-1436 371.5,-1460"/>
<text text-anchor="middle" x="344.5" y="-1445.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;lpart -->
<g id="interface~~perform_apm~~CallsGraph_edge2" class="edge">
<title>proc~perform_apm&#45;&gt;lpart</title>
<path fill="none" stroke="#000000" d="M164.99,-738.02C168.7,-826.4 193.53,-1373.75 242,-1427 258.21,-1444.81 285.2,-1449.74 307.28,-1450.38"/>
<polygon fill="#000000" stroke="#000000" points="307.33,-1453.88 317.34,-1450.4 307.34,-1446.88 307.33,-1453.88"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node4" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node4"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="447,-1418 242,-1418 242,-1394 447,-1394 447,-1418"/>
<text text-anchor="middle" x="344.5" y="-1403.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge3" class="edge">
<title>proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M165.13,-738.27C169.62,-823.85 197.9,-1329.62 242,-1380 244.75,-1383.14 247.83,-1385.93 251.15,-1388.41"/>
<polygon fill="#000000" stroke="#000000" points="249.53,-1391.52 259.85,-1393.92 253.28,-1385.61 249.53,-1391.52"/>
</g>
<!-- deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node5" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="416,-1188 273,-1188 273,-1164 416,-1164 416,-1188"/>
<text text-anchor="middle" x="344.5" y="-1173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge4" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M164.92,-738.06C167.35,-801.2 181.77,-1093.22 242,-1155 248.05,-1161.2 255.41,-1165.82 263.39,-1169.22"/>
<polygon fill="#000000" stroke="#000000" points="262.39,-1172.58 272.98,-1172.68 264.76,-1165.99 262.39,-1172.58"/>
</g>
<!-- deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node6" class="node">
<title>deallocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="433.5,-1146 255.5,-1146 255.5,-1122 433.5,-1122 433.5,-1146"/>
<text text-anchor="middle" x="344.5" y="-1131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge5" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M165.17,-738.04C168.73,-797.37 187.3,-1057.95 242,-1113 243.47,-1114.48 245.02,-1115.88 246.64,-1117.18"/>
<polygon fill="#000000" stroke="#000000" points="244.98,-1120.29 255.22,-1123.02 248.92,-1114.5 244.98,-1120.29"/>
</g>
<!-- timer -->
<g id="interface~~perform_apm~~CallsGraph_node7" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1104 317.5,-1104 317.5,-1080 371.5,-1080 371.5,-1104"/>
<text text-anchor="middle" x="344.5" y="-1089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~perform_apm&#45;&gt;timer -->
<g id="interface~~perform_apm~~CallsGraph_edge6" class="edge">
<title>proc~perform_apm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M165.5,-738.19C170.31,-793.79 192.86,-1022.69 242,-1071 258.98,-1087.7 285.53,-1092.74 307.22,-1093.72"/>
<polygon fill="#000000" stroke="#000000" points="307.35,-1097.22 317.41,-1093.91 307.48,-1090.23 307.35,-1097.22"/>
</g>
<!-- deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node8" class="node">
<title>deallocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="438,-1062 251,-1062 251,-1038 438,-1038 438,-1062"/>
<text text-anchor="middle" x="344.5" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge7" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M166.01,-738.16C172.55,-788.78 199.97,-982.12 242,-1024 245.44,-1027.43 249.27,-1030.43 253.37,-1033.05"/>
<polygon fill="#000000" stroke="#000000" points="251.68,-1036.11 262.12,-1037.9 255.08,-1029.99 251.68,-1036.11"/>
</g>
<!-- none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_node9" class="node">
<title>none~dump_apm_pos</title>
<polygon fill="#d9534f" stroke="#d9534f" points="393,-902 296,-902 296,-878 393,-878 393,-902"/>
<text text-anchor="middle" x="344.5" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dump_apm_pos</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_edge8" class="edge">
<title>proc~perform_apm&#45;&gt;none~dump_apm_pos</title>
<path fill="none" stroke="#000000" d="M167.39,-738.28C174.65,-766.3 196.44,-835.15 242,-869 254.62,-878.38 270.44,-883.8 285.82,-886.87"/>
<polygon fill="#000000" stroke="#000000" points="285.38,-890.35 295.82,-888.57 286.55,-883.45 285.38,-890.35"/>
</g>
<!-- allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node10" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="409.5,-738 279.5,-738 279.5,-714 409.5,-714 409.5,-738"/>
<text text-anchor="middle" x="344.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge9" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M206.02,-726C224.83,-726 247.66,-726 269.26,-726"/>
<polygon fill="#000000" stroke="#000000" points="269.41,-729.5 279.41,-726 269.41,-722.5 269.41,-729.5"/>
</g>
<!-- proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_node11" class="node">
<title>proc~spherical_from_cartesian</title>
<g id="a_interface~~perform_apm~~CallsGraph_node11"><a xlink:href=".././proc/spherical_from_cartesian.html" xlink:title="spherical_from_cartesian">
<polygon fill="#d9534f" stroke="#d9534f" points="658.5,-818 512.5,-818 512.5,-794 658.5,-794 658.5,-818"/>
<text text-anchor="middle" x="585.5" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spherical_from_cartesian</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge10" class="edge">
<title>proc~perform_apm&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M174.82,-738.19C188.44,-753.27 213.99,-778.26 242,-789 326.25,-821.3 430.77,-821.31 502.05,-815.95"/>
<polygon fill="#000000" stroke="#000000" points="502.63,-819.41 512.32,-815.12 502.07,-812.44 502.63,-819.41"/>
</g>
<!-- interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node12" class="node">
<title>interface~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node12"><a xlink:href=".././interface/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#a7506f" stroke="#a7506f" points="415.5,-696 273.5,-696 273.5,-672 415.5,-672 415.5,-696"/>
<text text-anchor="middle" x="344.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge11" class="edge">
<title>proc~perform_apm&#45;&gt;interface~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M206.21,-714.2C217.77,-711.07 230.34,-707.78 242,-705 251.88,-702.64 262.34,-700.3 272.64,-698.09"/>
<polygon fill="#000000" stroke="#000000" points="273.39,-701.51 282.45,-696.01 271.94,-694.66 273.39,-701.51"/>
</g>
<!-- nic -->
<g id="interface~~perform_apm~~CallsGraph_node13" class="node">
<title>nic</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-654 317.5,-654 317.5,-630 371.5,-630 371.5,-654"/>
<text text-anchor="middle" x="344.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nic</text>
</g>
<!-- proc~perform_apm&#45;&gt;nic -->
<g id="interface~~perform_apm~~CallsGraph_edge12" class="edge">
<title>proc~perform_apm&#45;&gt;nic</title>
<path fill="none" stroke="#000000" d="M175.6,-713.98C189.63,-699.55 215.22,-675.72 242,-663 262.49,-653.27 287.4,-648.03 307.42,-645.22"/>
<polygon fill="#000000" stroke="#000000" points="307.91,-648.69 317.39,-643.96 307.03,-641.74 307.91,-648.69"/>
</g>
<!-- density_loop -->
<g id="interface~~perform_apm~~CallsGraph_node14" class="node">
<title>density_loop</title>
<polygon fill="#777777" stroke="#777777" points="384,-612 305,-612 305,-588 384,-588 384,-612"/>
<text text-anchor="middle" x="344.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density_loop</text>
</g>
<!-- proc~perform_apm&#45;&gt;density_loop -->
<g id="interface~~perform_apm~~CallsGraph_edge13" class="edge">
<title>proc~perform_apm&#45;&gt;density_loop</title>
<path fill="none" stroke="#000000" d="M169.74,-713.99C180.09,-691.79 205.36,-644.46 242,-621 257.58,-611.02 277.02,-605.67 294.7,-602.84"/>
<polygon fill="#000000" stroke="#000000" points="295.44,-606.27 304.87,-601.45 294.49,-599.34 295.44,-606.27"/>
</g>
<!-- allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node15" class="node">
<title>allocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="397.5,-570 291.5,-570 291.5,-546 397.5,-546 397.5,-570"/>
<text text-anchor="middle" x="344.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge14" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_gradient</title>
<path fill="none" stroke="#000000" d="M167.17,-713.81C174.1,-685.3 195.42,-614.03 242,-579 253.34,-570.47 267.33,-565.2 281.25,-562"/>
<polygon fill="#000000" stroke="#000000" points="282.21,-565.38 291.34,-560.01 280.85,-558.51 282.21,-565.38"/>
</g>
<!-- position_correction -->
<g id="interface~~perform_apm~~CallsGraph_node16" class="node">
<title>position_correction</title>
<polygon fill="#777777" stroke="#777777" points="401,-528 288,-528 288,-504 401,-504 401,-528"/>
<text text-anchor="middle" x="344.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">position_correction</text>
</g>
<!-- proc~perform_apm&#45;&gt;position_correction -->
<g id="interface~~perform_apm~~CallsGraph_edge15" class="edge">
<title>proc~perform_apm&#45;&gt;position_correction</title>
<path fill="none" stroke="#000000" d="M165.67,-713.53C169.55,-679.44 185.24,-584.12 242,-537 252.21,-528.53 264.95,-523.19 277.92,-519.89"/>
<polygon fill="#000000" stroke="#000000" points="278.82,-523.28 287.85,-517.75 277.34,-516.44 278.82,-523.28"/>
</g>
<!-- none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_node17" class="node">
<title>none~discard_atmosphere</title>
<polygon fill="#d9534f" stroke="#d9534f" points="405,-944 284,-944 284,-920 405,-920 405,-944"/>
<text text-anchor="middle" x="344.5" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">discard_atmosphere</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_edge16" class="edge">
<title>proc~perform_apm&#45;&gt;none~discard_atmosphere</title>
<path fill="none" stroke="#000000" d="M165.76,-738.22C169.87,-771.6 186.09,-864.95 242,-911 251.22,-918.6 262.49,-923.67 274.12,-927.01"/>
<polygon fill="#000000" stroke="#000000" points="273.39,-930.43 283.94,-929.43 275.07,-923.64 273.39,-930.43"/>
</g>
<!-- nu -->
<g id="interface~~perform_apm~~CallsGraph_node18" class="node">
<title>nu</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1028 558.5,-1028 558.5,-1004 612.5,-1004 612.5,-1028"/>
<text text-anchor="middle" x="585.5" y="-1013.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu</text>
</g>
<!-- proc~perform_apm&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge17" class="edge">
<title>proc~perform_apm&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M163.96,-738.02C162.82,-779.37 165.18,-916.63 242,-980 287.92,-1017.88 469.64,-1018.61 548.11,-1017.07"/>
<polygon fill="#000000" stroke="#000000" points="548.55,-1020.56 558.47,-1016.84 548.39,-1013.56 548.55,-1020.56"/>
</g>
<!-- ncand -->
<g id="interface~~perform_apm~~CallsGraph_node19" class="node">
<title>ncand</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-486 317.5,-486 317.5,-462 371.5,-462 371.5,-486"/>
<text text-anchor="middle" x="344.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ncand</text>
</g>
<!-- proc~perform_apm&#45;&gt;ncand -->
<g id="interface~~perform_apm~~CallsGraph_edge18" class="edge">
<title>proc~perform_apm&#45;&gt;ncand</title>
<path fill="none" stroke="#000000" d="M164.61,-713.97C165.66,-675.57 174.43,-554.93 242,-495 259.7,-479.3 285.99,-474.19 307.38,-472.93"/>
<polygon fill="#000000" stroke="#000000" points="307.56,-476.43 317.43,-472.59 307.32,-469.43 307.56,-476.43"/>
</g>
<!-- none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_node20" class="node">
<title>none~reallocate_output_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="414,-780 275,-780 275,-756 414,-756 414,-780"/>
<text text-anchor="middle" x="344.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reallocate_output_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge19" class="edge">
<title>proc~perform_apm&#45;&gt;none~reallocate_output_fields</title>
<path fill="none" stroke="#000000" d="M206.21,-737.8C217.77,-740.93 230.34,-744.22 242,-747 251.88,-749.36 262.34,-751.7 272.64,-753.91"/>
<polygon fill="#000000" stroke="#000000" points="271.94,-757.34 282.45,-755.99 273.39,-750.49 271.94,-757.34"/>
</g>
<!-- exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_node21" class="node">
<title>exact_nei_tree_update</title>
<polygon fill="#777777" stroke="#777777" points="410.5,-444 278.5,-444 278.5,-420 410.5,-420 410.5,-444"/>
<text text-anchor="middle" x="344.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_nei_tree_update</text>
</g>
<!-- proc~perform_apm&#45;&gt;exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_edge20" class="edge">
<title>proc~perform_apm&#45;&gt;exact_nei_tree_update</title>
<path fill="none" stroke="#000000" d="M163.9,-713.99C162.46,-671.34 163.71,-525.81 242,-453 249.59,-445.94 258.9,-441 268.78,-437.57"/>
<polygon fill="#000000" stroke="#000000" points="269.78,-440.92 278.38,-434.73 267.8,-434.21 269.78,-440.92"/>
</g>
<!-- rpart -->
<g id="interface~~perform_apm~~CallsGraph_node22" class="node">
<title>rpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-402 317.5,-402 317.5,-378 371.5,-378 371.5,-402"/>
<text text-anchor="middle" x="344.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;rpart -->
<g id="interface~~perform_apm~~CallsGraph_edge21" class="edge">
<title>proc~perform_apm&#45;&gt;rpart</title>
<path fill="none" stroke="#000000" d="M165.78,-713.82C171.53,-661.26 196.78,-454.57 242,-411 259.04,-394.58 285.35,-389.49 306.91,-388.42"/>
<polygon fill="#000000" stroke="#000000" points="307.14,-391.92 317.06,-388.19 306.98,-384.92 307.14,-391.92"/>
</g>
<!-- allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node23" class="node">
<title>allocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="427,-360 262,-360 262,-336 427,-336 427,-360"/>
<text text-anchor="middle" x="344.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge22" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M165.4,-713.77C169.85,-656.93 191.3,-419.21 242,-369 245.16,-365.87 248.67,-363.14 252.41,-360.78"/>
<polygon fill="#000000" stroke="#000000" points="254.37,-363.7 261.54,-355.89 251.07,-357.52 254.37,-363.7"/>
</g>
<!-- proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_node24" class="node">
<title>proc~is_finite_number</title>
<g id="a_interface~~perform_apm~~CallsGraph_node24"><a xlink:href=".././proc/is_finite_number.html" xlink:title="is_finite_number">
<polygon fill="#d94e8f" stroke="#d94e8f" points="861.5,-1298 761.5,-1298 761.5,-1274 861.5,-1274 861.5,-1298"/>
<text text-anchor="middle" x="811.5" y="-1283.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_finite_number</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge23" class="edge">
<title>proc~perform_apm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M164.55,-738.05C165.11,-805.26 171.47,-1133.22 242,-1197 315.65,-1263.61 592.09,-1199.24 688,-1225 722.79,-1234.34 759.34,-1254.02 783.37,-1268.51"/>
<polygon fill="#000000" stroke="#000000" points="781.58,-1271.52 791.93,-1273.78 785.25,-1265.56 781.58,-1271.52"/>
</g>
<!-- proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_node25" class="node">
<title>proc~find_h_backup</title>
<g id="a_interface~~perform_apm~~CallsGraph_node25"><a xlink:href=".././proc/find_h_backup.html" xlink:title="find_h_backup">
<polygon fill="#d94e8f" stroke="#d94e8f" points="389,-318 300,-318 300,-294 389,-294 389,-318"/>
<text text-anchor="middle" x="344.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_h_backup</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_edge24" class="edge">
<title>proc~perform_apm&#45;&gt;proc~find_h_backup</title>
<path fill="none" stroke="#000000" d="M165.09,-713.99C168.31,-653.63 185.71,-383.98 242,-327 254.47,-314.37 272.41,-308.36 289.74,-305.74"/>
<polygon fill="#000000" stroke="#000000" points="290.3,-309.19 299.82,-304.56 289.49,-302.24 290.3,-309.19"/>
</g>
<!-- h -->
<g id="interface~~perform_apm~~CallsGraph_node26" class="node">
<title>h</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-986 558.5,-986 558.5,-962 612.5,-962 612.5,-986"/>
<text text-anchor="middle" x="585.5" y="-971.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~perform_apm&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge25" class="edge">
<title>proc~perform_apm&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M164.35,-738.23C164.62,-777.21 171.3,-899.09 242,-953 289.11,-988.93 469.76,-981.7 548.01,-976.69"/>
<polygon fill="#000000" stroke="#000000" points="548.6,-980.16 558.35,-976.01 548.14,-973.18 548.6,-980.16"/>
</g>
<!-- interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node27" class="node">
<title>interface~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node27"><a xlink:href=".././interface/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#a7506f" stroke="#a7506f" points="413.5,-1329 275.5,-1329 275.5,-1305 413.5,-1305 413.5,-1329"/>
<text text-anchor="middle" x="344.5" y="-1314.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge26" class="edge">
<title>proc~perform_apm&#45;&gt;interface~correct_center_of_mass</title>
<path fill="none" stroke="#000000" d="M164.6,-738.23C165.41,-811.25 172.93,-1189.38 242,-1277 250.27,-1287.49 261.69,-1295.24 273.89,-1300.95"/>
<polygon fill="#000000" stroke="#000000" points="272.76,-1304.28 283.33,-1304.94 275.48,-1297.83 272.76,-1304.28"/>
</g>
<!-- none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_node28" class="node">
<title>none~validate_position_final</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="410,-276 279,-276 279,-252 410,-252 410,-276"/>
<text text-anchor="middle" x="344.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position_final</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_edge27" class="edge">
<title>proc~perform_apm&#45;&gt;none~validate_position_final</title>
<path fill="none" stroke="#000000" d="M164.86,-713.61C167.03,-648.72 180.29,-348.6 242,-285 249.45,-277.32 258.93,-272.07 269.07,-268.54"/>
<polygon fill="#000000" stroke="#000000" points="270.34,-271.82 278.97,-265.67 268.39,-265.1 270.34,-271.82"/>
</g>
<!-- none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_node29" class="node">
<title>none~allocate_apm_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-234 285.5,-234 285.5,-210 403.5,-210 403.5,-234"/>
<text text-anchor="middle" x="344.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_apm_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge28" class="edge">
<title>proc~perform_apm&#45;&gt;none~allocate_apm_fields</title>
<path fill="none" stroke="#000000" d="M164.65,-713.81C165.77,-645.76 174.65,-313.44 242,-243 250.93,-233.66 262.83,-227.91 275.34,-224.47"/>
<polygon fill="#000000" stroke="#000000" points="276.48,-227.8 285.46,-222.18 274.93,-220.97 276.48,-227.8"/>
</g>
<!-- none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_node30" class="node">
<title>none~place_and_print_ghost_particles</title>
<polygon fill="#d9534f" stroke="#d9534f" points="436,-860 253,-860 253,-836 436,-836 436,-860"/>
<text text-anchor="middle" x="344.5" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">place_and_print_ghost_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge29" class="edge">
<title>proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles</title>
<path fill="none" stroke="#000000" d="M170.83,-738.11C182.21,-758.66 208.12,-800.23 242,-822 248.31,-826.06 255.23,-829.48 262.38,-832.37"/>
<polygon fill="#000000" stroke="#000000" points="261.67,-835.84 272.26,-835.99 264.07,-829.26 261.67,-835.84"/>
</g>
<!-- density -->
<g id="interface~~perform_apm~~CallsGraph_node31" class="node">
<title>density</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-192 317.5,-192 317.5,-168 371.5,-168 371.5,-192"/>
<text text-anchor="middle" x="344.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density</text>
</g>
<!-- proc~perform_apm&#45;&gt;density -->
<g id="interface~~perform_apm~~CallsGraph_edge30" class="edge">
<title>proc~perform_apm&#45;&gt;density</title>
<path fill="none" stroke="#000000" d="M164.48,-713.71C164.65,-642 169.1,-278.21 242,-201 258.35,-183.68 284.92,-178.66 306.78,-177.84"/>
<polygon fill="#000000" stroke="#000000" points="307.09,-181.34 317.06,-177.75 307.03,-174.34 307.09,-181.34"/>
</g>
<!-- com -->
<g id="interface~~perform_apm~~CallsGraph_node32" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-1376 784.5,-1376 784.5,-1352 838.5,-1352 838.5,-1376"/>
<text text-anchor="middle" x="811.5" y="-1361.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">com</text>
</g>
<!-- proc~perform_apm&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge31" class="edge">
<title>proc~perform_apm&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M165.11,-738.1C169.39,-820.38 196.01,-1295.56 242,-1338 319.29,-1409.32 661.16,-1380 774.13,-1368.11"/>
<polygon fill="#000000" stroke="#000000" points="774.76,-1371.56 784.33,-1367.01 774.01,-1364.6 774.76,-1371.56"/>
</g>
<!-- deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node33" class="node">
<title>deallocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="404,-150 285,-150 285,-126 404,-126 404,-150"/>
<text text-anchor="middle" x="344.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge32" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_gradient</title>
<path fill="none" stroke="#000000" d="M164.34,-713.72C163.6,-638.75 163.5,-243.04 242,-159 250.72,-149.66 262.42,-143.89 274.76,-140.42"/>
<polygon fill="#000000" stroke="#000000" points="275.8,-143.77 284.76,-138.11 274.23,-136.95 275.8,-143.77"/>
</g>
<!-- assign_h -->
<g id="interface~~perform_apm~~CallsGraph_node34" class="node">
<title>assign_h</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-108 315.5,-108 315.5,-84 373.5,-84 373.5,-108"/>
<text text-anchor="middle" x="344.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">assign_h</text>
</g>
<!-- proc~perform_apm&#45;&gt;assign_h -->
<g id="interface~~perform_apm~~CallsGraph_edge33" class="edge">
<title>proc~perform_apm&#45;&gt;assign_h</title>
<path fill="none" stroke="#000000" d="M164.21,-713.85C162.63,-636.02 157.85,-207.94 242,-117 257.76,-99.98 283.38,-94.77 304.94,-93.8"/>
<polygon fill="#000000" stroke="#000000" points="305.19,-97.3 315.13,-93.63 305.08,-90.3 305.19,-97.3"/>
</g>
<!-- none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_node35" class="node">
<title>none~get_nstar_id_atm</title>
<polygon fill="#d9534f" stroke="#d9534f" points="396,-1268 293,-1268 293,-1244 396,-1244 396,-1268"/>
<text text-anchor="middle" x="344.5" y="-1253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id_atm</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_edge34" class="edge">
<title>proc~perform_apm&#45;&gt;none~get_nstar_id_atm</title>
<path fill="none" stroke="#000000" d="M164.62,-738.21C165.56,-807.85 173.63,-1154.56 242,-1230 252.57,-1241.66 267.6,-1248.41 282.85,-1252.24"/>
<polygon fill="#000000" stroke="#000000" points="282.36,-1255.71 292.87,-1254.35 283.81,-1248.86 282.36,-1255.71"/>
</g>
<!-- allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node36" class="node">
<title>allocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="431,-66 258,-66 258,-42 431,-42 431,-66"/>
<text text-anchor="middle" x="344.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge35" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M165.11,-713.76C169.45,-628.42 196.93,-124.1 242,-75 244.11,-72.7 246.4,-70.62 248.84,-68.73"/>
<polygon fill="#000000" stroke="#000000" points="251.14,-71.41 257.63,-63.04 247.33,-65.53 251.14,-71.41"/>
</g>
<!-- iorig -->
<g id="interface~~perform_apm~~CallsGraph_node37" class="node">
<title>iorig</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-24 317.5,-24 317.5,0 371.5,0 371.5,-24"/>
<text text-anchor="middle" x="344.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iorig</text>
</g>
<!-- proc~perform_apm&#45;&gt;iorig -->
<g id="interface~~perform_apm~~CallsGraph_edge36" class="edge">
<title>proc~perform_apm&#45;&gt;iorig</title>
<path fill="none" stroke="#000000" d="M165.01,-713.84C168.83,-625.59 194.09,-85.57 242,-33 258.22,-15.2 285.21,-10.27 307.29,-9.62"/>
<polygon fill="#000000" stroke="#000000" points="307.35,-13.12 317.34,-9.6 307.34,-6.12 307.35,-13.12"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node45" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node45"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="688,-1418 483,-1418 483,-1394 688,-1394 688,-1418"/>
<text text-anchor="middle" x="585.5" y="-1403.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge37" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.2,-1406C455.7,-1406 464.31,-1406 472.87,-1406"/>
<polygon fill="#000000" stroke="#000000" points="472.89,-1409.5 482.89,-1406 472.89,-1402.5 472.89,-1409.5"/>
</g>
<!-- get_density -->
<g id="interface~~perform_apm~~CallsGraph_node42" class="node">
<title>get_density</title>
<polygon fill="#777777" stroke="#777777" points="622,-944 549,-944 549,-920 622,-920 622,-944"/>
<text text-anchor="middle" x="585.5" y="-929.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_density</text>
</g>
<!-- none~dump_apm_pos&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge38" class="edge">
<title>none~dump_apm_pos&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M393,-898.35C435.39,-905.8 497.03,-916.63 538.84,-923.98"/>
<polygon fill="#000000" stroke="#000000" points="538.3,-927.44 548.76,-925.72 539.51,-920.54 538.3,-927.44"/>
</g>
<!-- proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node38" class="node">
<title>proc~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node38"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="656.5,-650 514.5,-650 514.5,-626 656.5,-626 656.5,-650"/>
<text text-anchor="middle" x="585.5" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- interface~check_particle_positions&#45;&gt;proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge39" class="edge">
<title>interface~check_particle_positions&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M407.98,-671.97C439.82,-665.85 478.71,-658.36 511.87,-651.98"/>
<polygon fill="#000000" stroke="#000000" points="512.81,-655.36 521.97,-650.04 511.49,-648.49 512.81,-655.36"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge41" class="edge">
<title>none~discard_atmosphere&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M367.74,-944.09C394.42,-958.15 440.83,-981.17 483,-995 504.16,-1001.94 528.58,-1007.08 548.17,-1010.53"/>
<polygon fill="#000000" stroke="#000000" points="547.77,-1014.01 558.21,-1012.23 548.94,-1007.11 547.77,-1014.01"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge42" class="edge">
<title>none~discard_atmosphere&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M405.19,-942.49C450.18,-950.4 510.41,-960.98 548.34,-967.65"/>
<polygon fill="#000000" stroke="#000000" points="547.96,-971.13 558.41,-969.42 549.17,-964.24 547.96,-971.13"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge40" class="edge">
<title>none~discard_atmosphere&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M405.19,-932C446.52,-932 500.7,-932 538.65,-932"/>
<polygon fill="#000000" stroke="#000000" points="538.9,-935.5 548.9,-932 538.9,-928.5 538.9,-935.5"/>
</g>
<!-- pos_input -->
<g id="interface~~perform_apm~~CallsGraph_node41" class="node">
<title>pos_input</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-776 553.5,-776 553.5,-752 617.5,-752 617.5,-776"/>
<text text-anchor="middle" x="585.5" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pos_input</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge43" class="edge">
<title>none~reallocate_output_fields&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M414.31,-766.85C455.92,-766.15 507.61,-765.29 543.03,-764.69"/>
<polygon fill="#000000" stroke="#000000" points="543.54,-768.19 553.48,-764.52 543.42,-761.19 543.54,-768.19"/>
</g>
<!-- nu_output -->
<g id="interface~~perform_apm~~CallsGraph_node43" class="node">
<title>nu_output</title>
<polygon fill="#777777" stroke="#777777" points="618.5,-692 552.5,-692 552.5,-668 618.5,-668 618.5,-692"/>
<text text-anchor="middle" x="585.5" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;nu_output -->
<g id="interface~~perform_apm~~CallsGraph_edge44" class="edge">
<title>none~reallocate_output_fields&#45;&gt;nu_output</title>
<path fill="none" stroke="#000000" d="M414.1,-760.67C425.63,-757.56 437.06,-753.17 447,-747 469.06,-733.31 460.94,-714.69 483,-701 500.63,-690.06 522.96,-684.72 542.19,-682.15"/>
<polygon fill="#000000" stroke="#000000" points="542.67,-685.61 552.21,-681.01 541.88,-678.66 542.67,-685.61"/>
</g>
<!-- h_output -->
<g id="interface~~perform_apm~~CallsGraph_node48" class="node">
<title>h_output</title>
<polygon fill="#777777" stroke="#777777" points="615,-734 556,-734 556,-710 615,-710 615,-734"/>
<text text-anchor="middle" x="585.5" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;h_output -->
<g id="interface~~perform_apm~~CallsGraph_edge45" class="edge">
<title>none~reallocate_output_fields&#45;&gt;h_output</title>
<path fill="none" stroke="#000000" d="M407.98,-755.97C451.72,-747.56 508.78,-736.57 546.01,-729.41"/>
<polygon fill="#000000" stroke="#000000" points="546.8,-732.82 555.96,-727.49 545.48,-725.95 546.8,-732.82"/>
</g>
<!-- proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node40" class="node">
<title>proc~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node40"><a xlink:href=".././proc/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#d9534f" stroke="#d9534f" points="654.5,-1338 516.5,-1338 516.5,-1314 654.5,-1314 654.5,-1338"/>
<text text-anchor="middle" x="585.5" y="-1323.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge46" class="edge">
<title>interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.67,-1319.57C442.42,-1320.65 476.08,-1321.92 505.88,-1323.04"/>
<polygon fill="#000000" stroke="#000000" points="506.12,-1326.55 516.24,-1323.43 506.38,-1319.56 506.12,-1326.55"/>
</g>
<!-- validate_position -->
<g id="interface~~perform_apm~~CallsGraph_node46" class="node">
<title>validate_position</title>
<polygon fill="#777777" stroke="#777777" points="637,-276 534,-276 534,-252 637,-252 637,-276"/>
<text text-anchor="middle" x="585.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position</text>
</g>
<!-- none~validate_position_final&#45;&gt;validate_position -->
<g id="interface~~perform_apm~~CallsGraph_edge47" class="edge">
<title>none~validate_position_final&#45;&gt;validate_position</title>
<path fill="none" stroke="#000000" d="M410.18,-264C445.53,-264 489.06,-264 523.78,-264"/>
<polygon fill="#000000" stroke="#000000" points="523.79,-267.5 533.79,-264 523.79,-260.5 523.79,-267.5"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge52" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M413.99,-835.96C442.74,-830.91 476.34,-825.01 506.08,-819.78"/>
<polygon fill="#000000" stroke="#000000" points="506.76,-823.22 516,-818.04 505.55,-816.32 506.76,-823.22"/>
</g>
<!-- center -->
<g id="interface~~perform_apm~~CallsGraph_node39" class="node">
<title>center</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-860 558.5,-860 558.5,-836 612.5,-836 612.5,-860"/>
<text text-anchor="middle" x="585.5" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">center</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;center -->
<g id="interface~~perform_apm~~CallsGraph_edge48" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;center</title>
<path fill="none" stroke="#000000" d="M436.2,-848C475.13,-848 518.39,-848 548.09,-848"/>
<polygon fill="#000000" stroke="#000000" points="548.39,-851.5 558.39,-848 548.39,-844.5 548.39,-851.5"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge49" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M367.74,-835.91C394.42,-821.85 440.83,-798.83 483,-785 502.48,-778.61 524.72,-773.75 543.4,-770.32"/>
<polygon fill="#000000" stroke="#000000" points="544.14,-773.75 553.38,-768.57 542.92,-766.86 544.14,-773.75"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge50" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M427.88,-860.09C434.57,-862.54 441.03,-865.48 447,-869 468.17,-881.49 461.83,-898.51 483,-911 499.66,-920.83 520.23,-926.11 538.48,-928.92"/>
<polygon fill="#000000" stroke="#000000" points="538.25,-932.42 548.63,-930.28 539.18,-925.49 538.25,-932.42"/>
</g>
<!-- sizes -->
<g id="interface~~perform_apm~~CallsGraph_node47" class="node">
<title>sizes</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-902 558.5,-902 558.5,-878 612.5,-878 612.5,-902"/>
<text text-anchor="middle" x="585.5" y="-887.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sizes</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;sizes -->
<g id="interface~~perform_apm~~CallsGraph_edge51" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;sizes</title>
<path fill="none" stroke="#000000" d="M413.99,-860.04C457.8,-867.74 512.88,-877.41 548.38,-883.65"/>
<polygon fill="#000000" stroke="#000000" points="547.84,-887.11 558.3,-885.4 549.05,-880.22 547.84,-887.11"/>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge54" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M396.09,-1260.31C422.06,-1262.46 454.21,-1265.01 483,-1267 576.71,-1273.47 685.6,-1279.49 751.22,-1282.95"/>
<polygon fill="#000000" stroke="#000000" points="751.21,-1286.46 761.38,-1283.49 751.57,-1279.47 751.21,-1286.46"/>
</g>
<!-- get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_node44" class="node">
<title>get_nstar_id</title>
<polygon fill="#777777" stroke="#777777" points="624,-1258 547,-1258 547,-1234 624,-1234 624,-1258"/>
<text text-anchor="middle" x="585.5" y="-1243.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id</text>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_edge53" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;get_nstar_id</title>
<path fill="none" stroke="#000000" d="M396.19,-1253.88C437.66,-1252.14 495.9,-1249.71 536.6,-1248"/>
<polygon fill="#000000" stroke="#000000" points="536.96,-1251.49 546.8,-1247.58 536.67,-1244.5 536.96,-1251.49"/>
</g>
<!-- indexx -->
<g id="interface~~perform_apm~~CallsGraph_node50" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-650 784.5,-650 784.5,-626 838.5,-626 838.5,-650"/>
<text text-anchor="middle" x="811.5" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="interface~~perform_apm~~CallsGraph_edge55" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M656.76,-638C695.72,-638 742.55,-638 774.21,-638"/>
<polygon fill="#000000" stroke="#000000" points="774.33,-641.5 784.33,-638 774.33,-634.5 774.33,-641.5"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge57" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M653.71,-1314C684.85,-1308.44 721.53,-1301.89 751.58,-1296.52"/>
<polygon fill="#000000" stroke="#000000" points="752.27,-1299.95 761.5,-1294.75 751.04,-1293.06 752.27,-1299.95"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge56" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M654.62,-1337.56C694.11,-1344.26 742.24,-1352.42 774.48,-1357.89"/>
<polygon fill="#000000" stroke="#000000" points="773.92,-1361.34 784.36,-1359.57 775.09,-1354.44 773.92,-1361.34"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge58" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M650.69,-1393.96C690.7,-1386.46 740.74,-1377.08 774.06,-1370.83"/>
<polygon fill="#000000" stroke="#000000" points="775.07,-1374.2 784.25,-1368.92 773.78,-1367.32 775.07,-1374.2"/>
</g>
<!-- interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node49" class="node">
<title>interface~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node49"><a xlink:href=".././interface/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="899,-1418 724,-1418 724,-1394 899,-1394 899,-1418"/>
<text text-anchor="middle" x="811.5" y="-1403.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge59" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" d="M688.01,-1406C696.49,-1406 705.05,-1406 713.49,-1406"/>
<polygon fill="#000000" stroke="#000000" points="713.72,-1409.5 723.72,-1406 713.72,-1402.5 713.72,-1409.5"/>
</g>
<!-- interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node51" class="node">
<title>interface~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node51"><a xlink:href=".././interface/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="886.5,-1460 736.5,-1460 736.5,-1436 886.5,-1436 886.5,-1460"/>
<text text-anchor="middle" x="811.5" y="-1445.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge60" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" d="M650.69,-1418.04C677.4,-1423.04 708.58,-1428.89 736.27,-1434.08"/>
<polygon fill="#000000" stroke="#000000" points="735.83,-1437.56 746.3,-1435.96 737.12,-1430.68 735.83,-1437.56"/>
</g>
<!-- proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node53" class="node">
<title>proc~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node53"><a xlink:href=".././proc/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1110,-1418 935,-1418 935,-1394 1110,-1394 1110,-1418"/>
<text text-anchor="middle" x="1022.5" y="-1403.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge61" class="edge">
<title>interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M899.02,-1406C907.49,-1406 916.13,-1406 924.7,-1406"/>
<polygon fill="#000000" stroke="#000000" points="924.71,-1409.5 934.71,-1406 924.71,-1402.5 924.71,-1409.5"/>
</g>
<!-- proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node52" class="node">
<title>proc~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node52"><a xlink:href=".././proc/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1097.5,-1460 947.5,-1460 947.5,-1436 1097.5,-1436 1097.5,-1460"/>
<text text-anchor="middle" x="1022.5" y="-1445.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge62" class="edge">
<title>interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M886.77,-1448C903.1,-1448 920.5,-1448 937.18,-1448"/>
<polygon fill="#000000" stroke="#000000" points="937.47,-1451.5 947.47,-1448 937.47,-1444.5 937.47,-1451.5"/>
</g>
</g>
</svg>
</div><script>var paninterfaceperform_apmCallsGraph = svgPanZoom('#interfaceperform_apmCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>
      <h2>public module module subroutine perform_apm(this, get_density, get_nstar_id, npart_output, pos_input, pvol, h_output, nu_output, center, com_star, mass, sizes, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, ghost_dist, use_atmosphere, remove_atmosphere, print_step, namefile_pos_id, namefile_pos, namefile_results, validate_position)   <a href='../proc/perform_apm.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
</h2>

    

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-this~53"></span>class(<a href='../type/particles.html'>particles</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>this</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
</tr>
<tr>
  <td colspan="7">
      <small><h5>function get_density(x, y, z) result(density)</h5><p>Returns the baryon mass density at the desired point</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>double precision</small></h6>  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
</small>
  </td> 
</tr>
<tr>
  <td colspan="7">
      <small><h5>subroutine get_nstar_id(npart, x, y, z, nstar_sph, nstar_id, nlrf_sph, sqg)</h5><p>Computes the proper baryon number density at the particle positions</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong>(npart)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong>(npart)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(npart)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_sph</strong>(npart)</td><td><p>\(\mathrm{SPH}\) proper baryon density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_id</strong>(npart)</td><td><p>Array to store the computed proper baryon number density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nlrf_sph</strong>(npart)</td><td><p>Array to store the local rest frame baryon density computed from
 the \(\mathrm{SPH}\) proper baryon density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>sqg</strong>(npart)</td><td><p>Square root of minus the determinant of the spacetime metric</p></td>
</tr>
</tbody>
</table>

</small>
  </td> 
</tr>
<tr>
  <td><span class="anchor" id="variable-npart_output"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_output</strong></td><td><p>Initial particle number</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos_input"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pvol~2"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nu_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-center~3"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-com_star~3"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass~3"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sizes~2"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(6)</td><td>::</td>
  <td><strong>sizes</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-apm_max_it"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max_inc"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass_it"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-correct_nu~2"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_thres"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_des"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nx_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ny_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nz_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ghost_dist"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ghost_dist</strong></td><td><p>Distance between the ghost particles and the surface
 of the matter object considered (star, ejecta, etc...)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-use_atmosphere~2"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_atmosphere</strong></td><td><p>If .TRUE., allows particles to move where the density
 is 0, and displace them using only the smoothing term.
 This can be useful when the system has an irregular
 geometry, as, for example, an ejecta; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-remove_atmosphere"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>remove_atmosphere</strong></td><td><p>If .TRUE., removes the particles placed where the density is 0,
 at the end of the APM iteration; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-print_step"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>print_step</strong></td><td><p>Prints the particle positions to a formatted file every
 print_step steps</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos_id"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions
 and the ghost positions will be printed</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions
 and the ghost positions will be printed every 15 iterations</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_results"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related
 to the particle distribution, the baryon number particle and the
 kernel estimate of the density will be printed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-validate_position"></span>procedure(validate_position_int),</td>
<td></td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
</tr>
</tbody>
</table>

    <h3>Description</h3>
    <p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
    <br>

 </div>
</div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-07-05 18:11:38           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>