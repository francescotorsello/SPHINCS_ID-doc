
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>perform_apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>More</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>perform_apm
   <small>Interface</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">187 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/module_sph_particles.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/module_sph_particles.f90.html'>module_sph_particles.f90</a></li>
     <li><a href='../module/sph_particles.html'>sph_particles</a></li>
     <li class="active">perform_apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<em>None</em>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>interface</h2>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: interface~~perform_apm~~CallsGraph Pages: 1 -->
<svg id="interfaceperform_apmCallsGraph" width="641pt" height="826pt"
 viewBox="0.00 0.00 641.00 825.62" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="interface~~perform_apm~~CallsGraph" class="graph" transform="scale(1.74 1.74) rotate(0) translate(4 1436)">
<title>interface~~perform_apm~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1436 1114,-1436 1114,4 -4,4"/>
<!-- interface~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node1" class="node">
<title>interface~perform_apm</title>
<polygon fill="none" stroke="black" points="85,-736 0,-736 0,-712 85,-712 85,-736"/>
<text text-anchor="middle" x="42.5" y="-721.6" font-family="Helvetica,sans-Serif" font-size="10.50">perform_apm</text>
</g>
<!-- proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node2" class="node">
<title>proc~perform_apm</title>
<g id="a_interface~~perform_apm~~CallsGraph_node2"><a xlink:href=".././proc/perform_apm.html" xlink:title="perform_apm">
<polygon fill="#d9534f" stroke="#d9534f" points="206,-736 121,-736 121,-712 206,-712 206,-736"/>
<text text-anchor="middle" x="163.5" y="-721.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_apm</text>
</a>
</g>
</g>
<!-- interface~perform_apm&#45;&gt;proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_edge1" class="edge">
<title>interface~perform_apm&#45;&gt;proc~perform_apm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M85.12,-724C93.32,-724 102.01,-724 110.5,-724"/>
<polygon fill="#000000" stroke="#000000" points="110.7,-727.5 120.7,-724 110.7,-720.5 110.7,-727.5"/>
</g>
<!-- none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_node3" class="node">
<title>none~allocate_apm_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-1432 285.5,-1432 285.5,-1408 403.5,-1408 403.5,-1432"/>
<text text-anchor="middle" x="344.5" y="-1417.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_apm_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge2" class="edge">
<title>proc~perform_apm&#45;&gt;none~allocate_apm_fields</title>
<path fill="none" stroke="#000000" d="M165.05,-736.12C169.08,-822.93 195.29,-1347.9 242,-1399 250.85,-1408.68 262.9,-1414.56 275.6,-1418"/>
<polygon fill="#000000" stroke="#000000" points="274.87,-1421.42 285.39,-1420.18 276.39,-1414.59 274.87,-1421.42"/>
</g>
<!-- none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_node4" class="node">
<title>none~validate_position_final</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="410,-1390 279,-1390 279,-1366 410,-1366 410,-1390"/>
<text text-anchor="middle" x="344.5" y="-1375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position_final</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_edge3" class="edge">
<title>proc~perform_apm&#45;&gt;none~validate_position_final</title>
<path fill="none" stroke="#000000" d="M164.21,-736.22C162.6,-815.45 157.57,-1256.01 242,-1352 249.31,-1360.31 258.89,-1366.14 269.23,-1370.2"/>
<polygon fill="#000000" stroke="#000000" points="268.31,-1373.58 278.91,-1373.45 270.54,-1366.95 268.31,-1373.58"/>
</g>
<!-- com -->
<g id="interface~~perform_apm~~CallsGraph_node5" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-1310 784.5,-1310 784.5,-1286 838.5,-1286 838.5,-1310"/>
<text text-anchor="middle" x="811.5" y="-1295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">com</text>
</g>
<!-- proc~perform_apm&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge4" class="edge">
<title>proc~perform_apm&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M165.13,-736.05C169.49,-816.94 196.31,-1278.87 242,-1319 321.07,-1388.44 662.42,-1327.72 774.61,-1305.42"/>
<polygon fill="#000000" stroke="#000000" points="775.32,-1308.85 784.44,-1303.45 773.94,-1301.99 775.32,-1308.85"/>
</g>
<!-- lpart -->
<g id="interface~~perform_apm~~CallsGraph_node6" class="node">
<title>lpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1226 317.5,-1226 317.5,-1202 371.5,-1202 371.5,-1226"/>
<text text-anchor="middle" x="344.5" y="-1211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;lpart -->
<g id="interface~~perform_apm~~CallsGraph_edge5" class="edge">
<title>proc~perform_apm&#45;&gt;lpart</title>
<path fill="none" stroke="#000000" d="M164.72,-736.28C166.18,-803.34 176.54,-1124.85 242,-1193 258.5,-1210.18 285.06,-1215.2 306.88,-1216.06"/>
<polygon fill="#000000" stroke="#000000" points="307.1,-1219.56 317.14,-1216.17 307.18,-1212.56 307.1,-1219.56"/>
</g>
<!-- position_correction -->
<g id="interface~~perform_apm~~CallsGraph_node7" class="node">
<title>position_correction</title>
<polygon fill="#777777" stroke="#777777" points="401,-1184 288,-1184 288,-1160 401,-1160 401,-1184"/>
<text text-anchor="middle" x="344.5" y="-1169.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">position_correction</text>
</g>
<!-- proc~perform_apm&#45;&gt;position_correction -->
<g id="interface~~perform_apm~~CallsGraph_edge6" class="edge">
<title>proc~perform_apm&#45;&gt;position_correction</title>
<path fill="none" stroke="#000000" d="M164.93,-736C167.4,-798.85 182.01,-1089.53 242,-1151 251.66,-1160.9 264.66,-1166.74 278.14,-1170.08"/>
<polygon fill="#000000" stroke="#000000" points="277.49,-1173.52 287.99,-1172.09 278.89,-1166.66 277.49,-1173.52"/>
</g>
<!-- exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_node8" class="node">
<title>exact_nei_tree_update</title>
<polygon fill="#777777" stroke="#777777" points="410.5,-1142 278.5,-1142 278.5,-1118 410.5,-1118 410.5,-1142"/>
<text text-anchor="middle" x="344.5" y="-1127.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_nei_tree_update</text>
</g>
<!-- proc~perform_apm&#45;&gt;exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_edge7" class="edge">
<title>proc~perform_apm&#45;&gt;exact_nei_tree_update</title>
<path fill="none" stroke="#000000" d="M165.28,-736.16C169.31,-794.93 189.55,-1048.88 242,-1104 249.36,-1111.74 258.69,-1117.3 268.69,-1121.26"/>
<polygon fill="#000000" stroke="#000000" points="267.85,-1124.68 278.45,-1124.6 270.12,-1118.05 267.85,-1124.68"/>
</g>
<!-- none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_node9" class="node">
<title>none~place_and_print_ghost_particles</title>
<polygon fill="#d9534f" stroke="#d9534f" points="436,-1062 253,-1062 253,-1038 436,-1038 436,-1062"/>
<text text-anchor="middle" x="344.5" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">place_and_print_ghost_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge8" class="edge">
<title>proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles</title>
<path fill="none" stroke="#000000" d="M165.88,-736.14C171.96,-787.61 198.07,-987 242,-1029 243.14,-1030.09 244.32,-1031.13 245.53,-1032.12"/>
<polygon fill="#000000" stroke="#000000" points="243.82,-1035.19 254.04,-1037.98 247.8,-1029.43 243.82,-1035.19"/>
</g>
<!-- density -->
<g id="interface~~perform_apm~~CallsGraph_node10" class="node">
<title>density</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-818 317.5,-818 317.5,-794 371.5,-794 371.5,-818"/>
<text text-anchor="middle" x="344.5" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density</text>
</g>
<!-- proc~perform_apm&#45;&gt;density -->
<g id="interface~~perform_apm~~CallsGraph_edge9" class="edge">
<title>proc~perform_apm&#45;&gt;density</title>
<path fill="none" stroke="#000000" d="M176.43,-736.37C190.69,-750.39 215.92,-772.87 242,-785 262.56,-794.57 287.48,-799.8 307.48,-802.65"/>
<polygon fill="#000000" stroke="#000000" points="307.08,-806.13 317.44,-803.94 307.97,-799.19 307.08,-806.13"/>
</g>
<!-- none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_node11" class="node">
<title>none~discard_atmosphere</title>
<polygon fill="#d9534f" stroke="#d9534f" points="405,-940 284,-940 284,-916 405,-916 405,-940"/>
<text text-anchor="middle" x="344.5" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">discard_atmosphere</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_edge10" class="edge">
<title>proc~perform_apm&#45;&gt;none~discard_atmosphere</title>
<path fill="none" stroke="#000000" d="M166.09,-736.1C171,-768.3 188.88,-856.76 242,-902 251.2,-909.83 262.45,-915.35 274.08,-919.23"/>
<polygon fill="#000000" stroke="#000000" points="273.31,-922.65 283.9,-922.11 275.29,-915.94 273.31,-922.65"/>
</g>
<!-- allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node12" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="409.5,-776 279.5,-776 279.5,-752 409.5,-752 409.5,-776"/>
<text text-anchor="middle" x="344.5" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge11" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M206.02,-733.28C227.89,-738.17 255.2,-744.27 279.7,-749.74"/>
<polygon fill="#000000" stroke="#000000" points="279.12,-753.2 289.64,-751.96 280.65,-746.37 279.12,-753.2"/>
</g>
<!-- none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_node13" class="node">
<title>none~get_nstar_id_atm</title>
<polygon fill="#d9534f" stroke="#d9534f" points="396,-696 293,-696 293,-672 396,-672 396,-696"/>
<text text-anchor="middle" x="344.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id_atm</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_edge12" class="edge">
<title>proc~perform_apm&#45;&gt;none~get_nstar_id_atm</title>
<path fill="none" stroke="#000000" d="M206.02,-714.72C228.9,-709.61 257.73,-703.17 283.07,-697.5"/>
<polygon fill="#000000" stroke="#000000" points="283.96,-700.89 292.95,-695.3 282.43,-694.06 283.96,-700.89"/>
</g>
<!-- deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node14" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="416,-654 273,-654 273,-630 416,-630 416,-654"/>
<text text-anchor="middle" x="344.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge13" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M176.43,-711.63C190.69,-697.61 215.92,-675.13 242,-663 248.62,-659.92 255.69,-657.29 262.9,-655.04"/>
<polygon fill="#000000" stroke="#000000" points="264.14,-658.33 272.79,-652.21 262.21,-651.6 264.14,-658.33"/>
</g>
<!-- assign_h -->
<g id="interface~~perform_apm~~CallsGraph_node15" class="node">
<title>assign_h</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-612 315.5,-612 315.5,-588 373.5,-588 373.5,-612"/>
<text text-anchor="middle" x="344.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">assign_h</text>
</g>
<!-- proc~perform_apm&#45;&gt;assign_h -->
<g id="interface~~perform_apm~~CallsGraph_edge14" class="edge">
<title>proc~perform_apm&#45;&gt;assign_h</title>
<path fill="none" stroke="#000000" d="M169.97,-711.88C180.53,-689.95 205.9,-643.88 242,-621 260.77,-609.11 285.04,-603.8 305.15,-601.49"/>
<polygon fill="#000000" stroke="#000000" points="305.6,-604.97 315.23,-600.54 304.95,-598 305.6,-604.97"/>
</g>
<!-- timer -->
<g id="interface~~perform_apm~~CallsGraph_node16" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-570 317.5,-570 317.5,-546 371.5,-546 371.5,-570"/>
<text text-anchor="middle" x="344.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~perform_apm&#45;&gt;timer -->
<g id="interface~~perform_apm~~CallsGraph_edge15" class="edge">
<title>proc~perform_apm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M167.23,-711.98C174.27,-683.85 195.82,-613.52 242,-579 260.62,-565.08 286.29,-559.86 307.16,-558.11"/>
<polygon fill="#000000" stroke="#000000" points="307.5,-561.59 317.26,-557.49 307.07,-554.61 307.5,-561.59"/>
</g>
<!-- deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node17" class="node">
<title>deallocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="433.5,-528 255.5,-528 255.5,-504 433.5,-504 433.5,-528"/>
<text text-anchor="middle" x="344.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge16" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M165.71,-711.66C169.71,-677.92 185.67,-583.58 242,-537 243.56,-535.71 245.18,-534.49 246.85,-533.34"/>
<polygon fill="#000000" stroke="#000000" points="248.77,-536.27 255.58,-528.16 245.2,-530.25 248.77,-536.27"/>
</g>
<!-- ncand -->
<g id="interface~~perform_apm~~CallsGraph_node18" class="node">
<title>ncand</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-486 317.5,-486 317.5,-462 371.5,-462 371.5,-486"/>
<text text-anchor="middle" x="344.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ncand</text>
</g>
<!-- proc~perform_apm&#45;&gt;ncand -->
<g id="interface~~perform_apm~~CallsGraph_edge17" class="edge">
<title>proc~perform_apm&#45;&gt;ncand</title>
<path fill="none" stroke="#000000" d="M164.66,-711.8C165.85,-673.43 175.04,-554.23 242,-495 259.72,-479.32 286.01,-474.21 307.4,-472.95"/>
<polygon fill="#000000" stroke="#000000" points="307.57,-476.44 317.44,-472.6 307.33,-469.45 307.57,-476.44"/>
</g>
<!-- proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_node19" class="node">
<title>proc~is_finite_number</title>
<g id="a_interface~~perform_apm~~CallsGraph_node19"><a xlink:href=".././proc/is_finite_number.html" xlink:title="is_finite_number">
<polygon fill="#d94e8f" stroke="#d94e8f" points="635.5,-736 535.5,-736 535.5,-712 635.5,-712 635.5,-736"/>
<text text-anchor="middle" x="585.5" y="-721.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_finite_number</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge18" class="edge">
<title>proc~perform_apm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M206.31,-724C281.37,-724 439.19,-724 525.33,-724"/>
<polygon fill="#000000" stroke="#000000" points="525.47,-727.5 535.47,-724 525.47,-720.5 525.47,-727.5"/>
</g>
<!-- allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node20" class="node">
<title>allocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="427,-444 262,-444 262,-420 427,-420 427,-444"/>
<text text-anchor="middle" x="344.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge19" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M163.92,-711.78C162.61,-669.06 164.35,-525.07 242,-453 245.36,-449.89 249.05,-447.18 252.97,-444.84"/>
<polygon fill="#000000" stroke="#000000" points="254.6,-447.94 261.9,-440.27 251.41,-441.71 254.6,-447.94"/>
</g>
<!-- none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_node21" class="node">
<title>none~reallocate_output_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="414,-860 275,-860 275,-836 414,-836 414,-860"/>
<text text-anchor="middle" x="344.5" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reallocate_output_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge20" class="edge">
<title>proc~perform_apm&#45;&gt;none~reallocate_output_fields</title>
<path fill="none" stroke="#000000" d="M169.97,-736.12C180.53,-758.05 205.9,-804.12 242,-827 249.1,-831.5 256.99,-835.06 265.14,-837.87"/>
<polygon fill="#000000" stroke="#000000" points="264.22,-841.24 274.81,-840.83 266.27,-834.55 264.22,-841.24"/>
</g>
<!-- density_loop -->
<g id="interface~~perform_apm~~CallsGraph_node22" class="node">
<title>density_loop</title>
<polygon fill="#777777" stroke="#777777" points="384,-402 305,-402 305,-378 384,-378 384,-402"/>
<text text-anchor="middle" x="344.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density_loop</text>
</g>
<!-- proc~perform_apm&#45;&gt;density_loop -->
<g id="interface~~perform_apm~~CallsGraph_edge21" class="edge">
<title>proc~perform_apm&#45;&gt;density_loop</title>
<path fill="none" stroke="#000000" d="M165.79,-711.89C171.6,-659.66 197.02,-454.27 242,-411 255.9,-397.63 275.94,-391.78 294.56,-389.48"/>
<polygon fill="#000000" stroke="#000000" points="295.06,-392.95 304.7,-388.55 294.42,-385.98 295.06,-392.95"/>
</g>
<!-- allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node23" class="node">
<title>allocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="397.5,-360 291.5,-360 291.5,-336 397.5,-336 397.5,-360"/>
<text text-anchor="middle" x="344.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge22" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_gradient</title>
<path fill="none" stroke="#000000" d="M165.41,-711.84C169.91,-655.32 191.54,-418.91 242,-369 252.55,-358.56 266.84,-352.67 281.36,-349.48"/>
<polygon fill="#000000" stroke="#000000" points="282.18,-352.89 291.4,-347.68 280.94,-346 282.18,-352.89"/>
</g>
<!-- h -->
<g id="interface~~perform_apm~~CallsGraph_node24" class="node">
<title>h</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-940 558.5,-940 558.5,-916 612.5,-916 612.5,-940"/>
<text text-anchor="middle" x="585.5" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~perform_apm&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge23" class="edge">
<title>proc~perform_apm&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M164.26,-736.04C164.22,-774.93 170.02,-897.66 242,-949 290.33,-983.47 471,-951.54 548.65,-935.71"/>
<polygon fill="#000000" stroke="#000000" points="549.38,-939.13 558.47,-933.68 547.97,-932.27 549.38,-939.13"/>
</g>
<!-- interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node25" class="node">
<title>interface~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node25"><a xlink:href=".././interface/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#a7506f" stroke="#a7506f" points="413.5,-1310 275.5,-1310 275.5,-1286 413.5,-1286 413.5,-1310"/>
<text text-anchor="middle" x="344.5" y="-1295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge24" class="edge">
<title>proc~perform_apm&#45;&gt;interface~correct_center_of_mass</title>
<path fill="none" stroke="#000000" d="M164.38,-736.45C163.94,-810.78 165.43,-1195.3 242,-1277 248.58,-1284.02 256.83,-1289.02 265.77,-1292.54"/>
<polygon fill="#000000" stroke="#000000" points="264.71,-1295.88 275.3,-1295.7 266.91,-1289.23 264.71,-1295.88"/>
</g>
<!-- deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node26" class="node">
<title>deallocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="438,-318 251,-318 251,-294 438,-294 438,-318"/>
<text text-anchor="middle" x="344.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge25" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M165.12,-711.65C168.44,-650.81 186.08,-383.55 242,-327 242.96,-326.03 243.95,-325.1 244.98,-324.2"/>
<polygon fill="#000000" stroke="#000000" points="247.36,-326.79 253.35,-318.06 243.22,-321.15 247.36,-326.79"/>
</g>
<!-- interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node27" class="node">
<title>interface~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node27"><a xlink:href=".././interface/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#a7506f" stroke="#a7506f" points="415.5,-276 273.5,-276 273.5,-252 415.5,-252 415.5,-276"/>
<text text-anchor="middle" x="344.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge26" class="edge">
<title>proc~perform_apm&#45;&gt;interface~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M164.87,-711.67C167.08,-647.07 180.53,-348.29 242,-285 248.19,-278.62 255.78,-273.92 263.98,-270.49"/>
<polygon fill="#000000" stroke="#000000" points="265.21,-273.77 273.47,-267.14 262.88,-267.17 265.21,-273.77"/>
</g>
<!-- deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node28" class="node">
<title>deallocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="404,-234 285,-234 285,-210 404,-210 404,-234"/>
<text text-anchor="middle" x="344.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge27" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_gradient</title>
<path fill="none" stroke="#000000" d="M164.66,-711.86C165.82,-644.09 174.9,-313.13 242,-243 250.83,-233.77 262.58,-228.04 274.94,-224.58"/>
<polygon fill="#000000" stroke="#000000" points="275.98,-227.94 284.94,-222.28 274.41,-221.11 275.98,-227.94"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node29" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node29"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="447,-1268 242,-1268 242,-1244 447,-1244 447,-1268"/>
<text text-anchor="middle" x="344.5" y="-1253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge28" class="edge">
<title>proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M164.54,-736.42C165.02,-807.31 171.01,-1160.11 242,-1235 242.8,-1235.85 243.63,-1236.67 244.49,-1237.46"/>
<polygon fill="#000000" stroke="#000000" points="242.67,-1240.48 252.72,-1243.83 246.95,-1234.94 242.67,-1240.48"/>
</g>
<!-- nic -->
<g id="interface~~perform_apm~~CallsGraph_node30" class="node">
<title>nic</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-192 317.5,-192 317.5,-168 371.5,-168 371.5,-192"/>
<text text-anchor="middle" x="344.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nic</text>
</g>
<!-- proc~perform_apm&#45;&gt;nic -->
<g id="interface~~perform_apm~~CallsGraph_edge29" class="edge">
<title>proc~perform_apm&#45;&gt;nic</title>
<path fill="none" stroke="#000000" d="M164.49,-711.76C164.7,-640.32 169.35,-277.9 242,-201 258.35,-183.69 284.93,-178.66 306.78,-177.85"/>
<polygon fill="#000000" stroke="#000000" points="307.1,-181.35 317.06,-177.75 307.03,-174.35 307.1,-181.35"/>
</g>
<!-- nu -->
<g id="interface~~perform_apm~~CallsGraph_node31" class="node">
<title>nu</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-898 558.5,-898 558.5,-874 612.5,-874 612.5,-898"/>
<text text-anchor="middle" x="585.5" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu</text>
</g>
<!-- proc~perform_apm&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge30" class="edge">
<title>proc~perform_apm&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M166.8,-736.08C173,-764.98 193.05,-837.99 242,-869 291.95,-900.65 470.62,-893.42 548.16,-888.59"/>
<polygon fill="#000000" stroke="#000000" points="548.65,-892.06 558.41,-887.93 548.2,-885.08 548.65,-892.06"/>
</g>
<!-- allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node32" class="node">
<title>allocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="431,-150 258,-150 258,-126 431,-126 431,-150"/>
<text text-anchor="middle" x="344.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge31" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M164.34,-711.77C163.65,-637.06 163.75,-242.73 242,-159 244.13,-156.72 246.44,-154.65 248.89,-152.78"/>
<polygon fill="#000000" stroke="#000000" points="251.19,-155.46 257.73,-147.13 247.42,-149.57 251.19,-155.46"/>
</g>
<!-- proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_node33" class="node">
<title>proc~spherical_from_cartesian</title>
<g id="a_interface~~perform_apm~~CallsGraph_node33"><a xlink:href=".././proc/spherical_from_cartesian.html" xlink:title="spherical_from_cartesian">
<polygon fill="#d9534f" stroke="#d9534f" points="658.5,-1150 512.5,-1150 512.5,-1126 658.5,-1126 658.5,-1150"/>
<text text-anchor="middle" x="585.5" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spherical_from_cartesian</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge32" class="edge">
<title>proc~perform_apm&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M165.47,-736.28C170.12,-792.31 192.12,-1022.91 242,-1071 308.71,-1135.32 356.2,-1090.5 447,-1109 463.06,-1112.27 466.97,-1113.56 483,-1117 493.57,-1119.27 504.78,-1121.63 515.73,-1123.91"/>
<polygon fill="#000000" stroke="#000000" points="515.2,-1127.38 525.7,-1125.99 516.62,-1120.52 515.2,-1127.38"/>
</g>
<!-- proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_node34" class="node">
<title>proc~find_h_backup</title>
<g id="a_interface~~perform_apm~~CallsGraph_node34"><a xlink:href=".././proc/find_h_backup.html" xlink:title="find_h_backup">
<polygon fill="#d94e8f" stroke="#d94e8f" points="389,-108 300,-108 300,-84 389,-84 389,-108"/>
<text text-anchor="middle" x="344.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_h_backup</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_edge33" class="edge">
<title>proc~perform_apm&#45;&gt;proc~find_h_backup</title>
<path fill="none" stroke="#000000" d="M164.22,-711.89C162.67,-634.31 158.1,-207.63 242,-117 254.16,-103.86 272.2,-97.77 289.71,-95.22"/>
<polygon fill="#000000" stroke="#000000" points="290.34,-98.67 299.91,-94.1 289.58,-91.71 290.34,-98.67"/>
</g>
<!-- iorig -->
<g id="interface~~perform_apm~~CallsGraph_node35" class="node">
<title>iorig</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-66 317.5,-66 317.5,-42 371.5,-42 371.5,-66"/>
<text text-anchor="middle" x="344.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iorig</text>
</g>
<!-- proc~perform_apm&#45;&gt;iorig -->
<g id="interface~~perform_apm~~CallsGraph_edge34" class="edge">
<title>proc~perform_apm&#45;&gt;iorig</title>
<path fill="none" stroke="#000000" d="M165.11,-711.8C169.47,-626.72 197.05,-123.95 242,-75 258.29,-57.26 285.28,-52.33 307.33,-51.66"/>
<polygon fill="#000000" stroke="#000000" points="307.39,-55.16 317.38,-51.63 307.37,-48.16 307.39,-55.16"/>
</g>
<!-- none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_node36" class="node">
<title>none~dump_apm_pos</title>
<polygon fill="#d9534f" stroke="#d9534f" points="393,-1020 296,-1020 296,-996 393,-996 393,-1020"/>
<text text-anchor="middle" x="344.5" y="-1005.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dump_apm_pos</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_edge35" class="edge">
<title>proc~perform_apm&#45;&gt;none~dump_apm_pos</title>
<path fill="none" stroke="#000000" d="M164.25,-736.09C164.07,-777.09 169.29,-912.21 242,-982 253.9,-993.42 270.11,-1000.01 286.07,-1003.77"/>
<polygon fill="#000000" stroke="#000000" points="285.45,-1007.21 295.94,-1005.75 286.83,-1000.35 285.45,-1007.21"/>
</g>
<!-- rpart -->
<g id="interface~~perform_apm~~CallsGraph_node37" class="node">
<title>rpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-24 317.5,-24 317.5,0 371.5,0 371.5,-24"/>
<text text-anchor="middle" x="344.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;rpart -->
<g id="interface~~perform_apm~~CallsGraph_edge36" class="edge">
<title>proc~perform_apm&#45;&gt;rpart</title>
<path fill="none" stroke="#000000" d="M165.01,-711.87C168.85,-623.88 194.22,-85.41 242,-33 258.22,-15.21 285.22,-10.28 307.29,-9.62"/>
<polygon fill="#000000" stroke="#000000" points="307.35,-13.12 317.34,-9.6 307.34,-6.12 307.35,-13.12"/>
</g>
<!-- validate_position -->
<g id="interface~~perform_apm~~CallsGraph_node47" class="node">
<title>validate_position</title>
<polygon fill="#777777" stroke="#777777" points="637,-1390 534,-1390 534,-1366 637,-1366 637,-1390"/>
<text text-anchor="middle" x="585.5" y="-1375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position</text>
</g>
<!-- none~validate_position_final&#45;&gt;validate_position -->
<g id="interface~~perform_apm~~CallsGraph_edge37" class="edge">
<title>none~validate_position_final&#45;&gt;validate_position</title>
<path fill="none" stroke="#000000" d="M410.18,-1378C445.53,-1378 489.06,-1378 523.78,-1378"/>
<polygon fill="#000000" stroke="#000000" points="523.79,-1381.5 533.79,-1378 523.79,-1374.5 523.79,-1381.5"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge38" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M415.73,-1062.08C426.65,-1065.61 437.47,-1070.15 447,-1076 467.67,-1088.69 462.04,-1104.8 483,-1117 489.2,-1120.61 495.93,-1123.6 502.88,-1126.09"/>
<polygon fill="#000000" stroke="#000000" points="501.87,-1129.44 512.46,-1129.17 504.01,-1122.77 501.87,-1129.44"/>
</g>
<!-- sizes -->
<g id="interface~~perform_apm~~CallsGraph_node38" class="node">
<title>sizes</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1108 558.5,-1108 558.5,-1084 612.5,-1084 612.5,-1108"/>
<text text-anchor="middle" x="585.5" y="-1093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sizes</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;sizes -->
<g id="interface~~perform_apm~~CallsGraph_edge39" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;sizes</title>
<path fill="none" stroke="#000000" d="M407.98,-1062.03C452.74,-1070.64 511.42,-1081.94 548.56,-1089.08"/>
<polygon fill="#000000" stroke="#000000" points="547.95,-1092.53 558.43,-1090.98 549.27,-1085.66 547.95,-1092.53"/>
</g>
<!-- center -->
<g id="interface~~perform_apm~~CallsGraph_node39" class="node">
<title>center</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1066 558.5,-1066 558.5,-1042 612.5,-1042 612.5,-1066"/>
<text text-anchor="middle" x="585.5" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">center</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;center -->
<g id="interface~~perform_apm~~CallsGraph_edge40" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;center</title>
<path fill="none" stroke="#000000" d="M436.2,-1051.52C475.13,-1052.17 518.39,-1052.89 548.09,-1053.39"/>
<polygon fill="#000000" stroke="#000000" points="548.33,-1056.9 558.39,-1053.56 548.45,-1049.9 548.33,-1056.9"/>
</g>
<!-- get_density -->
<g id="interface~~perform_apm~~CallsGraph_node41" class="node">
<title>get_density</title>
<polygon fill="#777777" stroke="#777777" points="622,-1024 549,-1024 549,-1000 622,-1000 622,-1024"/>
<text text-anchor="middle" x="585.5" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_density</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge41" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M421.12,-1037.98C459.79,-1031.83 505.58,-1024.55 538.82,-1019.26"/>
<polygon fill="#000000" stroke="#000000" points="539.39,-1022.72 548.72,-1017.69 538.29,-1015.8 539.39,-1022.72"/>
</g>
<!-- pos_input -->
<g id="interface~~perform_apm~~CallsGraph_node45" class="node">
<title>pos_input</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-982 553.5,-982 553.5,-958 617.5,-958 617.5,-982"/>
<text text-anchor="middle" x="585.5" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pos_input</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge42" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M426.65,-1037.95C433.74,-1035.5 440.63,-1032.55 447,-1029 467.32,-1017.68 462.68,-1002.32 483,-991 501.26,-980.83 523.84,-975.57 543.06,-972.85"/>
<polygon fill="#000000" stroke="#000000" points="543.56,-976.31 553.05,-971.62 542.7,-969.37 543.56,-976.31"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge45" class="edge">
<title>none~discard_atmosphere&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M405.19,-928C450.18,-928 510.41,-928 548.34,-928"/>
<polygon fill="#000000" stroke="#000000" points="548.41,-931.5 558.41,-928 548.41,-924.5 548.41,-931.5"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge43" class="edge">
<title>none~discard_atmosphere&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M405.19,-917.51C450.18,-909.6 510.41,-899.02 548.34,-892.35"/>
<polygon fill="#000000" stroke="#000000" points="549.17,-895.76 558.41,-890.58 547.96,-888.87 549.17,-895.76"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge44" class="edge">
<title>none~discard_atmosphere&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M367.74,-940.09C394.42,-954.15 440.83,-977.17 483,-991 500.87,-996.86 521.06,-1001.43 538.7,-1004.8"/>
<polygon fill="#000000" stroke="#000000" points="538.29,-1008.28 548.76,-1006.64 539.55,-1001.39 538.29,-1008.28"/>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge47" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M396.19,-692.48C433.88,-698.79 485.42,-707.42 525.05,-714.05"/>
<polygon fill="#000000" stroke="#000000" points="524.67,-717.54 535.11,-715.73 525.83,-710.63 524.67,-717.54"/>
</g>
<!-- get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_node43" class="node">
<title>get_nstar_id</title>
<polygon fill="#777777" stroke="#777777" points="624,-694 547,-694 547,-670 624,-670 624,-694"/>
<text text-anchor="middle" x="585.5" y="-679.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id</text>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_edge46" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;get_nstar_id</title>
<path fill="none" stroke="#000000" d="M396.19,-683.58C437.66,-683.23 495.9,-682.74 536.6,-682.4"/>
<polygon fill="#000000" stroke="#000000" points="536.83,-685.9 546.8,-682.32 536.77,-678.9 536.83,-685.9"/>
</g>
<!-- h_output -->
<g id="interface~~perform_apm~~CallsGraph_node42" class="node">
<title>h_output</title>
<polygon fill="#777777" stroke="#777777" points="615,-856 556,-856 556,-832 615,-832 615,-856"/>
<text text-anchor="middle" x="585.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;h_output -->
<g id="interface~~perform_apm~~CallsGraph_edge50" class="edge">
<title>none~reallocate_output_fields&#45;&gt;h_output</title>
<path fill="none" stroke="#000000" d="M414.31,-846.85C456.92,-846.14 510.1,-845.25 545.56,-844.65"/>
<polygon fill="#000000" stroke="#000000" points="546.02,-848.14 555.96,-844.48 545.91,-841.15 546.02,-848.14"/>
</g>
<!-- nu_output -->
<g id="interface~~perform_apm~~CallsGraph_node44" class="node">
<title>nu_output</title>
<polygon fill="#777777" stroke="#777777" points="618.5,-814 552.5,-814 552.5,-790 618.5,-790 618.5,-814"/>
<text text-anchor="middle" x="585.5" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;nu_output -->
<g id="interface~~perform_apm~~CallsGraph_edge48" class="edge">
<title>none~reallocate_output_fields&#45;&gt;nu_output</title>
<path fill="none" stroke="#000000" d="M407.98,-835.97C450.33,-827.82 505.16,-817.27 542.4,-810.1"/>
<polygon fill="#000000" stroke="#000000" points="543.25,-813.5 552.41,-808.18 541.93,-806.63 543.25,-813.5"/>
</g>
<!-- none~reallocate_output_fields&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge49" class="edge">
<title>none~reallocate_output_fields&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M371.64,-860.12C393.11,-870.77 423.66,-887.57 447,-907 465.89,-922.73 461.83,-936.51 483,-949 501.13,-959.7 523.88,-965 543.25,-967.61"/>
<polygon fill="#000000" stroke="#000000" points="542.98,-971.1 553.32,-968.77 543.78,-964.15 542.98,-971.1"/>
</g>
<!-- proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node46" class="node">
<title>proc~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node46"><a xlink:href=".././proc/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#d9534f" stroke="#d9534f" points="654.5,-1310 516.5,-1310 516.5,-1286 654.5,-1286 654.5,-1310"/>
<text text-anchor="middle" x="585.5" y="-1295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge51" class="edge">
<title>interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.67,-1298C442.42,-1298 476.08,-1298 505.88,-1298"/>
<polygon fill="#000000" stroke="#000000" points="506.24,-1301.5 516.24,-1298 506.24,-1294.5 506.24,-1301.5"/>
</g>
<!-- proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node40" class="node">
<title>proc~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node40"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="656.5,-276 514.5,-276 514.5,-252 656.5,-252 656.5,-276"/>
<text text-anchor="middle" x="585.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- interface~check_particle_positions&#45;&gt;proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge52" class="edge">
<title>interface~check_particle_positions&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M415.59,-264C443.44,-264 475.63,-264 504.39,-264"/>
<polygon fill="#000000" stroke="#000000" points="504.41,-267.5 514.41,-264 504.41,-260.5 504.41,-267.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node48" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node48"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="688,-1268 483,-1268 483,-1244 688,-1244 688,-1268"/>
<text text-anchor="middle" x="585.5" y="-1253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge53" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.2,-1256C455.7,-1256 464.31,-1256 472.87,-1256"/>
<polygon fill="#000000" stroke="#000000" points="472.89,-1259.5 482.89,-1256 472.89,-1252.5 472.89,-1259.5"/>
</g>
<!-- none~dump_apm_pos&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge54" class="edge">
<title>none~dump_apm_pos&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M393,-1008.8C435.3,-1009.5 496.77,-1010.53 538.58,-1011.23"/>
<polygon fill="#000000" stroke="#000000" points="538.7,-1014.73 548.76,-1011.4 538.82,-1007.73 538.7,-1014.73"/>
</g>
<!-- indexx -->
<g id="interface~~perform_apm~~CallsGraph_node51" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-276 784.5,-276 784.5,-252 838.5,-252 838.5,-276"/>
<text text-anchor="middle" x="811.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="interface~~perform_apm~~CallsGraph_edge55" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M656.76,-264C695.72,-264 742.55,-264 774.21,-264"/>
<polygon fill="#000000" stroke="#000000" points="774.33,-267.5 784.33,-264 774.33,-260.5 774.33,-267.5"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge56" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M654.62,-1298C693.94,-1298 741.83,-1298 774.06,-1298"/>
<polygon fill="#000000" stroke="#000000" points="774.36,-1301.5 784.36,-1298 774.36,-1294.5 774.36,-1301.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge58" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M650.69,-1268.04C690.7,-1275.54 740.74,-1284.92 774.06,-1291.17"/>
<polygon fill="#000000" stroke="#000000" points="773.78,-1294.68 784.25,-1293.08 775.07,-1287.8 773.78,-1294.68"/>
</g>
<!-- interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node49" class="node">
<title>interface~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node49"><a xlink:href=".././interface/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="899,-1268 724,-1268 724,-1244 899,-1244 899,-1268"/>
<text text-anchor="middle" x="811.5" y="-1253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge59" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" d="M688.01,-1256C696.49,-1256 705.05,-1256 713.49,-1256"/>
<polygon fill="#000000" stroke="#000000" points="713.72,-1259.5 723.72,-1256 713.72,-1252.5 713.72,-1259.5"/>
</g>
<!-- interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node50" class="node">
<title>interface~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node50"><a xlink:href=".././interface/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="886.5,-1226 736.5,-1226 736.5,-1202 886.5,-1202 886.5,-1226"/>
<text text-anchor="middle" x="811.5" y="-1211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge57" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" d="M650.69,-1243.96C677.4,-1238.96 708.58,-1233.11 736.27,-1227.92"/>
<polygon fill="#000000" stroke="#000000" points="737.12,-1231.32 746.3,-1226.04 735.83,-1224.44 737.12,-1231.32"/>
</g>
<!-- proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node53" class="node">
<title>proc~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node53"><a xlink:href=".././proc/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1110,-1268 935,-1268 935,-1244 1110,-1244 1110,-1268"/>
<text text-anchor="middle" x="1022.5" y="-1253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge60" class="edge">
<title>interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M899.02,-1256C907.49,-1256 916.13,-1256 924.7,-1256"/>
<polygon fill="#000000" stroke="#000000" points="924.71,-1259.5 934.71,-1256 924.71,-1252.5 924.71,-1259.5"/>
</g>
<!-- proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node52" class="node">
<title>proc~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node52"><a xlink:href=".././proc/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1097.5,-1226 947.5,-1226 947.5,-1202 1097.5,-1202 1097.5,-1226"/>
<text text-anchor="middle" x="1022.5" y="-1211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge61" class="edge">
<title>interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M886.77,-1214C903.1,-1214 920.5,-1214 937.18,-1214"/>
<polygon fill="#000000" stroke="#000000" points="937.47,-1217.5 947.47,-1214 937.47,-1210.5 937.47,-1217.5"/>
</g>
</g>
</svg>
</div><script>var paninterfaceperform_apmCallsGraph = svgPanZoom('#interfaceperform_apmCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>
      <h2>public module module subroutine perform_apm(get_density, get_nstar_id, npart_output, pos_input, pvol, h_output, nu_output, center, com_star, mass, sizes, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, ghost_dist, use_atmosphere, remove_atmosphere, print_step, namefile_pos_id, namefile_pos, namefile_results, validate_position)   <a href='../proc/perform_apm.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
</h2>

    

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td colspan="7">
      <small><h5>function get_density(x, y, z) result(density)</h5><p>Returns the baryon mass density at the desired point</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>double precision</small></h6>  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
</small>
  </td> 
</tr>
<tr>
  <td colspan="7">
      <small><h5>subroutine get_nstar_id(npart, x, y, z, nstar_id)</h5><p>Computes the proper baryon number density at the particle positions</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong>(npart)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong>(npart)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(npart)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_id</strong>(npart)</td><td><p>Array to store the computed proper baryon number density</p>
<p>Array to store the computed proper baryon number density seen
 by the Eulerian observer</p></td>
</tr>
</tbody>
</table>

</small>
  </td> 
</tr>
<tr>
  <td><span class="anchor" id="variable-npart_output"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_output</strong></td><td><p>Initial particle number</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos_input"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pvol~2"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nu_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-center~3"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-com_star~3"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass~3"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sizes~2"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(6)</td><td>::</td>
  <td><strong>sizes</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-apm_max_it"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max_inc"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass_it"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-correct_nu~2"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_thres"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_des"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nx_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ny_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nz_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ghost_dist"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ghost_dist</strong></td><td><p>Distance between the ghost particles and the surface
 of the matter object considered (star, ejecta, etc...)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-use_atmosphere~2"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_atmosphere</strong></td><td><p>If .TRUE., allows particles to move where the density
 is 0, and displace them using only the smoothing term.
 This can be useful when the system has an irregular
 geometry, as, for example, an ejecta; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-remove_atmosphere"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>remove_atmosphere</strong></td><td><p>If .TRUE., removes the particles placed where the density is 0,
 at the end of the APM iteration; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-print_step"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>print_step</strong></td><td><p>Prints the particle positions to a formatted file every
 print_step steps</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos_id"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions
 and the ghost positions will be printed</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions
 and the ghost positions will be printed every 15 iterations</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_results"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related
 to the particle distribution, the baryon number particle and the
 kernel estimate of the density will be printed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-validate_position"></span>procedure(validate_position_int),</td>
<td></td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
</tr>
</tbody>
</table>

    <h3>Description</h3>
    <p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
    <br>

 </div>
</div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-04-20 10:40:32           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>