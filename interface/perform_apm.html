
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Image caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state DD2-SF RDF 1.8 from the CompOSE database. The solution was computed with \texttt{LORENE}, and the particles placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>perform_apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>More</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>perform_apm
   <small>Interface</small>
    
    </h1>
    
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a></li> 
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">142 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/module_particles_id.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/module_particles_id.f90.html'>module_particles_id.f90</a></li>
    
     <li><a href='../module/particles_id.html'>particles_id</a></li>
    
  
     <li class="active">perform_apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

    
  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<em>None</em>


</div>

    </div>
    
    <div class="col-md-9" id='text'>
    
    
      <h2>interface</h2>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: interface~~perform_apm~~CallsGraph Pages: 1 -->
<svg id="interfaceperform_apmCallsGraph" width="641pt" height="796pt"
 viewBox="0.00 0.00 641.00 795.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="interface~~perform_apm~~CallsGraph" class="graph" transform="scale(.8781 .8781) rotate(0) translate(4 902)">
<title>interface~~perform_apm~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-902 726,-902 726,4 -4,4"/>
<!-- interface~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node1" class="node">
<title>interface~perform_apm</title>
<polygon fill="none" stroke="#000000" points="77,-461 0,-461 0,-437 77,-437 77,-461"/>
<text text-anchor="middle" x="38.5" y="-446.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">perform_apm</text>
</g>
<!-- proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node2" class="node">
<title>proc~perform_apm</title>
<g id="a_interface~~perform_apm~~CallsGraph_node2"><a xlink:href=".././proc/perform_apm.html" xlink:title="perform_apm">
<polygon fill="#d9534f" stroke="#d9534f" points="190,-461 113,-461 113,-437 190,-437 190,-461"/>
<text text-anchor="middle" x="151.5" y="-446.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">perform_apm</text>
</a>
</g>
</g>
<!-- interface~perform_apm&#45;&gt;proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_edge1" class="edge">
<title>interface~perform_apm&#45;&gt;proc~perform_apm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M77.0721,-449C85.2539,-449 93.9953,-449 102.5054,-449"/>
<polygon fill="#000000" stroke="#000000" points="102.7181,-452.5001 112.718,-449 102.718,-445.5001 102.7181,-452.5001"/>
</g>
<!-- position_correction -->
<g id="interface~~perform_apm~~CallsGraph_node3" class="node">
<title>position_correction</title>
<polygon fill="#777777" stroke="#777777" points="370,-898 267,-898 267,-874 370,-874 370,-898"/>
<text text-anchor="middle" x="318.5" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">position_correction</text>
</g>
<!-- proc~perform_apm&#45;&gt;position_correction -->
<g id="interface~~perform_apm~~CallsGraph_edge2" class="edge">
<title>proc~perform_apm&#45;&gt;position_correction</title>
<path fill="none" stroke="#000000" d="M151.9213,-461.0755C154.3304,-523.0301 168.3589,-804.6424 226,-865 234.2634,-873.6529 245.2872,-879.0857 256.8388,-882.4293"/>
<polygon fill="#000000" stroke="#000000" points="256.0772,-885.8457 266.6174,-884.7713 257.7077,-879.0383 256.0772,-885.8457"/>
</g>
<!-- deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node4" class="node">
<title>deallocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="403.5,-856 233.5,-856 233.5,-832 403.5,-832 403.5,-856"/>
<text text-anchor="middle" x="318.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">deallocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge3" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M152.2029,-461.3838C155.7856,-520.0648 173.9234,-769.5184 226,-823 226.937,-823.9623 227.9082,-824.8846 228.9105,-825.7685"/>
<polygon fill="#000000" stroke="#000000" points="227.0186,-828.7215 237.1508,-831.8181 231.1612,-823.0788 227.0186,-828.7215"/>
</g>
<!-- deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node5" class="node">
<title>deallocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="398.5,-814 238.5,-814 238.5,-790 398.5,-790 398.5,-814"/>
<text text-anchor="middle" x="318.5" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">deallocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge4" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M152.511,-461.0699C157.2799,-515.1022 179.2757,-734.1587 226,-781 227.1266,-782.1295 228.3005,-783.2035 229.5163,-784.2247"/>
<polygon fill="#000000" stroke="#000000" points="227.895,-787.3618 238.0956,-790.2251 231.9069,-781.6256 227.895,-787.3618"/>
</g>
<!-- h -->
<g id="interface~~perform_apm~~CallsGraph_node6" class="node">
<title>h</title>
<polygon fill="#777777" stroke="#777777" points="345.5,-772 291.5,-772 291.5,-748 345.5,-748 345.5,-772"/>
<text text-anchor="middle" x="318.5" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">h</text>
</g>
<!-- proc~perform_apm&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge5" class="edge">
<title>proc~perform_apm&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M152.9454,-461.1947C159.1012,-511.0809 184.7215,-698.8701 226,-739 240.5454,-753.1407 262.5111,-758.535 281.3877,-760.3261"/>
<polygon fill="#000000" stroke="#000000" points="281.284,-763.8267 291.4901,-760.9831 281.7384,-756.8414 281.284,-763.8267"/>
</g>
<!-- deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node7" class="node">
<title>deallocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-730 265.5,-730 265.5,-706 371.5,-706 371.5,-730"/>
<text text-anchor="middle" x="318.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">deallocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge6" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_gradient</title>
<path fill="none" stroke="#000000" d="M153.5165,-461.2478C161.2101,-506.5149 190.1003,-663.4817 226,-697 234.2856,-704.736 244.8034,-709.8301 255.7537,-713.1437"/>
<polygon fill="#000000" stroke="#000000" points="254.8877,-716.5348 265.4429,-715.6189 256.6204,-709.7526 254.8877,-716.5348"/>
</g>
<!-- assign_h -->
<g id="interface~~perform_apm~~CallsGraph_node8" class="node">
<title>assign_h</title>
<polygon fill="#777777" stroke="#777777" points="346,-688 291,-688 291,-664 346,-664 346,-688"/>
<text text-anchor="middle" x="318.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">assign_h</text>
</g>
<!-- proc~perform_apm&#45;&gt;assign_h -->
<g id="interface~~perform_apm~~CallsGraph_edge7" class="edge">
<title>proc~perform_apm&#45;&gt;assign_h</title>
<path fill="none" stroke="#000000" d="M152.0376,-461.1866C154.3009,-496.88 166,-602.002 226,-655 240.8228,-668.093 262.0957,-673.5231 280.5046,-675.5985"/>
<polygon fill="#000000" stroke="#000000" points="280.4017,-679.1021 290.6591,-676.4498 280.9865,-672.1266 280.4017,-679.1021"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node9" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node9"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="411,-646 226,-646 226,-622 411,-622 411,-646"/>
<text text-anchor="middle" x="318.5" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge8" class="edge">
<title>proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M153.6019,-461.0374C159.4231,-490.6942 178.5695,-567.7802 226,-608 230.294,-611.6412 235.0635,-614.7742 240.1085,-617.4697"/>
<polygon fill="#000000" stroke="#000000" points="238.9055,-620.7718 249.4438,-621.8645 241.887,-614.4385 238.9055,-620.7718"/>
</g>
<!-- com -->
<g id="interface~~perform_apm~~CallsGraph_node10" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="722,-606 668,-606 668,-582 722,-582 722,-606"/>
<text text-anchor="middle" x="695" y="-591.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">com</text>
</g>
<!-- proc~perform_apm&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge9" class="edge">
<title>proc~perform_apm&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M154.4792,-461.0997C161.6512,-487.3105 182.5897,-549.0579 226,-575 298.3853,-618.2577 560.2551,-603.9912 657.9296,-596.9377"/>
<polygon fill="#000000" stroke="#000000" points="658.2206,-600.4259 667.9355,-596.1986 657.7048,-593.4449 658.2206,-600.4259"/>
</g>
<!-- deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node11" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="383.5,-566 253.5,-566 253.5,-542 383.5,-542 383.5,-566"/>
<text text-anchor="middle" x="318.5" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">deallocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge10" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M158.7296,-461.1648C170.4214,-479.7168 195.2993,-514.8361 226,-533 231.4876,-536.2467 237.4311,-538.9917 243.5673,-541.3124"/>
<polygon fill="#000000" stroke="#000000" points="242.736,-544.7262 253.3304,-544.6213 244.983,-538.0966 242.736,-544.7262"/>
</g>
<!-- none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_node12" class="node">
<title>none~validate_position_final</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="377.5,-524 259.5,-524 259.5,-500 377.5,-500 377.5,-524"/>
<text text-anchor="middle" x="318.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">validate_position_final</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_edge11" class="edge">
<title>proc~perform_apm&#45;&gt;none~validate_position_final</title>
<path fill="none" stroke="#000000" d="M169.4423,-461.0848C184.0952,-470.4599 205.6373,-483.142 226,-491 233.4272,-493.8662 241.348,-496.3988 249.3111,-498.6215"/>
<polygon fill="#000000" stroke="#000000" points="248.4529,-502.0148 259.0149,-501.1807 250.238,-495.2462 248.4529,-502.0148"/>
</g>
<!-- iorig -->
<g id="interface~~perform_apm~~CallsGraph_node13" class="node">
<title>iorig</title>
<polygon fill="#777777" stroke="#777777" points="345.5,-482 291.5,-482 291.5,-458 345.5,-458 345.5,-482"/>
<text text-anchor="middle" x="318.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iorig</text>
</g>
<!-- proc~perform_apm&#45;&gt;iorig -->
<g id="interface~~perform_apm~~CallsGraph_edge12" class="edge">
<title>proc~perform_apm&#45;&gt;iorig</title>
<path fill="none" stroke="#000000" d="M190.2329,-453.8706C217.6232,-457.3149 254.1378,-461.9065 281.2018,-465.3098"/>
<polygon fill="#000000" stroke="#000000" points="281.0779,-468.8217 291.4365,-466.5968 281.9513,-461.8764 281.0779,-468.8217"/>
</g>
<!-- allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node14" class="node">
<title>allocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="392.5,-440 244.5,-440 244.5,-416 392.5,-416 392.5,-440"/>
<text text-anchor="middle" x="318.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">allocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge14" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M190.2329,-444.1294C203.4327,-442.4695 218.7516,-440.5432 234.1106,-438.6118"/>
<polygon fill="#000000" stroke="#000000" points="234.7024,-442.0651 244.1876,-437.3447 233.829,-435.1198 234.7024,-442.0651"/>
</g>
<!-- proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node15" class="node">
<title>proc~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node15"><a xlink:href=".././proc/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#d9534f" stroke="#d9534f" points="603.5,-441 475.5,-441 475.5,-417 603.5,-417 603.5,-441"/>
<text text-anchor="middle" x="539.5" y="-426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge13" class="edge">
<title>proc~perform_apm&#45;&gt;proc~correct_center_of_mass</title>
<path fill="none" stroke="#000000" d="M167.3047,-436.8748C181.7078,-426.6428 204.0271,-412.7671 226,-407 314.5405,-383.7615 421.6785,-400.4318 485.0086,-414.682"/>
<polygon fill="#000000" stroke="#000000" points="484.2557,-418.1002 494.787,-416.9418 485.832,-411.2799 484.2557,-418.1002"/>
</g>
<!-- density -->
<g id="interface~~perform_apm~~CallsGraph_node16" class="node">
<title>density</title>
<polygon fill="#777777" stroke="#777777" points="345.5,-360 291.5,-360 291.5,-336 345.5,-336 345.5,-360"/>
<text text-anchor="middle" x="318.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">density</text>
</g>
<!-- proc~perform_apm&#45;&gt;density -->
<g id="interface~~perform_apm~~CallsGraph_edge15" class="edge">
<title>proc~perform_apm&#45;&gt;density</title>
<path fill="none" stroke="#000000" d="M160.1903,-436.9653C172.82,-420.3469 197.8363,-390.5537 226,-374 242.8305,-364.1076 263.6042,-357.8262 281.1985,-353.9216"/>
<polygon fill="#000000" stroke="#000000" points="282.0412,-357.3217 291.1365,-351.8879 280.6378,-350.4639 282.0412,-357.3217"/>
</g>
<!-- allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node17" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="377.5,-318 259.5,-318 259.5,-294 377.5,-294 377.5,-318"/>
<text text-anchor="middle" x="318.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">allocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge16" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M155.3485,-436.713C163.8109,-411.8163 186.4936,-355.3779 226,-327 233.0939,-321.9044 241.2188,-318.0188 249.6431,-315.0606"/>
<polygon fill="#000000" stroke="#000000" points="250.7185,-318.3917 259.2427,-312.0996 248.6553,-311.7027 250.7185,-318.3917"/>
</g>
<!-- proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node18" class="node">
<title>proc~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node18"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="383,-276 254,-276 254,-252 383,-252 383,-276"/>
<text text-anchor="middle" x="318.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge17" class="edge">
<title>proc~perform_apm&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M153.2754,-436.889C158.4267,-406.3022 176.3056,-325.501 226,-285 231.4033,-280.5963 237.5485,-277.0748 244.0428,-274.2641"/>
<polygon fill="#000000" stroke="#000000" points="245.6179,-277.4121 253.7615,-270.6347 243.1689,-270.8544 245.6179,-277.4121"/>
</g>
<!-- allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node19" class="node">
<title>allocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="365.5,-234 271.5,-234 271.5,-210 365.5,-210 365.5,-234"/>
<text text-anchor="middle" x="318.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">allocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge18" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_gradient</title>
<path fill="none" stroke="#000000" d="M152.0376,-436.8134C154.3009,-401.12 166,-295.998 226,-243 235.7388,-234.3977 248.262,-229.1032 260.9279,-225.8947"/>
<polygon fill="#000000" stroke="#000000" points="262.0091,-229.2434 271.0658,-223.7454 260.5573,-222.3956 262.0091,-229.2434"/>
</g>
<!-- density_loop -->
<g id="interface~~perform_apm~~CallsGraph_node20" class="node">
<title>density_loop</title>
<polygon fill="#777777" stroke="#777777" points="355,-192 282,-192 282,-168 355,-168 355,-192"/>
<text text-anchor="middle" x="318.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">density_loop</text>
</g>
<!-- proc~perform_apm&#45;&gt;density_loop -->
<g id="interface~~perform_apm~~CallsGraph_edge19" class="edge">
<title>proc~perform_apm&#45;&gt;density_loop</title>
<path fill="none" stroke="#000000" d="M153.5165,-436.7522C161.2101,-391.4851 190.1003,-234.5183 226,-201 238.3603,-189.4596 255.6878,-183.7986 272.0088,-181.157"/>
<polygon fill="#000000" stroke="#000000" points="272.5142,-184.621 281.9875,-179.8769 271.6234,-177.6779 272.5142,-184.621"/>
</g>
<!-- nu -->
<g id="interface~~perform_apm~~CallsGraph_node21" class="node">
<title>nu</title>
<polygon fill="#777777" stroke="#777777" points="345.5,-150 291.5,-150 291.5,-126 345.5,-126 345.5,-150"/>
<text text-anchor="middle" x="318.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">nu</text>
</g>
<!-- proc~perform_apm&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge20" class="edge">
<title>proc~perform_apm&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M152.9454,-436.8053C159.1012,-386.9191 184.7215,-199.1299 226,-159 240.5454,-144.8593 262.5111,-139.465 281.3877,-137.6739"/>
<polygon fill="#000000" stroke="#000000" points="281.7384,-141.1586 291.4901,-137.0169 281.284,-134.1733 281.7384,-141.1586"/>
</g>
<!-- exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_node22" class="node">
<title>exact_nei_tree_update</title>
<polygon fill="#777777" stroke="#777777" points="379.5,-108 257.5,-108 257.5,-84 379.5,-84 379.5,-108"/>
<text text-anchor="middle" x="318.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">exact_nei_tree_update</text>
</g>
<!-- proc~perform_apm&#45;&gt;exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_edge21" class="edge">
<title>proc~perform_apm&#45;&gt;exact_nei_tree_update</title>
<path fill="none" stroke="#000000" d="M152.511,-436.9301C157.2799,-382.8978 179.2757,-163.8413 226,-117 232.102,-110.8827 239.5884,-106.3908 247.6353,-103.115"/>
<polygon fill="#000000" stroke="#000000" points="248.9664,-106.3587 257.2899,-99.8036 246.6953,-99.7373 248.9664,-106.3587"/>
</g>
<!-- allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node23" class="node">
<title>allocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="397.5,-66 239.5,-66 239.5,-42 397.5,-42 397.5,-66"/>
<text text-anchor="middle" x="318.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">allocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge22" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M152.2029,-436.6162C155.7856,-377.9352 173.9234,-128.4816 226,-75 227.4648,-73.4957 229.0131,-72.0892 230.633,-70.7744"/>
<polygon fill="#000000" stroke="#000000" points="232.9466,-73.4353 239.2737,-64.9371 229.028,-67.6348 232.9466,-73.4353"/>
</g>
<!-- ncand -->
<g id="interface~~perform_apm~~CallsGraph_node24" class="node">
<title>ncand</title>
<polygon fill="#777777" stroke="#777777" points="345.5,-24 291.5,-24 291.5,0 345.5,0 345.5,-24"/>
<text text-anchor="middle" x="318.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ncand</text>
</g>
<!-- proc~perform_apm&#45;&gt;ncand -->
<g id="interface~~perform_apm~~CallsGraph_edge23" class="edge">
<title>proc~perform_apm&#45;&gt;ncand</title>
<path fill="none" stroke="#000000" d="M151.9213,-436.9245C154.3304,-374.9699 168.3589,-93.3576 226,-33 240.0105,-18.3292 261.9561,-12.915 280.9558,-11.2458"/>
<polygon fill="#000000" stroke="#000000" points="281.353,-14.729 291.139,-10.6689 280.957,-7.7403 281.353,-14.729"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node25" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node25"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="632,-646 447,-646 447,-622 632,-622 632,-646"/>
<text text-anchor="middle" x="539.5" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge24" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M411.2633,-634C419.7534,-634 428.3869,-634 436.9563,-634"/>
<polygon fill="#000000" stroke="#000000" points="436.9742,-637.5001 446.9741,-634 436.9741,-630.5001 436.9742,-637.5001"/>
</g>
<!-- validate_position -->
<g id="interface~~perform_apm~~CallsGraph_node27" class="node">
<title>validate_position</title>
<polygon fill="#777777" stroke="#777777" points="585.5,-524 493.5,-524 493.5,-500 585.5,-500 585.5,-524"/>
<text text-anchor="middle" x="539.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">validate_position</text>
</g>
<!-- none~validate_position_final&#45;&gt;validate_position -->
<g id="interface~~perform_apm~~CallsGraph_edge25" class="edge">
<title>none~validate_position_final&#45;&gt;validate_position</title>
<path fill="none" stroke="#000000" d="M377.7239,-512C410.4893,-512 450.9833,-512 483.2609,-512"/>
<polygon fill="#000000" stroke="#000000" points="483.4318,-515.5001 493.4318,-512 483.4317,-508.5001 483.4318,-515.5001"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge26" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M563.2192,-441.1025C583.2402,-452.1481 611.7911,-469.9335 632,-491 655.5317,-515.5304 674.5305,-550.3131 685.2968,-572.5164"/>
<polygon fill="#000000" stroke="#000000" points="682.2202,-574.1984 689.6508,-581.7506 688.5517,-571.2129 682.2202,-574.1984"/>
</g>
<!-- indexx -->
<g id="interface~~perform_apm~~CallsGraph_node26" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="566.5,-276 512.5,-276 512.5,-252 566.5,-252 566.5,-276"/>
<text text-anchor="middle" x="539.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="interface~~perform_apm~~CallsGraph_edge27" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M383.0164,-264C421.7057,-264 469.5486,-264 502.0768,-264"/>
<polygon fill="#000000" stroke="#000000" points="502.4858,-267.5001 512.4857,-264 502.4857,-260.5001 502.4858,-267.5001"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge28" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M586.1551,-621.9987C609.1694,-616.0786 636.5356,-609.0391 658.0702,-603.4996"/>
<polygon fill="#000000" stroke="#000000" points="659.0095,-606.872 667.8223,-600.9911 657.2656,-600.0927 659.0095,-606.872"/>
</g>
</g>
</svg>
</div><script>var paninterfaceperform_apmCallsGraph = svgPanZoom('#interfaceperform_apmCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="560pt" height="32pt"
 viewBox="0.00 0.00 559.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 555.5,-28 555.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,0 64,0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,0 136,0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.5,-24 154.5,-24 154.5,0 209.5,0 209.5,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,0 364,0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,0 436,0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="551.5,-24 454.5,-24 454.5,0 551.5,0 551.5,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    
    <br>
    
      <h2>
public module module subroutine perform_apm(get_density, get_nstar_p, pos_input, pvol, h_output, nu_output, center, com_star, mass, radx_comp, radx_opp, rady, radz, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, namefile_pos_id, namefile_pos, namefile_results, validate_position)
    
    
   
   <a href='../proc/perform_apm.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h2>
    

    
  


    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
function get_density(x, y, z) result(density)
    
    
   
</h5>
    



<p>Returns the baryon mass density at the desired point</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h6>Return Value <small>double precision
  </small></h6>
  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
subroutine get_nstar_p(npart_real, x, y, z, nstar_p)
    
    
   
</h5>
    



<p>Computes the proper baryon number density at the particle positions</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong>(npart_real)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong>(npart_real)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong>(npart_real)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nstar_p</strong>(npart_real)</td><td><p>Array to store the computed proper baryon number density</p></td>
  
</tr>

</tbody>
</table>

      
    
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pos_input"></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:,:)</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pvol~3"></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h_output"></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nu_output"></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-center~6"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-com_star~2"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mass~4"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-radx_comp"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radx_comp</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-radx_opp"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radx_opp</strong></td><td><p>Radius of the star in the x direction, opposite to companion</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rady"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rady</strong></td><td><p>Radius of the star in the y direction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-radz"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radz</strong></td><td><p>Radius of the star in the z direction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-apm_max_it"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-max_inc"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mass_it"></span>logical,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-correct_nu~2"></span>logical,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuratio_thres"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuratio_des"></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nx_gh"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ny_gh"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nz_gh"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-namefile_pos_id"></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-namefile_pos"></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-namefile_results"></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-validate_position"></span>procedure(validate_position_int),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
  
</tr>

</tbody>
</table>

    
    
    
    <h3>Description</h3>
    <p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
    
    <br>

 </div>
</div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2021 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
             on 2021-11-14 16:41:50 
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>