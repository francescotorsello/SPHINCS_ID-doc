
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>perform_apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.5</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>About</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>perform_apm
   <small>Interface</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.3% of total for procedures.">187 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/module_sph_particles.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/module_sph_particles.f90.html'>module_sph_particles.f90</a></li>
     <li><a href='../module/sph_particles.html'>sph_particles</a></li>
     <li class="active">perform_apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<em>None</em>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>interface</h2>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: interface~~perform_apm~~CallsGraph Pages: 1 -->
<svg id="interfaceperform_apmCallsGraph" width="641pt" height="902pt"
 viewBox="0.00 0.00 641.00 902.45" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="interface~~perform_apm~~CallsGraph" class="graph" transform="scale(1.74 1.74) rotate(0) translate(4 1570)">
<title>interface~~perform_apm~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1570 1114,-1570 1114,4 -4,4"/>
<!-- interface~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node1" class="node">
<title>interface~perform_apm</title>
<polygon fill="none" stroke="black" points="85,-738 0,-738 0,-714 85,-714 85,-738"/>
<text text-anchor="middle" x="42.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50">perform_apm</text>
</g>
<!-- proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node2" class="node">
<title>proc~perform_apm</title>
<g id="a_interface~~perform_apm~~CallsGraph_node2"><a xlink:href=".././proc/perform_apm.html" xlink:title="perform_apm">
<polygon fill="#d9534f" stroke="#d9534f" points="206,-738 121,-738 121,-714 206,-714 206,-738"/>
<text text-anchor="middle" x="163.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_apm</text>
</a>
</g>
</g>
<!-- interface~perform_apm&#45;&gt;proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_edge1" class="edge">
<title>interface~perform_apm&#45;&gt;proc~perform_apm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M85.12,-726C93.32,-726 102.01,-726 110.5,-726"/>
<polygon fill="#000000" stroke="#000000" points="110.7,-729.5 120.7,-726 110.7,-722.5 110.7,-729.5"/>
</g>
<!-- proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_node3" class="node">
<title>proc~spherical_from_cartesian</title>
<g id="a_interface~~perform_apm~~CallsGraph_node3"><a xlink:href=".././proc/spherical_from_cartesian.html" xlink:title="spherical_from_cartesian">
<polygon fill="#d9534f" stroke="#d9534f" points="658.5,-1440 512.5,-1440 512.5,-1416 658.5,-1416 658.5,-1440"/>
<text text-anchor="middle" x="585.5" y="-1425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spherical_from_cartesian</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge2" class="edge">
<title>proc~perform_apm&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M165.04,-738.17C168.96,-824.15 194.3,-1338.05 242,-1386 313.37,-1457.74 439.67,-1453.09 517.34,-1441.63"/>
<polygon fill="#000000" stroke="#000000" points="518.16,-1445.05 527.5,-1440.05 517.08,-1438.13 518.16,-1445.05"/>
</g>
<!-- none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_node4" class="node">
<title>none~get_nstar_id_atm</title>
<polygon fill="#d9534f" stroke="#d9534f" points="396,-1150 293,-1150 293,-1126 396,-1126 396,-1150"/>
<text text-anchor="middle" x="344.5" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id_atm</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_edge3" class="edge">
<title>proc~perform_apm&#45;&gt;none~get_nstar_id_atm</title>
<path fill="none" stroke="#000000" d="M165.25,-738.35C169.14,-798.04 188.84,-1055.97 242,-1112 252.78,-1123.37 267.8,-1130.03 282.98,-1133.86"/>
<polygon fill="#000000" stroke="#000000" points="282.43,-1137.32 292.94,-1136 283.89,-1130.48 282.43,-1137.32"/>
</g>
<!-- deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node5" class="node">
<title>deallocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="404,-948 285,-948 285,-924 404,-924 404,-948"/>
<text text-anchor="middle" x="344.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge4" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_gradient</title>
<path fill="none" stroke="#000000" d="M165.67,-738.47C169.55,-772.56 185.24,-867.88 242,-915 251.41,-922.81 262.98,-927.96 274.9,-931.3"/>
<polygon fill="#000000" stroke="#000000" points="274.41,-934.78 284.95,-933.7 276.04,-927.97 274.41,-934.78"/>
</g>
<!-- proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_node6" class="node">
<title>proc~find_h_backup</title>
<g id="a_interface~~perform_apm~~CallsGraph_node6"><a xlink:href=".././proc/find_h_backup.html" xlink:title="find_h_backup">
<polygon fill="#d94e8f" stroke="#d94e8f" points="389,-906 300,-906 300,-882 389,-882 389,-906"/>
<text text-anchor="middle" x="344.5" y="-891.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_h_backup</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_edge5" class="edge">
<title>proc~perform_apm&#45;&gt;proc~find_h_backup</title>
<path fill="none" stroke="#000000" d="M167.17,-738.19C174.1,-766.7 195.42,-837.97 242,-873 255.64,-883.26 273.1,-888.79 289.68,-891.7"/>
<polygon fill="#000000" stroke="#000000" points="289.44,-895.21 299.84,-893.2 290.46,-888.28 289.44,-895.21"/>
</g>
<!-- lpart -->
<g id="interface~~perform_apm~~CallsGraph_node7" class="node">
<title>lpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-864 317.5,-864 317.5,-840 371.5,-840 371.5,-864"/>
<text text-anchor="middle" x="344.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;lpart -->
<g id="interface~~perform_apm~~CallsGraph_edge6" class="edge">
<title>proc~perform_apm&#45;&gt;lpart</title>
<path fill="none" stroke="#000000" d="M169.74,-738.01C180.09,-760.21 205.36,-807.54 242,-831 261.36,-843.39 286.67,-848.65 307.17,-850.8"/>
<polygon fill="#000000" stroke="#000000" points="307.14,-854.31 317.4,-851.67 307.73,-847.34 307.14,-854.31"/>
</g>
<!-- ncand -->
<g id="interface~~perform_apm~~CallsGraph_node8" class="node">
<title>ncand</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-822 317.5,-822 317.5,-798 371.5,-798 371.5,-822"/>
<text text-anchor="middle" x="344.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ncand</text>
</g>
<!-- proc~perform_apm&#45;&gt;ncand -->
<g id="interface~~perform_apm~~CallsGraph_edge7" class="edge">
<title>proc~perform_apm&#45;&gt;ncand</title>
<path fill="none" stroke="#000000" d="M175.6,-738.02C189.63,-752.45 215.22,-776.28 242,-789 262.49,-798.73 287.4,-803.97 307.42,-806.78"/>
<polygon fill="#000000" stroke="#000000" points="307.03,-810.26 317.39,-808.04 307.91,-803.31 307.03,-810.26"/>
</g>
<!-- none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_node9" class="node">
<title>none~place_and_print_ghost_particles</title>
<polygon fill="#d9534f" stroke="#d9534f" points="436,-1377 253,-1377 253,-1353 436,-1353 436,-1377"/>
<text text-anchor="middle" x="344.5" y="-1362.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">place_and_print_ghost_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge8" class="edge">
<title>proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles</title>
<path fill="none" stroke="#000000" d="M164.5,-738.16C164.72,-814.24 169.29,-1224.48 242,-1321 251.48,-1333.58 265.31,-1342.62 279.72,-1349.09"/>
<polygon fill="#000000" stroke="#000000" points="278.66,-1352.44 289.24,-1352.99 281.31,-1345.96 278.66,-1352.44"/>
</g>
<!-- none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_node10" class="node">
<title>none~allocate_apm_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-780 285.5,-780 285.5,-756 403.5,-756 403.5,-780"/>
<text text-anchor="middle" x="344.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_apm_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge9" class="edge">
<title>proc~perform_apm&#45;&gt;none~allocate_apm_fields</title>
<path fill="none" stroke="#000000" d="M206.21,-737.8C217.77,-740.93 230.34,-744.22 242,-747 252.83,-749.59 264.35,-752.15 275.6,-754.55"/>
<polygon fill="#000000" stroke="#000000" points="274.89,-757.97 285.4,-756.61 276.33,-751.12 274.89,-757.97"/>
</g>
<!-- allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node11" class="node">
<title>allocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="431,-738 258,-738 258,-714 431,-714 431,-738"/>
<text text-anchor="middle" x="344.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge10" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M206.02,-726C218.6,-726 232.99,-726 247.6,-726"/>
<polygon fill="#000000" stroke="#000000" points="247.74,-729.5 257.74,-726 247.74,-722.5 247.74,-729.5"/>
</g>
<!-- com -->
<g id="interface~~perform_apm~~CallsGraph_node12" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-1032 784.5,-1032 784.5,-1008 838.5,-1008 838.5,-1032"/>
<text text-anchor="middle" x="811.5" y="-1017.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">com</text>
</g>
<!-- proc~perform_apm&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge11" class="edge">
<title>proc~perform_apm&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M166.05,-738.03C172.53,-786.35 199.18,-965.38 242,-999 283.71,-1031.75 655.56,-1024.33 774.25,-1021.09"/>
<polygon fill="#000000" stroke="#000000" points="774.4,-1024.59 784.29,-1020.81 774.2,-1017.59 774.4,-1024.59"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node13" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node13"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="447,-990 242,-990 242,-966 447,-966 447,-990"/>
<text text-anchor="middle" x="344.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge12" class="edge">
<title>proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M164.61,-738.03C165.66,-776.43 174.43,-897.07 242,-957 243.34,-958.19 244.73,-959.32 246.17,-960.39"/>
<polygon fill="#000000" stroke="#000000" points="244.51,-963.48 254.82,-965.92 248.28,-957.58 244.51,-963.48"/>
</g>
<!-- timer -->
<g id="interface~~perform_apm~~CallsGraph_node14" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-696 317.5,-696 317.5,-672 371.5,-672 371.5,-696"/>
<text text-anchor="middle" x="344.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~perform_apm&#45;&gt;timer -->
<g id="interface~~perform_apm~~CallsGraph_edge13" class="edge">
<title>proc~perform_apm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M206.21,-714.2C217.77,-711.07 230.34,-707.78 242,-705 263.51,-699.86 287.77,-694.82 307.17,-690.96"/>
<polygon fill="#000000" stroke="#000000" points="307.98,-694.37 317.12,-689 306.63,-687.5 307.98,-694.37"/>
</g>
<!-- interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node15" class="node">
<title>interface~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node15"><a xlink:href=".././interface/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#a7506f" stroke="#a7506f" points="413.5,-1070 275.5,-1070 275.5,-1046 413.5,-1046 413.5,-1070"/>
<text text-anchor="middle" x="344.5" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge14" class="edge">
<title>proc~perform_apm&#45;&gt;interface~correct_center_of_mass</title>
<path fill="none" stroke="#000000" d="M165.92,-738.13C172.19,-789.55 198.95,-988.83 242,-1032 248.77,-1038.79 257.05,-1043.88 265.94,-1047.69"/>
<polygon fill="#000000" stroke="#000000" points="264.79,-1051 275.38,-1051.22 267.24,-1044.44 264.79,-1051"/>
</g>
<!-- assign_h -->
<g id="interface~~perform_apm~~CallsGraph_node16" class="node">
<title>assign_h</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-654 315.5,-654 315.5,-630 373.5,-630 373.5,-654"/>
<text text-anchor="middle" x="344.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">assign_h</text>
</g>
<!-- proc~perform_apm&#45;&gt;assign_h -->
<g id="interface~~perform_apm~~CallsGraph_edge15" class="edge">
<title>proc~perform_apm&#45;&gt;assign_h</title>
<path fill="none" stroke="#000000" d="M175.6,-713.98C189.63,-699.55 215.22,-675.72 242,-663 261.7,-653.64 285.5,-648.44 305.1,-645.55"/>
<polygon fill="#000000" stroke="#000000" points="305.76,-649 315.22,-644.21 304.84,-642.06 305.76,-649"/>
</g>
<!-- deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node17" class="node">
<title>deallocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="438,-612 251,-612 251,-588 438,-588 438,-612"/>
<text text-anchor="middle" x="344.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge16" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M169.74,-713.99C180.09,-691.79 205.36,-644.46 242,-621 244.77,-619.23 247.65,-617.6 250.63,-616.11"/>
<polygon fill="#000000" stroke="#000000" points="252.09,-619.29 259.8,-612.03 249.24,-612.9 252.09,-619.29"/>
</g>
<!-- nic -->
<g id="interface~~perform_apm~~CallsGraph_node18" class="node">
<title>nic</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-570 317.5,-570 317.5,-546 371.5,-546 371.5,-570"/>
<text text-anchor="middle" x="344.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nic</text>
</g>
<!-- proc~perform_apm&#45;&gt;nic -->
<g id="interface~~perform_apm~~CallsGraph_edge17" class="edge">
<title>proc~perform_apm&#45;&gt;nic</title>
<path fill="none" stroke="#000000" d="M167.17,-713.81C174.1,-685.3 195.42,-614.03 242,-579 260.58,-565.03 286.25,-559.81 307.13,-558.07"/>
<polygon fill="#000000" stroke="#000000" points="307.47,-561.55 317.24,-557.46 307.05,-554.57 307.47,-561.55"/>
</g>
<!-- none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_node19" class="node">
<title>none~reallocate_output_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="414,-1503 275,-1503 275,-1479 414,-1479 414,-1503"/>
<text text-anchor="middle" x="344.5" y="-1488.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reallocate_output_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge18" class="edge">
<title>proc~perform_apm&#45;&gt;none~reallocate_output_fields</title>
<path fill="none" stroke="#000000" d="M164.4,-738.02C163.91,-820.98 164.41,-1308.85 242,-1430 255.08,-1450.42 277.65,-1464.97 298.19,-1474.73"/>
<polygon fill="#000000" stroke="#000000" points="296.89,-1477.98 307.44,-1478.88 299.75,-1471.59 296.89,-1477.98"/>
</g>
<!-- interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node20" class="node">
<title>interface~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node20"><a xlink:href=".././interface/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#a7506f" stroke="#a7506f" points="415.5,-528 273.5,-528 273.5,-504 415.5,-504 415.5,-528"/>
<text text-anchor="middle" x="344.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge19" class="edge">
<title>proc~perform_apm&#45;&gt;interface~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M165.67,-713.53C169.55,-679.44 185.24,-584.12 242,-537 248.47,-531.63 255.96,-527.52 263.88,-524.39"/>
<polygon fill="#000000" stroke="#000000" points="265.01,-527.7 273.34,-521.15 262.74,-521.08 265.01,-527.7"/>
</g>
<!-- allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node21" class="node">
<title>allocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="427,-486 262,-486 262,-462 427,-462 427,-486"/>
<text text-anchor="middle" x="344.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge20" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M164.61,-713.97C165.66,-675.57 174.43,-554.93 242,-495 245.26,-492.11 248.8,-489.58 252.56,-487.37"/>
<polygon fill="#000000" stroke="#000000" points="254.31,-490.4 261.65,-482.76 251.15,-484.16 254.31,-490.4"/>
</g>
<!-- none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_node22" class="node">
<title>none~validate_position_final</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="410,-444 279,-444 279,-420 410,-420 410,-444"/>
<text text-anchor="middle" x="344.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position_final</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_edge21" class="edge">
<title>proc~perform_apm&#45;&gt;none~validate_position_final</title>
<path fill="none" stroke="#000000" d="M163.9,-713.99C162.46,-671.34 163.71,-525.81 242,-453 249.69,-445.85 259.15,-440.87 269.17,-437.44"/>
<polygon fill="#000000" stroke="#000000" points="270.28,-440.76 278.91,-434.6 268.33,-434.04 270.28,-440.76"/>
</g>
<!-- deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node23" class="node">
<title>deallocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="433.5,-402 255.5,-402 255.5,-378 433.5,-378 433.5,-402"/>
<text text-anchor="middle" x="344.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge22" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M165.78,-713.82C171.53,-661.26 196.78,-454.57 242,-411 243.51,-409.55 245.09,-408.19 246.73,-406.91"/>
<polygon fill="#000000" stroke="#000000" points="248.99,-409.61 255.41,-401.18 245.14,-403.76 248.99,-409.61"/>
</g>
<!-- none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_node24" class="node">
<title>none~dump_apm_pos</title>
<polygon fill="#d9534f" stroke="#d9534f" points="393,-1312 296,-1312 296,-1288 393,-1288 393,-1312"/>
<text text-anchor="middle" x="344.5" y="-1297.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dump_apm_pos</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_edge23" class="edge">
<title>proc~perform_apm&#45;&gt;none~dump_apm_pos</title>
<path fill="none" stroke="#000000" d="M164.47,-738.26C164.54,-811.44 168.47,-1190.14 242,-1273 253.17,-1285.59 269.49,-1292.62 285.79,-1296.45"/>
<polygon fill="#000000" stroke="#000000" points="285.4,-1299.94 295.89,-1298.44 286.76,-1293.07 285.4,-1299.94"/>
</g>
<!-- rpart -->
<g id="interface~~perform_apm~~CallsGraph_node25" class="node">
<title>rpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-360 317.5,-360 317.5,-336 371.5,-336 371.5,-360"/>
<text text-anchor="middle" x="344.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;rpart -->
<g id="interface~~perform_apm~~CallsGraph_edge24" class="edge">
<title>proc~perform_apm&#45;&gt;rpart</title>
<path fill="none" stroke="#000000" d="M165.4,-713.77C169.85,-656.93 191.3,-419.21 242,-369 258.92,-352.24 285.47,-347.2 307.18,-346.24"/>
<polygon fill="#000000" stroke="#000000" points="307.44,-349.73 317.38,-346.06 307.32,-342.73 307.44,-349.73"/>
</g>
<!-- position_correction -->
<g id="interface~~perform_apm~~CallsGraph_node26" class="node">
<title>position_correction</title>
<polygon fill="#777777" stroke="#777777" points="401,-318 288,-318 288,-294 401,-294 401,-318"/>
<text text-anchor="middle" x="344.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">position_correction</text>
</g>
<!-- proc~perform_apm&#45;&gt;position_correction -->
<g id="interface~~perform_apm~~CallsGraph_edge25" class="edge">
<title>proc~perform_apm&#45;&gt;position_correction</title>
<path fill="none" stroke="#000000" d="M165.09,-713.99C168.31,-653.63 185.71,-383.98 242,-327 251.67,-317.21 264.61,-311.4 278.01,-308.06"/>
<polygon fill="#000000" stroke="#000000" points="278.73,-311.49 287.81,-306.04 277.31,-304.63 278.73,-311.49"/>
</g>
<!-- iorig -->
<g id="interface~~perform_apm~~CallsGraph_node27" class="node">
<title>iorig</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-276 317.5,-276 317.5,-252 371.5,-252 371.5,-276"/>
<text text-anchor="middle" x="344.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iorig</text>
</g>
<!-- proc~perform_apm&#45;&gt;iorig -->
<g id="interface~~perform_apm~~CallsGraph_edge26" class="edge">
<title>proc~perform_apm&#45;&gt;iorig</title>
<path fill="none" stroke="#000000" d="M164.86,-713.61C167.03,-648.72 180.29,-348.6 242,-285 258.58,-267.91 285.15,-262.88 306.94,-262"/>
<polygon fill="#000000" stroke="#000000" points="307.24,-265.5 317.19,-261.87 307.15,-258.5 307.24,-265.5"/>
</g>
<!-- proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_node28" class="node">
<title>proc~is_finite_number</title>
<g id="a_interface~~perform_apm~~CallsGraph_node28"><a xlink:href=".././proc/is_finite_number.html" xlink:title="is_finite_number">
<polygon fill="#d94e8f" stroke="#d94e8f" points="861.5,-1110 761.5,-1110 761.5,-1086 861.5,-1086 861.5,-1110"/>
<text text-anchor="middle" x="811.5" y="-1095.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_finite_number</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge27" class="edge">
<title>proc~perform_apm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M165.25,-738.29C168.99,-795.38 187.74,-1033.85 242,-1079 280.38,-1110.94 612.89,-1104.27 750.88,-1100.06"/>
<polygon fill="#000000" stroke="#000000" points="751.37,-1103.55 761.26,-1099.74 751.15,-1096.55 751.37,-1103.55"/>
</g>
<!-- none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_node29" class="node">
<title>none~discard_atmosphere</title>
<polygon fill="#d9534f" stroke="#d9534f" points="405,-1231 284,-1231 284,-1207 405,-1207 405,-1231"/>
<text text-anchor="middle" x="344.5" y="-1216.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">discard_atmosphere</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_edge28" class="edge">
<title>proc~perform_apm&#45;&gt;none~discard_atmosphere</title>
<path fill="none" stroke="#000000" d="M164.78,-738.17C166.57,-804.68 178.39,-1123.65 242,-1193 250.59,-1202.36 262.04,-1208.55 274.16,-1212.6"/>
<polygon fill="#000000" stroke="#000000" points="273.4,-1216.02 283.98,-1215.41 275.33,-1209.29 273.4,-1216.02"/>
</g>
<!-- allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node30" class="node">
<title>allocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="397.5,-234 291.5,-234 291.5,-210 397.5,-210 397.5,-234"/>
<text text-anchor="middle" x="344.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge29" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_gradient</title>
<path fill="none" stroke="#000000" d="M164.65,-713.81C165.77,-645.76 174.65,-313.44 242,-243 252.31,-232.22 266.58,-226.22 281.16,-223.03"/>
<polygon fill="#000000" stroke="#000000" points="282.03,-226.43 291.27,-221.25 280.81,-219.54 282.03,-226.43"/>
</g>
<!-- density -->
<g id="interface~~perform_apm~~CallsGraph_node31" class="node">
<title>density</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-192 317.5,-192 317.5,-168 371.5,-168 371.5,-192"/>
<text text-anchor="middle" x="344.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density</text>
</g>
<!-- proc~perform_apm&#45;&gt;density -->
<g id="interface~~perform_apm~~CallsGraph_edge30" class="edge">
<title>proc~perform_apm&#45;&gt;density</title>
<path fill="none" stroke="#000000" d="M164.48,-713.71C164.65,-642 169.1,-278.21 242,-201 258.35,-183.68 284.92,-178.66 306.78,-177.84"/>
<polygon fill="#000000" stroke="#000000" points="307.09,-181.34 317.06,-177.75 307.03,-174.34 307.09,-181.34"/>
</g>
<!-- density_loop -->
<g id="interface~~perform_apm~~CallsGraph_node32" class="node">
<title>density_loop</title>
<polygon fill="#777777" stroke="#777777" points="384,-150 305,-150 305,-126 384,-126 384,-150"/>
<text text-anchor="middle" x="344.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density_loop</text>
</g>
<!-- proc~perform_apm&#45;&gt;density_loop -->
<g id="interface~~perform_apm~~CallsGraph_edge31" class="edge">
<title>proc~perform_apm&#45;&gt;density_loop</title>
<path fill="none" stroke="#000000" d="M164.34,-713.72C163.6,-638.75 163.5,-243.04 242,-159 255.38,-144.68 275.75,-138.74 294.74,-136.65"/>
<polygon fill="#000000" stroke="#000000" points="295.09,-140.13 304.79,-135.86 294.55,-133.15 295.09,-140.13"/>
</g>
<!-- exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_node33" class="node">
<title>exact_nei_tree_update</title>
<polygon fill="#777777" stroke="#777777" points="410.5,-108 278.5,-108 278.5,-84 410.5,-84 410.5,-108"/>
<text text-anchor="middle" x="344.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_nei_tree_update</text>
</g>
<!-- proc~perform_apm&#45;&gt;exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_edge32" class="edge">
<title>proc~perform_apm&#45;&gt;exact_nei_tree_update</title>
<path fill="none" stroke="#000000" d="M164.21,-713.85C162.63,-636.02 157.85,-207.94 242,-117 249.22,-109.19 258.52,-103.87 268.56,-100.3"/>
<polygon fill="#000000" stroke="#000000" points="269.76,-103.6 278.35,-97.4 267.77,-96.89 269.76,-103.6"/>
</g>
<!-- deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node34" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="416,-66 273,-66 273,-42 416,-42 416,-66"/>
<text text-anchor="middle" x="344.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge33" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M165.11,-713.76C169.45,-628.42 196.93,-124.1 242,-75 247.9,-68.57 255.22,-63.82 263.19,-60.35"/>
<polygon fill="#000000" stroke="#000000" points="264.62,-63.55 272.81,-56.84 262.21,-56.98 264.62,-63.55"/>
</g>
<!-- nu -->
<g id="interface~~perform_apm~~CallsGraph_node35" class="node">
<title>nu</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1272 558.5,-1272 558.5,-1248 612.5,-1248 612.5,-1272"/>
<text text-anchor="middle" x="585.5" y="-1257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu</text>
</g>
<!-- proc~perform_apm&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge34" class="edge">
<title>proc~perform_apm&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M164.37,-738.2C163.87,-809.33 165.18,-1169.89 242,-1240 285.86,-1280.03 469.14,-1269.84 548.08,-1263.37"/>
<polygon fill="#000000" stroke="#000000" points="548.83,-1266.82 558.5,-1262.49 548.24,-1259.85 548.83,-1266.82"/>
</g>
<!-- allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node36" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="409.5,-24 279.5,-24 279.5,0 409.5,0 409.5,-24"/>
<text text-anchor="middle" x="344.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge35" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M165.01,-713.84C168.83,-625.59 194.09,-85.57 242,-33 249.42,-24.85 259.11,-19.4 269.54,-15.83"/>
<polygon fill="#000000" stroke="#000000" points="270.64,-19.15 279.29,-13.04 268.71,-12.42 270.64,-19.15"/>
</g>
<!-- h -->
<g id="interface~~perform_apm~~CallsGraph_node37" class="node">
<title>h</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1230 558.5,-1230 558.5,-1206 612.5,-1206 612.5,-1230"/>
<text text-anchor="middle" x="585.5" y="-1215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~perform_apm&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge36" class="edge">
<title>proc~perform_apm&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M164.86,-738.2C167.02,-802.12 180.24,-1097.64 242,-1159 252.88,-1169.81 462.42,-1200.65 548.28,-1212.9"/>
<polygon fill="#000000" stroke="#000000" points="547.96,-1216.39 558.35,-1214.33 548.95,-1209.46 547.96,-1216.39"/>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge37" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M395.61,-1150.02C463.03,-1164.19 586.23,-1182.94 688,-1159 723.48,-1150.66 760.42,-1130.41 784.34,-1115.52"/>
<polygon fill="#000000" stroke="#000000" points="786.28,-1118.43 792.84,-1110.11 782.52,-1112.53 786.28,-1118.43"/>
</g>
<!-- get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_node44" class="node">
<title>get_nstar_id</title>
<polygon fill="#777777" stroke="#777777" points="624,-1150 547,-1150 547,-1126 624,-1126 624,-1150"/>
<text text-anchor="middle" x="585.5" y="-1135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id</text>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_edge38" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;get_nstar_id</title>
<path fill="none" stroke="#000000" d="M396.19,-1138C437.66,-1138 495.9,-1138 536.6,-1138"/>
<polygon fill="#000000" stroke="#000000" points="536.8,-1141.5 546.8,-1138 536.8,-1134.5 536.8,-1141.5"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge39" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M381.72,-1377.07C409.3,-1386.01 448.3,-1398.13 483,-1407 492.25,-1409.36 502.03,-1411.65 511.72,-1413.79"/>
<polygon fill="#000000" stroke="#000000" points="511.24,-1417.27 521.75,-1415.96 512.72,-1410.43 511.24,-1417.27"/>
</g>
<!-- pos_input -->
<g id="interface~~perform_apm~~CallsGraph_node43" class="node">
<title>pos_input</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-1482 553.5,-1482 553.5,-1458 617.5,-1458 617.5,-1482"/>
<text text-anchor="middle" x="585.5" y="-1467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pos_input</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge40" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M361.05,-1377.01C385.58,-1395.35 435.39,-1430.19 483,-1449 502.06,-1456.53 524.26,-1461.52 543.02,-1464.73"/>
<polygon fill="#000000" stroke="#000000" points="542.62,-1468.21 553.05,-1466.34 543.73,-1461.3 542.62,-1468.21"/>
</g>
<!-- center -->
<g id="interface~~perform_apm~~CallsGraph_node46" class="node">
<title>center</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1356 558.5,-1356 558.5,-1332 612.5,-1332 612.5,-1356"/>
<text text-anchor="middle" x="585.5" y="-1341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">center</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;center -->
<g id="interface~~perform_apm~~CallsGraph_edge41" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;center</title>
<path fill="none" stroke="#000000" d="M436.2,-1357.03C475.13,-1353.61 518.39,-1349.81 548.09,-1347.2"/>
<polygon fill="#000000" stroke="#000000" points="548.73,-1350.66 558.39,-1346.29 548.12,-1343.68 548.73,-1350.66"/>
</g>
<!-- get_density -->
<g id="interface~~perform_apm~~CallsGraph_node47" class="node">
<title>get_density</title>
<polygon fill="#777777" stroke="#777777" points="622,-1314 549,-1314 549,-1290 622,-1290 622,-1314"/>
<text text-anchor="middle" x="585.5" y="-1299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_density</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge42" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M381.72,-1352.93C409.3,-1343.99 448.3,-1331.87 483,-1323 501.07,-1318.38 521.15,-1314.06 538.65,-1310.55"/>
<polygon fill="#000000" stroke="#000000" points="539.48,-1313.95 548.61,-1308.58 538.13,-1307.09 539.48,-1313.95"/>
</g>
<!-- sizes -->
<g id="interface~~perform_apm~~CallsGraph_node48" class="node">
<title>sizes</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1398 558.5,-1398 558.5,-1374 612.5,-1374 612.5,-1398"/>
<text text-anchor="middle" x="585.5" y="-1383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sizes</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;sizes -->
<g id="interface~~perform_apm~~CallsGraph_edge43" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;sizes</title>
<path fill="none" stroke="#000000" d="M436.2,-1372.97C475.13,-1376.39 518.39,-1380.19 548.09,-1382.8"/>
<polygon fill="#000000" stroke="#000000" points="548.12,-1386.32 558.39,-1383.71 548.73,-1379.34 548.12,-1386.32"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node41" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node41"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="688,-990 483,-990 483,-966 688,-966 688,-990"/>
<text text-anchor="middle" x="585.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge44" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.2,-978C455.7,-978 464.31,-978 472.87,-978"/>
<polygon fill="#000000" stroke="#000000" points="472.89,-981.5 482.89,-978 472.89,-974.5 472.89,-981.5"/>
</g>
<!-- proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node42" class="node">
<title>proc~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node42"><a xlink:href=".././proc/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#d9534f" stroke="#d9534f" points="654.5,-1070 516.5,-1070 516.5,-1046 654.5,-1046 654.5,-1070"/>
<text text-anchor="middle" x="585.5" y="-1055.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge45" class="edge">
<title>interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.67,-1058C442.42,-1058 476.08,-1058 505.88,-1058"/>
<polygon fill="#000000" stroke="#000000" points="506.24,-1061.5 516.24,-1058 506.24,-1054.5 506.24,-1061.5"/>
</g>
<!-- nu_output -->
<g id="interface~~perform_apm~~CallsGraph_node39" class="node">
<title>nu_output</title>
<polygon fill="#777777" stroke="#777777" points="618.5,-1566 552.5,-1566 552.5,-1542 618.5,-1542 618.5,-1566"/>
<text text-anchor="middle" x="585.5" y="-1551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;nu_output -->
<g id="interface~~perform_apm~~CallsGraph_edge46" class="edge">
<title>none~reallocate_output_fields&#45;&gt;nu_output</title>
<path fill="none" stroke="#000000" d="M381.72,-1503.07C409.3,-1512.01 448.3,-1524.13 483,-1533 502.42,-1537.96 524.15,-1542.58 542.51,-1546.22"/>
<polygon fill="#000000" stroke="#000000" points="541.84,-1549.65 552.33,-1548.13 543.18,-1542.78 541.84,-1549.65"/>
</g>
<!-- none~reallocate_output_fields&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge47" class="edge">
<title>none~reallocate_output_fields&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M414.31,-1484.95C456.1,-1481.28 508.05,-1476.72 543.49,-1473.6"/>
<polygon fill="#000000" stroke="#000000" points="543.82,-1477.09 553.48,-1472.73 543.21,-1470.11 543.82,-1477.09"/>
</g>
<!-- h_output -->
<g id="interface~~perform_apm~~CallsGraph_node45" class="node">
<title>h_output</title>
<polygon fill="#777777" stroke="#777777" points="615,-1524 556,-1524 556,-1500 615,-1500 615,-1524"/>
<text text-anchor="middle" x="585.5" y="-1509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;h_output -->
<g id="interface~~perform_apm~~CallsGraph_edge48" class="edge">
<title>none~reallocate_output_fields&#45;&gt;h_output</title>
<path fill="none" stroke="#000000" d="M414.31,-1497.05C456.92,-1500.79 510.1,-1505.46 545.56,-1508.58"/>
<polygon fill="#000000" stroke="#000000" points="545.7,-1512.1 555.96,-1509.49 546.31,-1505.13 545.7,-1512.1"/>
</g>
<!-- proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node38" class="node">
<title>proc~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node38"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="656.5,-528 514.5,-528 514.5,-504 656.5,-504 656.5,-528"/>
<text text-anchor="middle" x="585.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- interface~check_particle_positions&#45;&gt;proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge49" class="edge">
<title>interface~check_particle_positions&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M415.59,-516C443.44,-516 475.63,-516 504.39,-516"/>
<polygon fill="#000000" stroke="#000000" points="504.41,-519.5 514.41,-516 504.41,-512.5 504.41,-519.5"/>
</g>
<!-- validate_position -->
<g id="interface~~perform_apm~~CallsGraph_node40" class="node">
<title>validate_position</title>
<polygon fill="#777777" stroke="#777777" points="637,-444 534,-444 534,-420 637,-420 637,-444"/>
<text text-anchor="middle" x="585.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position</text>
</g>
<!-- none~validate_position_final&#45;&gt;validate_position -->
<g id="interface~~perform_apm~~CallsGraph_edge50" class="edge">
<title>none~validate_position_final&#45;&gt;validate_position</title>
<path fill="none" stroke="#000000" d="M410.18,-432C445.53,-432 489.06,-432 523.78,-432"/>
<polygon fill="#000000" stroke="#000000" points="523.79,-435.5 533.79,-432 523.79,-428.5 523.79,-435.5"/>
</g>
<!-- none~dump_apm_pos&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge51" class="edge">
<title>none~dump_apm_pos&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M393,-1300.4C435.3,-1300.75 496.77,-1301.27 538.58,-1301.62"/>
<polygon fill="#000000" stroke="#000000" points="538.73,-1305.12 548.76,-1301.7 538.79,-1298.12 538.73,-1305.12"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge52" class="edge">
<title>none~discard_atmosphere&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M405.19,-1229.24C450.18,-1236.96 510.41,-1247.29 548.34,-1253.8"/>
<polygon fill="#000000" stroke="#000000" points="547.97,-1257.28 558.41,-1255.53 549.15,-1250.38 547.97,-1257.28"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge53" class="edge">
<title>none~discard_atmosphere&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M405.19,-1218.75C450.18,-1218.56 510.41,-1218.31 548.34,-1218.15"/>
<polygon fill="#000000" stroke="#000000" points="548.43,-1221.65 558.41,-1218.11 548.4,-1214.65 548.43,-1221.65"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge54" class="edge">
<title>none~discard_atmosphere&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M368.24,-1231.13C395.02,-1244.96 441.16,-1267.42 483,-1281 500.88,-1286.8 521.08,-1291.37 538.72,-1294.74"/>
<polygon fill="#000000" stroke="#000000" points="538.31,-1298.22 548.77,-1296.59 539.57,-1291.34 538.31,-1298.22"/>
</g>
<!-- indexx -->
<g id="interface~~perform_apm~~CallsGraph_node51" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-528 784.5,-528 784.5,-504 838.5,-504 838.5,-528"/>
<text text-anchor="middle" x="811.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="interface~~perform_apm~~CallsGraph_edge55" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M656.76,-516C695.72,-516 742.55,-516 774.21,-516"/>
<polygon fill="#000000" stroke="#000000" points="774.33,-519.5 784.33,-516 774.33,-512.5 774.33,-519.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge57" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M650.69,-990.04C690.7,-997.54 740.74,-1006.92 774.06,-1013.17"/>
<polygon fill="#000000" stroke="#000000" points="773.78,-1016.68 784.25,-1015.08 775.07,-1009.8 773.78,-1016.68"/>
</g>
<!-- interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node49" class="node">
<title>interface~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node49"><a xlink:href=".././interface/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="886.5,-948 736.5,-948 736.5,-924 886.5,-924 886.5,-948"/>
<text text-anchor="middle" x="811.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge56" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" d="M650.69,-965.96C677.4,-960.96 708.58,-955.11 736.27,-949.92"/>
<polygon fill="#000000" stroke="#000000" points="737.12,-953.32 746.3,-948.04 735.83,-946.44 737.12,-953.32"/>
</g>
<!-- interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node50" class="node">
<title>interface~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node50"><a xlink:href=".././interface/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="899,-990 724,-990 724,-966 899,-966 899,-990"/>
<text text-anchor="middle" x="811.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge58" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" d="M688.01,-978C696.49,-978 705.05,-978 713.49,-978"/>
<polygon fill="#000000" stroke="#000000" points="713.72,-981.5 723.72,-978 713.72,-974.5 713.72,-981.5"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge59" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M654.62,-1046.44C694.11,-1039.74 742.24,-1031.58 774.48,-1026.11"/>
<polygon fill="#000000" stroke="#000000" points="775.09,-1029.56 784.36,-1024.43 773.92,-1022.66 775.09,-1029.56"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge60" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M653.71,-1070C684.85,-1075.56 721.53,-1082.11 751.58,-1087.48"/>
<polygon fill="#000000" stroke="#000000" points="751.04,-1090.94 761.5,-1089.25 752.27,-1084.05 751.04,-1090.94"/>
</g>
<!-- proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node52" class="node">
<title>proc~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node52"><a xlink:href=".././proc/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1097.5,-948 947.5,-948 947.5,-924 1097.5,-924 1097.5,-948"/>
<text text-anchor="middle" x="1022.5" y="-933.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge61" class="edge">
<title>interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M886.77,-936C903.1,-936 920.5,-936 937.18,-936"/>
<polygon fill="#000000" stroke="#000000" points="937.47,-939.5 947.47,-936 937.47,-932.5 937.47,-939.5"/>
</g>
<!-- proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node53" class="node">
<title>proc~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node53"><a xlink:href=".././proc/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1110,-990 935,-990 935,-966 1110,-966 1110,-990"/>
<text text-anchor="middle" x="1022.5" y="-975.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge62" class="edge">
<title>interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M899.02,-978C907.49,-978 916.13,-978 924.7,-978"/>
<polygon fill="#000000" stroke="#000000" points="924.71,-981.5 934.71,-978 924.71,-974.5 924.71,-981.5"/>
</g>
</g>
</svg>
</div><script>var paninterfaceperform_apmCallsGraph = svgPanZoom('#interfaceperform_apmCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>
      <h2>public module module subroutine perform_apm(get_density, get_nstar_id, npart_output, pos_input, pvol, h_output, nu_output, center, com_star, mass, sizes, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, ghost_dist, use_atmosphere, remove_atmosphere, print_step, namefile_pos_id, namefile_pos, namefile_results, validate_position)   <a href='../proc/perform_apm.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
</h2>

    

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td colspan="7">
      <small><h5>function get_density(x, y, z) result(density)</h5><p>Returns the baryon mass density at the desired point</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>double precision</small></h6>  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
</small>
  </td> 
</tr>
<tr>
  <td colspan="7">
      <small><h5>subroutine get_nstar_id(npart, x, y, z, nstar_id)</h5><p>Computes the proper baryon number density at the particle positions</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong>(npart)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong>(npart)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(npart)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_id</strong>(npart)</td><td><p>Array to store the computed proper baryon number density</p>
<p>Array to store the computed proper baryon number density seen
 by the Eulerian observer</p></td>
</tr>
</tbody>
</table>

</small>
  </td> 
</tr>
<tr>
  <td><span class="anchor" id="variable-npart_output"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_output</strong></td><td><p>Initial particle number</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos_input"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pvol~2"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nu_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-center~3"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-com_star~3"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass~3"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sizes~2"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(6)</td><td>::</td>
  <td><strong>sizes</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-apm_max_it"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max_inc"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass_it"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-correct_nu~2"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_thres"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_des"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nx_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ny_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nz_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ghost_dist"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ghost_dist</strong></td><td><p>Distance between the ghost particles and the surface
 of the matter object considered (star, ejecta, etc...)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-use_atmosphere~2"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_atmosphere</strong></td><td><p>If .TRUE., allows particles to move where the density
 is 0, and displace them using only the smoothing term.
 This can be useful when the system has an irregular
 geometry, as, for example, an ejecta; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-remove_atmosphere"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>remove_atmosphere</strong></td><td><p>If .TRUE., removes the particles placed where the density is 0,
 at the end of the APM iteration; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-print_step"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>print_step</strong></td><td><p>Prints the particle positions to a formatted file every
 print_step steps</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos_id"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions
 and the ghost positions will be printed</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions
 and the ghost positions will be printed every 15 iterations</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_results"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related
 to the particle distribution, the baryon number particle and the
 kernel estimate of the density will be printed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-validate_position"></span>procedure(validate_position_int),</td>
<td></td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
</tr>
</tbody>
</table>

    <h3>Description</h3>
    <p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
    <br>

 </div>
</div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-05-19 14:49:15           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>