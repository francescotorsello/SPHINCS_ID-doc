
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>perform_apm &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.6</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>About</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>perform_apm
   <small>Interface</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.2% of total for procedures.">191 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/module_sph_particles.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/module_sph_particles.f90.html'>module_sph_particles.f90</a></li>
     <li><a href='../module/sph_particles.html'>sph_particles</a></li>
     <li class="active">perform_apm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<em>None</em>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>interface</h2>
      
      <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: interface~~perform_apm~~CallsGraph Pages: 1 -->
<svg id="interfaceperform_apmCallsGraph" width="641pt" height="854pt"
 viewBox="0.00 0.00 641.00 853.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="interface~~perform_apm~~CallsGraph" class="graph" transform="scale(1.74 1.74) rotate(0) translate(4 1485)">
<title>interface~~perform_apm~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1485 1114,-1485 1114,4 -4,4"/>
<!-- interface~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node1" class="node">
<title>interface~perform_apm</title>
<polygon fill="none" stroke="black" points="85,-730 0,-730 0,-706 85,-706 85,-730"/>
<text text-anchor="middle" x="42.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50">perform_apm</text>
</g>
<!-- proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_node2" class="node">
<title>proc~perform_apm</title>
<g id="a_interface~~perform_apm~~CallsGraph_node2"><a xlink:href=".././proc/perform_apm.html" xlink:title="perform_apm">
<polygon fill="#d9534f" stroke="#d9534f" points="206,-730 121,-730 121,-706 206,-706 206,-730"/>
<text text-anchor="middle" x="163.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">perform_apm</text>
</a>
</g>
</g>
<!-- interface~perform_apm&#45;&gt;proc~perform_apm -->
<g id="interface~~perform_apm~~CallsGraph_edge1" class="edge">
<title>interface~perform_apm&#45;&gt;proc~perform_apm</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M85.12,-718C93.32,-718 102.01,-718 110.5,-718"/>
<polygon fill="#000000" stroke="#000000" points="110.7,-721.5 120.7,-718 110.7,-714.5 110.7,-721.5"/>
</g>
<!-- density_loop -->
<g id="interface~~perform_apm~~CallsGraph_node3" class="node">
<title>density_loop</title>
<polygon fill="#777777" stroke="#777777" points="384,-1435 305,-1435 305,-1411 384,-1411 384,-1435"/>
<text text-anchor="middle" x="344.5" y="-1420.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density_loop</text>
</g>
<!-- proc~perform_apm&#45;&gt;density_loop -->
<g id="interface~~perform_apm~~CallsGraph_edge2" class="edge">
<title>proc~perform_apm&#45;&gt;density_loop</title>
<path fill="none" stroke="#000000" d="M165.07,-730.17C169.24,-817.33 196.25,-1344.51 242,-1397 255.12,-1412.05 275.65,-1418.98 294.82,-1421.98"/>
<polygon fill="#000000" stroke="#000000" points="294.62,-1425.48 304.98,-1423.24 295.49,-1418.53 294.62,-1425.48"/>
</g>
<!-- proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_node4" class="node">
<title>proc~spherical_from_cartesian</title>
<g id="a_interface~~perform_apm~~CallsGraph_node4"><a xlink:href=".././proc/spherical_from_cartesian.html" xlink:title="spherical_from_cartesian">
<polygon fill="#d9534f" stroke="#d9534f" points="658.5,-1481 512.5,-1481 512.5,-1457 658.5,-1457 658.5,-1481"/>
<text text-anchor="middle" x="585.5" y="-1466.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spherical_from_cartesian</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge3" class="edge">
<title>proc~perform_apm&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M165.1,-730.15C169.42,-814.91 196.74,-1315.75 242,-1364 305.4,-1431.58 367.76,-1353.96 447,-1402 469.2,-1415.46 460.94,-1434.31 483,-1448 489.15,-1451.82 495.87,-1454.95 502.84,-1457.53"/>
<polygon fill="#000000" stroke="#000000" points="501.86,-1460.89 512.45,-1460.7 504.05,-1454.24 501.86,-1460.89"/>
</g>
<!-- h -->
<g id="interface~~perform_apm~~CallsGraph_node5" class="node">
<title>h</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1187 558.5,-1187 558.5,-1163 612.5,-1163 612.5,-1187"/>
<text text-anchor="middle" x="585.5" y="-1172.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h</text>
</g>
<!-- proc~perform_apm&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge4" class="edge">
<title>proc~perform_apm&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M164.45,-730.32C164.47,-799.06 168.39,-1134.34 242,-1197 311.38,-1256.06 356.18,-1204.22 447,-1197 481.62,-1194.25 520.68,-1187.66 548.3,-1182.4"/>
<polygon fill="#000000" stroke="#000000" points="549.14,-1185.8 558.29,-1180.46 547.81,-1178.93 549.14,-1185.8"/>
</g>
<!-- timer -->
<g id="interface~~perform_apm~~CallsGraph_node6" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1108 317.5,-1108 317.5,-1084 371.5,-1084 371.5,-1108"/>
<text text-anchor="middle" x="344.5" y="-1093.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- proc~perform_apm&#45;&gt;timer -->
<g id="interface~~perform_apm~~CallsGraph_edge5" class="edge">
<title>proc~perform_apm&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M165.4,-730.23C169.85,-787.07 191.3,-1024.79 242,-1075 258.92,-1091.76 285.47,-1096.8 307.18,-1097.76"/>
<polygon fill="#000000" stroke="#000000" points="307.32,-1101.27 317.38,-1097.94 307.44,-1094.27 307.32,-1101.27"/>
</g>
<!-- nu -->
<g id="interface~~perform_apm~~CallsGraph_node7" class="node">
<title>nu</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1145 558.5,-1145 558.5,-1121 612.5,-1121 612.5,-1145"/>
<text text-anchor="middle" x="585.5" y="-1130.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu</text>
</g>
<!-- proc~perform_apm&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge6" class="edge">
<title>proc~perform_apm&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M164.93,-730.18C167.34,-791.41 181.41,-1064.62 242,-1117 286.84,-1155.76 469.16,-1143.9 547.95,-1136.72"/>
<polygon fill="#000000" stroke="#000000" points="548.72,-1140.16 558.35,-1135.74 548.07,-1133.19 548.72,-1140.16"/>
</g>
<!-- density -->
<g id="interface~~perform_apm~~CallsGraph_node8" class="node">
<title>density</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-1066 317.5,-1066 317.5,-1042 371.5,-1042 371.5,-1066"/>
<text text-anchor="middle" x="344.5" y="-1051.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">density</text>
</g>
<!-- proc~perform_apm&#45;&gt;density -->
<g id="interface~~perform_apm~~CallsGraph_edge7" class="edge">
<title>proc~perform_apm&#45;&gt;density</title>
<path fill="none" stroke="#000000" d="M165.78,-730.18C171.53,-782.74 196.78,-989.43 242,-1033 259.04,-1049.42 285.35,-1054.51 306.91,-1055.58"/>
<polygon fill="#000000" stroke="#000000" points="306.98,-1059.08 317.06,-1055.81 307.14,-1052.08 306.98,-1059.08"/>
</g>
<!-- allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node9" class="node">
<title>allocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="431,-1024 258,-1024 258,-1000 431,-1000 431,-1024"/>
<text text-anchor="middle" x="344.5" y="-1009.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge8" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M163.9,-730.01C162.46,-772.66 163.71,-918.19 242,-991 244.22,-993.07 246.6,-994.95 249.09,-996.67"/>
<polygon fill="#000000" stroke="#000000" points="247.57,-999.85 257.97,-1001.9 251.13,-993.81 247.57,-999.85"/>
</g>
<!-- deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node10" class="node">
<title>deallocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="433.5,-982 255.5,-982 255.5,-958 433.5,-958 433.5,-982"/>
<text text-anchor="middle" x="344.5" y="-967.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge9" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M164.61,-730.03C165.66,-768.43 174.43,-889.07 242,-949 243.51,-950.34 245.09,-951.61 246.72,-952.8"/>
<polygon fill="#000000" stroke="#000000" points="244.97,-955.83 255.3,-958.17 248.68,-949.9 244.97,-955.83"/>
</g>
<!-- none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_node11" class="node">
<title>none~discard_atmosphere</title>
<polygon fill="#d9534f" stroke="#d9534f" points="405,-1188 284,-1188 284,-1164 405,-1164 405,-1188"/>
<text text-anchor="middle" x="344.5" y="-1173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">discard_atmosphere</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~discard_atmosphere -->
<g id="interface~~perform_apm~~CallsGraph_edge10" class="edge">
<title>proc~perform_apm&#45;&gt;none~discard_atmosphere</title>
<path fill="none" stroke="#000000" d="M164.96,-730.09C167.59,-793.41 182.87,-1086.37 242,-1150 250.6,-1159.25 262,-1165.4 274.05,-1169.44"/>
<polygon fill="#000000" stroke="#000000" points="273.24,-1172.85 283.81,-1172.25 275.17,-1166.12 273.24,-1172.85"/>
</g>
<!-- none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_node12" class="node">
<title>none~dump_apm_pos</title>
<polygon fill="#d9534f" stroke="#d9534f" points="393,-1268 296,-1268 296,-1244 393,-1244 393,-1268"/>
<text text-anchor="middle" x="344.5" y="-1253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dump_apm_pos</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~dump_apm_pos -->
<g id="interface~~perform_apm~~CallsGraph_edge11" class="edge">
<title>proc~perform_apm&#45;&gt;none~dump_apm_pos</title>
<path fill="none" stroke="#000000" d="M164.59,-730.4C165.36,-801.14 172.66,-1153.31 242,-1230 253.27,-1242.46 269.61,-1249.31 285.9,-1252.98"/>
<polygon fill="#000000" stroke="#000000" points="285.52,-1256.47 295.99,-1254.88 286.81,-1249.59 285.52,-1256.47"/>
</g>
<!-- exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_node13" class="node">
<title>exact_nei_tree_update</title>
<polygon fill="#777777" stroke="#777777" points="410.5,-940 278.5,-940 278.5,-916 410.5,-916 410.5,-940"/>
<text text-anchor="middle" x="344.5" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">exact_nei_tree_update</text>
</g>
<!-- proc~perform_apm&#45;&gt;exact_nei_tree_update -->
<g id="interface~~perform_apm~~CallsGraph_edge12" class="edge">
<title>proc~perform_apm&#45;&gt;exact_nei_tree_update</title>
<path fill="none" stroke="#000000" d="M165.67,-730.47C169.55,-764.56 185.24,-859.88 242,-907 249.74,-913.42 258.93,-918.04 268.58,-921.34"/>
<polygon fill="#000000" stroke="#000000" points="267.76,-924.75 278.34,-924.21 269.74,-918.03 267.76,-924.75"/>
</g>
<!-- ncand -->
<g id="interface~~perform_apm~~CallsGraph_node14" class="node">
<title>ncand</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-898 317.5,-898 317.5,-874 371.5,-874 371.5,-898"/>
<text text-anchor="middle" x="344.5" y="-883.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ncand</text>
</g>
<!-- proc~perform_apm&#45;&gt;ncand -->
<g id="interface~~perform_apm~~CallsGraph_edge13" class="edge">
<title>proc~perform_apm&#45;&gt;ncand</title>
<path fill="none" stroke="#000000" d="M167.17,-730.19C174.1,-758.7 195.42,-829.97 242,-865 260.58,-878.97 286.25,-884.19 307.13,-885.93"/>
<polygon fill="#000000" stroke="#000000" points="307.05,-889.43 317.24,-886.54 307.47,-882.45 307.05,-889.43"/>
</g>
<!-- allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node15" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="409.5,-856 279.5,-856 279.5,-832 409.5,-832 409.5,-856"/>
<text text-anchor="middle" x="344.5" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge14" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M169.74,-730.01C180.09,-752.21 205.36,-799.54 242,-823 250.35,-828.35 259.82,-832.37 269.52,-835.38"/>
<polygon fill="#000000" stroke="#000000" points="268.71,-838.79 279.28,-838.07 270.57,-832.04 268.71,-838.79"/>
</g>
<!-- none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_node16" class="node">
<title>none~allocate_apm_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="403.5,-814 285.5,-814 285.5,-790 403.5,-790 403.5,-814"/>
<text text-anchor="middle" x="344.5" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_apm_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~allocate_apm_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge15" class="edge">
<title>proc~perform_apm&#45;&gt;none~allocate_apm_fields</title>
<path fill="none" stroke="#000000" d="M175.6,-730.02C189.63,-744.45 215.22,-768.28 242,-781 252.37,-785.92 263.88,-789.7 275.31,-792.59"/>
<polygon fill="#000000" stroke="#000000" points="274.78,-796.06 285.31,-794.91 276.36,-789.24 274.78,-796.06"/>
</g>
<!-- allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_node17" class="node">
<title>allocate_metric_on_particles</title>
<polygon fill="#777777" stroke="#777777" points="427,-772 262,-772 262,-748 427,-748 427,-772"/>
<text text-anchor="middle" x="344.5" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_metric_on_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_metric_on_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge16" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_metric_on_particles</title>
<path fill="none" stroke="#000000" d="M206.21,-729.8C217.77,-732.93 230.34,-736.22 242,-739 251.88,-741.36 262.34,-743.7 272.64,-745.91"/>
<polygon fill="#000000" stroke="#000000" points="271.94,-749.34 282.45,-747.99 273.39,-742.49 271.94,-749.34"/>
</g>
<!-- allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node18" class="node">
<title>allocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="397.5,-730 291.5,-730 291.5,-706 397.5,-706 397.5,-730"/>
<text text-anchor="middle" x="344.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;allocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge17" class="edge">
<title>proc~perform_apm&#45;&gt;allocate_gradient</title>
<path fill="none" stroke="#000000" d="M206.02,-718C228.35,-718 256.33,-718 281.22,-718"/>
<polygon fill="#000000" stroke="#000000" points="281.3,-721.5 291.3,-718 281.3,-714.5 281.3,-721.5"/>
</g>
<!-- interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node19" class="node">
<title>interface~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node19"><a xlink:href=".././interface/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#a7506f" stroke="#a7506f" points="413.5,-608 275.5,-608 275.5,-584 413.5,-584 413.5,-608"/>
<text text-anchor="middle" x="344.5" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge18" class="edge">
<title>proc~perform_apm&#45;&gt;interface~correct_center_of_mass</title>
<path fill="none" stroke="#000000" d="M170.83,-705.89C182.21,-685.34 208.12,-643.77 242,-622 249.34,-617.28 257.49,-613.42 265.89,-610.26"/>
<polygon fill="#000000" stroke="#000000" points="267.13,-613.54 275.45,-606.98 264.86,-606.92 267.13,-613.54"/>
</g>
<!-- none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_node20" class="node">
<title>none~validate_position_final</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="410,-486 279,-486 279,-462 410,-462 410,-486"/>
<text text-anchor="middle" x="344.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position_final</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~validate_position_final -->
<g id="interface~~perform_apm~~CallsGraph_edge19" class="edge">
<title>proc~perform_apm&#45;&gt;none~validate_position_final</title>
<path fill="none" stroke="#000000" d="M165.01,-705.98C167.23,-669.24 179.12,-557.42 242,-500 249.79,-492.89 259.25,-487.67 269.24,-483.84"/>
<polygon fill="#000000" stroke="#000000" points="270.57,-487.09 278.93,-480.58 268.34,-480.45 270.57,-487.09"/>
</g>
<!-- nic -->
<g id="interface~~perform_apm~~CallsGraph_node21" class="node">
<title>nic</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-444 317.5,-444 317.5,-420 371.5,-420 371.5,-444"/>
<text text-anchor="middle" x="344.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nic</text>
</g>
<!-- proc~perform_apm&#45;&gt;nic -->
<g id="interface~~perform_apm~~CallsGraph_edge20" class="edge">
<title>proc~perform_apm&#45;&gt;nic</title>
<path fill="none" stroke="#000000" d="M164.01,-705.75C163.05,-663.6 165.9,-523.21 242,-453 259.39,-436.96 285.69,-431.85 307.16,-430.68"/>
<polygon fill="#000000" stroke="#000000" points="307.36,-434.18 317.26,-430.4 307.16,-427.18 307.36,-434.18"/>
</g>
<!-- assign_h -->
<g id="interface~~perform_apm~~CallsGraph_node22" class="node">
<title>assign_h</title>
<polygon fill="#777777" stroke="#777777" points="373.5,-402 315.5,-402 315.5,-378 373.5,-378 373.5,-402"/>
<text text-anchor="middle" x="344.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">assign_h</text>
</g>
<!-- proc~perform_apm&#45;&gt;assign_h -->
<g id="interface~~perform_apm~~CallsGraph_edge21" class="edge">
<title>proc~perform_apm&#45;&gt;assign_h</title>
<path fill="none" stroke="#000000" d="M165.87,-705.78C171.9,-653.98 197.83,-453.3 242,-411 258.64,-395.06 284.03,-389.82 305.25,-388.55"/>
<polygon fill="#000000" stroke="#000000" points="305.4,-392.05 315.28,-388.22 305.17,-385.05 305.4,-392.05"/>
</g>
<!-- none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_node23" class="node">
<title>none~reallocate_output_fields</title>
<polygon fill="#d9534f" stroke="#d9534f" points="414,-1311 275,-1311 275,-1287 414,-1287 414,-1311"/>
<text text-anchor="middle" x="344.5" y="-1296.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reallocate_output_fields</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~reallocate_output_fields -->
<g id="interface~~perform_apm~~CallsGraph_edge22" class="edge">
<title>proc~perform_apm&#45;&gt;none~reallocate_output_fields</title>
<path fill="none" stroke="#000000" d="M164.38,-730.09C163.87,-803.96 164.9,-1193.83 242,-1277 248.44,-1283.94 256.5,-1288.96 265.26,-1292.56"/>
<polygon fill="#000000" stroke="#000000" points="264.39,-1295.96 274.99,-1295.92 266.68,-1289.35 264.39,-1295.96"/>
</g>
<!-- proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_node24" class="node">
<title>proc~find_h_backup</title>
<g id="a_interface~~perform_apm~~CallsGraph_node24"><a xlink:href=".././proc/find_h_backup.html" xlink:title="find_h_backup">
<polygon fill="#d94e8f" stroke="#d94e8f" points="389,-360 300,-360 300,-336 389,-336 389,-360"/>
<text text-anchor="middle" x="344.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_h_backup</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~find_h_backup -->
<g id="interface~~perform_apm~~CallsGraph_edge23" class="edge">
<title>proc~perform_apm&#45;&gt;proc~find_h_backup</title>
<path fill="none" stroke="#000000" d="M165.48,-705.67C170.19,-649.43 192.38,-417.91 242,-369 254.64,-356.54 272.61,-350.56 289.93,-347.93"/>
<polygon fill="#000000" stroke="#000000" points="290.48,-351.38 300,-346.73 289.66,-344.43 290.48,-351.38"/>
</g>
<!-- deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_node25" class="node">
<title>deallocate_rcb_tree_memory_3d</title>
<polygon fill="#777777" stroke="#777777" points="438,-318 251,-318 251,-294 438,-294 438,-318"/>
<text text-anchor="middle" x="344.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_rcb_tree_memory_3d</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d -->
<g id="interface~~perform_apm~~CallsGraph_edge24" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_rcb_tree_memory_3d</title>
<path fill="none" stroke="#000000" d="M165.15,-705.84C168.61,-645.9 186.81,-382.65 242,-327 242.96,-326.03 243.96,-325.1 244.98,-324.2"/>
<polygon fill="#000000" stroke="#000000" points="247.36,-326.8 253.36,-318.07 243.23,-321.15 247.36,-326.8"/>
</g>
<!-- deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_node26" class="node">
<title>deallocate_gradient</title>
<polygon fill="#777777" stroke="#777777" points="404,-276 285,-276 285,-252 404,-252 404,-276"/>
<text text-anchor="middle" x="344.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_gradient</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_gradient -->
<g id="interface~~perform_apm~~CallsGraph_edge25" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_gradient</title>
<path fill="none" stroke="#000000" d="M164.9,-705.83C167.24,-642.11 181.27,-347.38 242,-285 250.86,-275.89 262.56,-270.21 274.86,-266.76"/>
<polygon fill="#000000" stroke="#000000" points="275.85,-270.12 284.8,-264.45 274.27,-263.31 275.85,-270.12"/>
</g>
<!-- lpart -->
<g id="interface~~perform_apm~~CallsGraph_node27" class="node">
<title>lpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-234 317.5,-234 317.5,-210 371.5,-210 371.5,-234"/>
<text text-anchor="middle" x="344.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">lpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;lpart -->
<g id="interface~~perform_apm~~CallsGraph_edge26" class="edge">
<title>proc~perform_apm&#45;&gt;lpart</title>
<path fill="none" stroke="#000000" d="M164.7,-705.57C166.02,-637.66 175.8,-312.06 242,-243 258.48,-225.81 285.05,-220.78 306.87,-219.93"/>
<polygon fill="#000000" stroke="#000000" points="307.17,-223.43 317.13,-219.82 307.09,-216.43 307.17,-223.43"/>
</g>
<!-- interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node28" class="node">
<title>interface~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node28"><a xlink:href=".././interface/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#a7506f" stroke="#a7506f" points="415.5,-192 273.5,-192 273.5,-168 415.5,-168 415.5,-192"/>
<text text-anchor="middle" x="344.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge27" class="edge">
<title>proc~perform_apm&#45;&gt;interface~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M164.51,-705.89C164.85,-635.27 170.11,-276.98 242,-201 248.11,-194.54 255.64,-189.79 263.82,-186.34"/>
<polygon fill="#000000" stroke="#000000" points="265.04,-189.62 273.29,-182.96 262.69,-183.03 265.04,-189.62"/>
</g>
<!-- none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_node29" class="node">
<title>none~place_and_print_ghost_particles</title>
<polygon fill="#d9534f" stroke="#d9534f" points="436,-1355 253,-1355 253,-1331 436,-1331 436,-1355"/>
<text text-anchor="middle" x="344.5" y="-1340.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">place_and_print_ghost_particles</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles -->
<g id="interface~~perform_apm~~CallsGraph_edge28" class="edge">
<title>proc~perform_apm&#45;&gt;none~place_and_print_ghost_particles</title>
<path fill="none" stroke="#000000" d="M164.25,-730.5C162.93,-808.63 159.76,-1229.57 242,-1320 243.58,-1321.74 245.26,-1323.36 247.03,-1324.87"/>
<polygon fill="#000000" stroke="#000000" points="245.13,-1327.82 255.3,-1330.81 249.22,-1322.13 245.13,-1327.82"/>
</g>
<!-- iorig -->
<g id="interface~~perform_apm~~CallsGraph_node30" class="node">
<title>iorig</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-150 317.5,-150 317.5,-126 371.5,-126 371.5,-150"/>
<text text-anchor="middle" x="344.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iorig</text>
</g>
<!-- proc~perform_apm&#45;&gt;iorig -->
<g id="interface~~perform_apm~~CallsGraph_edge29" class="edge">
<title>proc~perform_apm&#45;&gt;iorig</title>
<path fill="none" stroke="#000000" d="M164.36,-705.9C163.79,-631.97 164.51,-241.8 242,-159 258.45,-141.42 285.44,-136.48 307.45,-135.77"/>
<polygon fill="#000000" stroke="#000000" points="307.49,-139.27 317.47,-135.72 307.45,-132.27 307.49,-139.27"/>
</g>
<!-- deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_node31" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="416,-108 273,-108 273,-84 416,-84 416,-108"/>
<text text-anchor="middle" x="344.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_sph_memory</text>
</g>
<!-- proc~perform_apm&#45;&gt;deallocate_sph_memory -->
<g id="interface~~perform_apm~~CallsGraph_edge30" class="edge">
<title>proc~perform_apm&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M164.23,-705.5C162.79,-627.38 159.04,-206.5 242,-117 247.93,-110.6 255.27,-105.87 263.25,-102.41"/>
<polygon fill="#000000" stroke="#000000" points="264.68,-105.61 272.88,-98.9 262.29,-99.03 264.68,-105.61"/>
</g>
<!-- rpart -->
<g id="interface~~perform_apm~~CallsGraph_node32" class="node">
<title>rpart</title>
<polygon fill="#777777" stroke="#777777" points="371.5,-66 317.5,-66 317.5,-42 371.5,-42 371.5,-66"/>
<text text-anchor="middle" x="344.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rpart</text>
</g>
<!-- proc~perform_apm&#45;&gt;rpart -->
<g id="interface~~perform_apm~~CallsGraph_edge31" class="edge">
<title>proc~perform_apm&#45;&gt;rpart</title>
<path fill="none" stroke="#000000" d="M165.12,-705.91C169.54,-621.62 197.44,-123.48 242,-75 258.3,-57.27 285.29,-52.34 307.34,-51.67"/>
<polygon fill="#000000" stroke="#000000" points="307.4,-55.17 317.38,-51.64 307.37,-48.17 307.4,-55.17"/>
</g>
<!-- position_correction -->
<g id="interface~~perform_apm~~CallsGraph_node33" class="node">
<title>position_correction</title>
<polygon fill="#777777" stroke="#777777" points="401,-24 288,-24 288,0 401,0 401,-24"/>
<text text-anchor="middle" x="344.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">position_correction</text>
</g>
<!-- proc~perform_apm&#45;&gt;position_correction -->
<g id="interface~~perform_apm~~CallsGraph_edge32" class="edge">
<title>proc~perform_apm&#45;&gt;position_correction</title>
<path fill="none" stroke="#000000" d="M165.02,-705.98C168.92,-618.75 194.6,-84.94 242,-33 251.37,-22.73 264.33,-16.75 277.85,-13.4"/>
<polygon fill="#000000" stroke="#000000" points="278.65,-16.81 287.76,-11.4 277.27,-9.95 278.65,-16.81"/>
</g>
<!-- com -->
<g id="interface~~perform_apm~~CallsGraph_node34" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-646 784.5,-646 784.5,-622 838.5,-622 838.5,-646"/>
<text text-anchor="middle" x="811.5" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">com</text>
</g>
<!-- proc~perform_apm&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge33" class="edge">
<title>proc~perform_apm&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M174.8,-705.76C188.4,-690.62 213.92,-665.56 242,-655 339.85,-618.2 664.64,-627.9 774.11,-632.36"/>
<polygon fill="#000000" stroke="#000000" points="774.18,-635.87 784.32,-632.79 774.47,-628.87 774.18,-635.87"/>
</g>
<!-- proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_node35" class="node">
<title>proc~is_finite_number</title>
<g id="a_interface~~perform_apm~~CallsGraph_node35"><a xlink:href=".././proc/is_finite_number.html" xlink:title="is_finite_number">
<polygon fill="#d94e8f" stroke="#d94e8f" points="861.5,-568 761.5,-568 761.5,-544 861.5,-544 861.5,-568"/>
<text text-anchor="middle" x="811.5" y="-553.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_finite_number</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge34" class="edge">
<title>proc~perform_apm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M165.64,-705.64C169.47,-671.89 185.01,-577.71 242,-533 284.66,-499.53 428.95,-499.24 483,-495 573.83,-487.88 599.31,-474.14 688,-495 723.48,-503.34 760.42,-523.59 784.34,-538.48"/>
<polygon fill="#000000" stroke="#000000" points="782.52,-541.47 792.84,-543.89 786.28,-535.57 782.52,-541.47"/>
</g>
<!-- none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_node36" class="node">
<title>none~get_nstar_id_atm</title>
<polygon fill="#d9534f" stroke="#d9534f" points="396,-566 293,-566 293,-542 396,-542 396,-566"/>
<text text-anchor="middle" x="344.5" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id_atm</text>
</g>
<!-- proc~perform_apm&#45;&gt;none~get_nstar_id_atm -->
<g id="interface~~perform_apm~~CallsGraph_edge35" class="edge">
<title>proc~perform_apm&#45;&gt;none~get_nstar_id_atm</title>
<path fill="none" stroke="#000000" d="M167.39,-705.72C174.65,-677.7 196.44,-608.85 242,-575 253.85,-566.19 268.54,-560.87 283.02,-557.71"/>
<polygon fill="#000000" stroke="#000000" points="283.79,-561.13 292.97,-555.85 282.5,-554.25 283.79,-561.13"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node37" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node37"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="447,-688 242,-688 242,-664 447,-664 447,-688"/>
<text text-anchor="middle" x="344.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge36" class="edge">
<title>proc~perform_apm&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M206.21,-706.2C217.77,-703.07 230.34,-699.78 242,-697 251.88,-694.64 262.34,-692.3 272.64,-690.09"/>
<polygon fill="#000000" stroke="#000000" points="273.39,-693.51 282.45,-688.01 271.94,-686.66 273.39,-693.51"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;h -->
<g id="interface~~perform_apm~~CallsGraph_edge37" class="edge">
<title>none~discard_atmosphere&#45;&gt;h</title>
<path fill="none" stroke="#000000" d="M405.19,-1175.75C450.18,-1175.56 510.41,-1175.31 548.34,-1175.15"/>
<polygon fill="#000000" stroke="#000000" points="548.43,-1178.65 558.41,-1175.11 548.4,-1171.65 548.43,-1178.65"/>
</g>
<!-- none~discard_atmosphere&#45;&gt;nu -->
<g id="interface~~perform_apm~~CallsGraph_edge39" class="edge">
<title>none~discard_atmosphere&#45;&gt;nu</title>
<path fill="none" stroke="#000000" d="M405.19,-1165.26C450.18,-1157.17 510.41,-1146.33 548.34,-1139.51"/>
<polygon fill="#000000" stroke="#000000" points="549.19,-1142.91 558.41,-1137.69 547.95,-1136.02 549.19,-1142.91"/>
</g>
<!-- get_density -->
<g id="interface~~perform_apm~~CallsGraph_node47" class="node">
<title>get_density</title>
<polygon fill="#777777" stroke="#777777" points="622,-1229 549,-1229 549,-1205 622,-1205 622,-1229"/>
<text text-anchor="middle" x="585.5" y="-1214.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_density</text>
</g>
<!-- none~discard_atmosphere&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge38" class="edge">
<title>none~discard_atmosphere&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M405.19,-1186.24C446.52,-1193.33 500.7,-1202.62 538.65,-1209.13"/>
<polygon fill="#000000" stroke="#000000" points="538.45,-1212.65 548.9,-1210.89 539.63,-1205.75 538.45,-1212.65"/>
</g>
<!-- none~dump_apm_pos&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge40" class="edge">
<title>none~dump_apm_pos&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M393,-1248.25C435.39,-1241.33 497.03,-1231.27 538.84,-1224.45"/>
<polygon fill="#000000" stroke="#000000" points="539.45,-1227.9 548.76,-1222.83 538.32,-1220.99 539.45,-1227.9"/>
</g>
<!-- proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_node43" class="node">
<title>proc~correct_center_of_mass</title>
<g id="a_interface~~perform_apm~~CallsGraph_node43"><a xlink:href=".././proc/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#d9534f" stroke="#d9534f" points="654.5,-608 516.5,-608 516.5,-584 654.5,-584 654.5,-608"/>
<text text-anchor="middle" x="585.5" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass -->
<g id="interface~~perform_apm~~CallsGraph_edge41" class="edge">
<title>interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M413.67,-596C442.42,-596 476.08,-596 505.88,-596"/>
<polygon fill="#000000" stroke="#000000" points="506.24,-599.5 516.24,-596 506.24,-592.5 506.24,-599.5"/>
</g>
<!-- validate_position -->
<g id="interface~~perform_apm~~CallsGraph_node42" class="node">
<title>validate_position</title>
<polygon fill="#777777" stroke="#777777" points="637,-448 534,-448 534,-424 637,-424 637,-448"/>
<text text-anchor="middle" x="585.5" y="-433.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">validate_position</text>
</g>
<!-- none~validate_position_final&#45;&gt;validate_position -->
<g id="interface~~perform_apm~~CallsGraph_edge42" class="edge">
<title>none~validate_position_final&#45;&gt;validate_position</title>
<path fill="none" stroke="#000000" d="M410.18,-463.72C445.53,-458.1 489.06,-451.17 523.78,-445.65"/>
<polygon fill="#000000" stroke="#000000" points="524.46,-449.09 533.79,-444.06 523.36,-442.18 524.46,-449.09"/>
</g>
<!-- pos_input -->
<g id="interface~~perform_apm~~CallsGraph_node41" class="node">
<title>pos_input</title>
<polygon fill="#777777" stroke="#777777" points="617.5,-1355 553.5,-1355 553.5,-1331 617.5,-1331 617.5,-1355"/>
<text text-anchor="middle" x="585.5" y="-1340.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">pos_input</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge43" class="edge">
<title>none~reallocate_output_fields&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M410.81,-1311.02C453.07,-1318.8 506.82,-1328.7 543.25,-1335.41"/>
<polygon fill="#000000" stroke="#000000" points="543.03,-1338.92 553.5,-1337.29 544.3,-1332.04 543.03,-1338.92"/>
</g>
<!-- h_output -->
<g id="interface~~perform_apm~~CallsGraph_node45" class="node">
<title>h_output</title>
<polygon fill="#777777" stroke="#777777" points="615,-1271 556,-1271 556,-1247 615,-1247 615,-1271"/>
<text text-anchor="middle" x="585.5" y="-1256.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">h_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;h_output -->
<g id="interface~~perform_apm~~CallsGraph_edge45" class="edge">
<title>none~reallocate_output_fields&#45;&gt;h_output</title>
<path fill="none" stroke="#000000" d="M414.31,-1287.48C457.11,-1280.32 510.56,-1271.38 546.02,-1265.44"/>
<polygon fill="#000000" stroke="#000000" points="546.68,-1268.88 555.96,-1263.78 545.52,-1261.97 546.68,-1268.88"/>
</g>
<!-- nu_output -->
<g id="interface~~perform_apm~~CallsGraph_node46" class="node">
<title>nu_output</title>
<polygon fill="#777777" stroke="#777777" points="618.5,-1313 552.5,-1313 552.5,-1289 618.5,-1289 618.5,-1313"/>
<text text-anchor="middle" x="585.5" y="-1298.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">nu_output</text>
</g>
<!-- none~reallocate_output_fields&#45;&gt;nu_output -->
<g id="interface~~perform_apm~~CallsGraph_edge44" class="edge">
<title>none~reallocate_output_fields&#45;&gt;nu_output</title>
<path fill="none" stroke="#000000" d="M414.31,-1299.58C455.42,-1299.92 506.37,-1300.35 541.75,-1300.64"/>
<polygon fill="#000000" stroke="#000000" points="542.17,-1304.15 552.2,-1300.73 542.23,-1297.15 542.17,-1304.15"/>
</g>
<!-- proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_node48" class="node">
<title>proc~check_particle_positions</title>
<g id="a_interface~~perform_apm~~CallsGraph_node48"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="656.5,-192 514.5,-192 514.5,-168 656.5,-168 656.5,-192"/>
<text text-anchor="middle" x="585.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- interface~check_particle_positions&#45;&gt;proc~check_particle_positions -->
<g id="interface~~perform_apm~~CallsGraph_edge46" class="edge">
<title>interface~check_particle_positions&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M415.59,-180C443.44,-180 475.63,-180 504.39,-180"/>
<polygon fill="#000000" stroke="#000000" points="504.41,-183.5 514.41,-180 504.41,-176.5 504.41,-183.5"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian -->
<g id="interface~~perform_apm~~CallsGraph_edge49" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M423.35,-1355.07C431.9,-1358.61 440.03,-1363.16 447,-1369 476.59,-1393.77 452.84,-1423.93 483,-1448 488.9,-1452.71 495.59,-1456.44 502.65,-1459.38"/>
<polygon fill="#000000" stroke="#000000" points="501.88,-1462.82 512.48,-1462.93 504.26,-1456.24 501.88,-1462.82"/>
</g>
<!-- center -->
<g id="interface~~perform_apm~~CallsGraph_node38" class="node">
<title>center</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1397 558.5,-1397 558.5,-1373 612.5,-1373 612.5,-1397"/>
<text text-anchor="middle" x="585.5" y="-1382.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">center</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;center -->
<g id="interface~~perform_apm~~CallsGraph_edge47" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;center</title>
<path fill="none" stroke="#000000" d="M413.99,-1355.04C457.8,-1362.74 512.88,-1372.41 548.38,-1378.65"/>
<polygon fill="#000000" stroke="#000000" points="547.84,-1382.11 558.3,-1380.4 549.05,-1375.22 547.84,-1382.11"/>
</g>
<!-- sizes -->
<g id="interface~~perform_apm~~CallsGraph_node39" class="node">
<title>sizes</title>
<polygon fill="#777777" stroke="#777777" points="612.5,-1439 558.5,-1439 558.5,-1415 612.5,-1415 612.5,-1439"/>
<text text-anchor="middle" x="585.5" y="-1424.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sizes</text>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;sizes -->
<g id="interface~~perform_apm~~CallsGraph_edge48" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;sizes</title>
<path fill="none" stroke="#000000" d="M413.87,-1355.01C425.37,-1358.55 436.85,-1363.12 447,-1369 466.85,-1380.5 462.88,-1394.97 483,-1406 503.02,-1416.98 528.13,-1422.23 548.36,-1424.74"/>
<polygon fill="#000000" stroke="#000000" points="548.13,-1428.24 558.45,-1425.82 548.88,-1421.27 548.13,-1428.24"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;pos_input -->
<g id="interface~~perform_apm~~CallsGraph_edge50" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;pos_input</title>
<path fill="none" stroke="#000000" d="M436.2,-1343C473.01,-1343 513.7,-1343 543.13,-1343"/>
<polygon fill="#000000" stroke="#000000" points="543.44,-1346.5 553.44,-1343 543.44,-1339.5 543.44,-1346.5"/>
</g>
<!-- none~place_and_print_ghost_particles&#45;&gt;get_density -->
<g id="interface~~perform_apm~~CallsGraph_edge51" class="edge">
<title>none~place_and_print_ghost_particles&#45;&gt;get_density</title>
<path fill="none" stroke="#000000" d="M429.43,-1330.88C435.74,-1327.95 441.7,-1324.37 447,-1320 477.7,-1294.67 452.07,-1263.04 483,-1238 498.53,-1225.43 519.68,-1219.81 538.66,-1217.48"/>
<polygon fill="#000000" stroke="#000000" points="539.02,-1220.96 548.64,-1216.52 538.35,-1213.99 539.02,-1220.96"/>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge53" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M396.15,-554.22C482.82,-554.59 659.12,-555.35 751.31,-555.75"/>
<polygon fill="#000000" stroke="#000000" points="751.3,-559.25 761.32,-555.79 751.33,-552.25 751.3,-559.25"/>
</g>
<!-- get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_node44" class="node">
<title>get_nstar_id</title>
<polygon fill="#777777" stroke="#777777" points="624,-528 547,-528 547,-504 624,-504 624,-528"/>
<text text-anchor="middle" x="585.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">get_nstar_id</text>
</g>
<!-- none~get_nstar_id_atm&#45;&gt;get_nstar_id -->
<g id="interface~~perform_apm~~CallsGraph_edge52" class="edge">
<title>none~get_nstar_id_atm&#45;&gt;get_nstar_id</title>
<path fill="none" stroke="#000000" d="M396.19,-545.94C437.74,-539.33 496.15,-530.05 536.86,-523.58"/>
<polygon fill="#000000" stroke="#000000" points="537.48,-527.02 546.8,-521.99 536.38,-520.11 537.48,-527.02"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_node40" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_interface~~perform_apm~~CallsGraph_node40"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="688,-688 483,-688 483,-664 688,-664 688,-688"/>
<text text-anchor="middle" x="585.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="interface~~perform_apm~~CallsGraph_edge54" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M447.2,-676C455.7,-676 464.31,-676 472.87,-676"/>
<polygon fill="#000000" stroke="#000000" points="472.89,-679.5 482.89,-676 472.89,-672.5 472.89,-679.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge55" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M650.69,-663.96C690.7,-656.46 740.74,-647.08 774.06,-640.83"/>
<polygon fill="#000000" stroke="#000000" points="775.07,-644.2 784.25,-638.92 773.78,-637.32 775.07,-644.2"/>
</g>
<!-- interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node50" class="node">
<title>interface~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node50"><a xlink:href=".././interface/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="899,-730 724,-730 724,-706 899,-706 899,-730"/>
<text text-anchor="middle" x="811.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge56" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" d="M650.69,-688.04C677.4,-693.04 708.58,-698.89 736.27,-704.08"/>
<polygon fill="#000000" stroke="#000000" points="735.83,-707.56 746.3,-705.96 737.12,-700.68 735.83,-707.56"/>
</g>
<!-- interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node51" class="node">
<title>interface~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node51"><a xlink:href=".././interface/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="886.5,-688 736.5,-688 736.5,-664 886.5,-664 886.5,-688"/>
<text text-anchor="middle" x="811.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge57" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" d="M688.01,-676C700.77,-676 713.7,-676 726.15,-676"/>
<polygon fill="#000000" stroke="#000000" points="726.47,-679.5 736.47,-676 726.47,-672.5 726.47,-679.5"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;com -->
<g id="interface~~perform_apm~~CallsGraph_edge58" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M654.62,-607.56C694.11,-614.26 742.24,-622.42 774.48,-627.89"/>
<polygon fill="#000000" stroke="#000000" points="773.92,-631.34 784.36,-629.57 775.09,-624.44 773.92,-631.34"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;proc~is_finite_number -->
<g id="interface~~perform_apm~~CallsGraph_edge59" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M653.71,-584C684.85,-578.44 721.53,-571.89 751.58,-566.52"/>
<polygon fill="#000000" stroke="#000000" points="752.27,-569.95 761.5,-564.75 751.04,-563.06 752.27,-569.95"/>
</g>
<!-- indexx -->
<g id="interface~~perform_apm~~CallsGraph_node49" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="838.5,-192 784.5,-192 784.5,-168 838.5,-168 838.5,-192"/>
<text text-anchor="middle" x="811.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="interface~~perform_apm~~CallsGraph_edge60" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M656.76,-180C695.72,-180 742.55,-180 774.21,-180"/>
<polygon fill="#000000" stroke="#000000" points="774.33,-183.5 784.33,-180 774.33,-176.5 774.33,-183.5"/>
</g>
<!-- proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node52" class="node">
<title>proc~find_particles_above_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node52"><a xlink:href=".././proc/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1110,-730 935,-730 935,-706 1110,-706 1110,-730"/>
<text text-anchor="middle" x="1022.5" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge61" class="edge">
<title>interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M899.02,-718C907.49,-718 916.13,-718 924.7,-718"/>
<polygon fill="#000000" stroke="#000000" points="924.71,-721.5 934.71,-718 924.71,-714.5 924.71,-721.5"/>
</g>
<!-- proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_node53" class="node">
<title>proc~reflect_particles_xy_plane</title>
<g id="a_interface~~perform_apm~~CallsGraph_node53"><a xlink:href=".././proc/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1097.5,-688 947.5,-688 947.5,-664 1097.5,-664 1097.5,-688"/>
<text text-anchor="middle" x="1022.5" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane -->
<g id="interface~~perform_apm~~CallsGraph_edge62" class="edge">
<title>interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M886.77,-676C903.1,-676 920.5,-676 937.18,-676"/>
<polygon fill="#000000" stroke="#000000" points="937.47,-679.5 947.47,-676 937.47,-672.5 937.47,-679.5"/>
</g>
</g>
</svg>
</div><script>var paninterfaceperform_apmCallsGraph = svgPanZoom('#interfaceperform_apmCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
    <br>
      <h2>public module module subroutine perform_apm(this, get_density, get_nstar_id, npart_output, pos_input, pvol, h_output, nu_output, center, com_star, mass, sizes, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, ghost_dist, use_atmosphere, remove_atmosphere, print_step, namefile_pos_id, namefile_pos, namefile_results, validate_position)   <a href='../proc/perform_apm.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
</h2>

    

    <h3>Arguments</h3>
      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-this~53"></span>class(<a href='../type/particles.html'>particles</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>this</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
</tr>
<tr>
  <td colspan="7">
      <small><h5>function get_density(x, y, z) result(density)</h5><p>Returns the baryon mass density at the desired point</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
</tr>
</tbody>
</table>

<h6>Return Value <small>double precision</small></h6>  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
</small>
  </td> 
</tr>
<tr>
  <td colspan="7">
      <small><h5>subroutine get_nstar_id(npart, x, y, z, nstar_sph, nstar_id, nlrf_sph, sqg)</h5><p>Computes the proper baryon number density at the particle positions</p>
    
<h6>Arguments</h6>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>x</strong>(npart)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>y</strong>(npart)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>z</strong>(npart)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_sph</strong>(npart)</td><td><p>\(\mathrm{SPH}\) proper baryon density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nstar_id</strong>(npart)</td><td><p>Array to store the computed proper baryon number density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nlrf_sph</strong>(npart)</td><td><p>Array to store the local rest frame baryon density computed from
 the \(\mathrm{SPH}\) proper baryon density</p></td>
</tr>
<tr>
  <td><span class="anchor" ></span>double precision,</td>
<td>intent(out)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>sqg</strong>(npart)</td><td><p>Square root of minus the determinant of the spacetime metric</p></td>
</tr>
</tbody>
</table>

</small>
  </td> 
</tr>
<tr>
  <td><span class="anchor" id="variable-npart_output"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>npart_output</strong></td><td><p>Initial particle number</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pos_input"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-pvol~2"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-h_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nu_output"></span>double precision,</td>
<td>intent(out),</td>
  <td></td>  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-center~3"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-com_star~3"></span>double precision,</td>
<td>intent(inout),</td>
  <td></td>  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass~3"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-sizes~2"></span>double precision,</td>
<td>intent(in),</td>
  <td></td>  <td>DIMENSION(6)</td><td>::</td>
  <td><strong>sizes</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-apm_max_it"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max_inc"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-mass_it"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-correct_nu~2"></span>logical,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_thres"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nuratio_des"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nx_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ny_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-nz_gh"></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ghost_dist"></span>double precision,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ghost_dist</strong></td><td><p>Distance between the ghost particles and the surface
 of the matter object considered (star, ejecta, etc...)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-use_atmosphere~2"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_atmosphere</strong></td><td><p>If .TRUE., allows particles to move where the density
 is 0, and displace them using only the smoothing term.
 This can be useful when the system has an irregular
 geometry, as, for example, an ejecta; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-remove_atmosphere"></span>logical,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>remove_atmosphere</strong></td><td><p>If .TRUE., removes the particles placed where the density is 0,
 at the end of the APM iteration; <code>.FALSE.</code> otherwise</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-print_step"></span>integer,</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>print_step</strong></td><td><p>Prints the particle positions to a formatted file every
 print_step steps</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos_id"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions
 and the ghost positions will be printed</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_pos"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions
 and the ghost positions will be printed every 15 iterations</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_results"></span>character(len=*),</td>
<td>intent(inout),</td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related
 to the particle distribution, the baryon number particle and the
 kernel estimate of the density will be printed at the end of
 the APM iteration</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-validate_position"></span>procedure(validate_position_int),</td>
<td></td>
  <td>optional</td>  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
</tr>
</tbody>
</table>

    <h3>Description</h3>
    <p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
    <br>

 </div>
</div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-07-07 15:40:22           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>