<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Image caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state DD2-SF RDF 1.8 from the CompOSE database. The solution was computed with \texttt{LORENE}, and the particles placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>particles &ndash; SPHINCS_ID </title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li><a href='../page/index.html'>More</a></li>
      
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../lists/programs.html">Programs</a></li>
               
        
        
            </ul>
        
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>



          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>particles
    <small>Derived Type</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
    <li><i class="fa fa-legal"></i> <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a></li> 
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="<p>18.1% of total for derived types.</p>Including implementation: 248 statements, 31.4% of total for derived types.">106 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/module_particles_id.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/module_particles_id.f90.html'>module_particles_id.f90</a></li>
    
     <li><a href='../module/particles_id.html'>particles_id</a></li>
    
  
     <li class="active">particles</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/particles.html#variable-theta">Theta</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-ye">Ye</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-ye_table">Ye_table</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-all_eos">all_eos</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-apm_iterate">apm_iterate</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-apm_timers">apm_timers</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-baryon_density_index">baryon_density_index</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-baryon_density_parts">baryon_density_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-call_flag">call_flag</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-compose_eos">compose_eos</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-compose_filename">compose_filename</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-compose_path">compose_path</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-correct_nu">correct_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-distribution_id">distribution_id</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-empty_object">empty_object</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-energy_density_parts">energy_density_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-export_bin">export_bin</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-export_form_x">export_form_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-export_form_xy">export_form_xy</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_xx_parts">g_xx_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_xy_parts">g_xy_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_xz_parts">g_xz_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_yy_parts">g_yy_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_yz_parts">g_yz_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_zz_parts">g_zz_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-h">h</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-importer_timer~2">importer_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-lapse_parts">lapse_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-lorene_bns_id_parfile">lorene_bns_id_parfile</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-mass_fractions">mass_fractions</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-mass_ratios">mass_ratios</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-masses">masses</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-n_matter~2">n_matter</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nb_table">nb_table</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nbar_i">nbar_i</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nbar_tot">nbar_tot</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nlrf">nlrf</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nlrf_int">nlrf_int</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-npart">npart</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-npart_i">npart_i</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nstar">nstar</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nstar_int">nstar_int</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nu">nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nu_ratio_des">nu_ratio_des</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nuratio">nuratio</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nuratio_i">nuratio_i</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-particle_density">particle_density</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-particle_density_int">particle_density_int</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-placer_timer">placer_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pmass">pmass</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pos">pos</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pos_x1">pos_x1</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pos_x2">pos_x2</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pressure_parts">pressure_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pressure_parts_cu">pressure_parts_cu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pvol">pvol</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-randomize_phi">randomize_phi</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-randomize_r">randomize_r</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-randomize_theta">randomize_theta</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-read_nu">read_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-redistribute_nu">redistribute_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-reflect_particles_x">reflect_particles_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-same_particle_timer">same_particle_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-shift_parts_x">shift_parts_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-shift_parts_y">shift_parts_y</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-shift_parts_z">shift_parts_z</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-specific_energy_parts">specific_energy_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-sph_computer_timer">sph_computer_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-u_pwp">u_pwp</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-use_thres">use_thres</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v">v</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v_euler_parts_x">v_euler_parts_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v_euler_parts_y">v_euler_parts_y</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v_euler_parts_z">v_euler_parts_z</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-0">Constructor</a></h3></div>
  <div id="cons-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/particles.html#interface-particles">particles</a>
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#fins-0">Finalization Procedures</a></h3></div>
  <div id="fins-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/particles.html#finalproc-destruct_particles">destruct_particles</a>
      
    </div>
  </div>
</div>



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-0">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-allocate_lorene_id_parts_memory">allocate_lorene_id_parts_memory</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-analyze_hydro">analyze_hydro</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-compute_ye">compute_Ye</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-compute_and_export_sph_variables">compute_and_export_SPH_variables</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-deallocate_lorene_id_parts_memory">deallocate_lorene_id_parts_memory</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_h">get_h</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nlrf">get_nlrf</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_npart">get_npart</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_npart_i">get_npart_i</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nu">get_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nuratio">get_nuratio</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nuratio_i">get_nuratio_i</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_pos">get_pos</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_pressure">get_pressure</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_pressure_cu">get_pressure_cu</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_theta">get_theta</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_u">get_u</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_vel">get_vel</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-impose_equatorial_plane_symmetry">impose_equatorial_plane_symmetry</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-is_empty">is_empty</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-perform_apm">perform_apm</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-place_particles_lattice">place_particles_lattice</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-place_particles_spherical_surfaces">place_particles_spherical_surfaces</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-print_formatted_lorene_id_particles">print_formatted_lorene_id_particles</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-print_summary">print_summary</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-read_compose_composition">read_compose_composition</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-read_sphincs_dump_print_formatted">read_sphincs_dump_print_formatted</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/particles.html#src">particles</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
      <h2>type, public :: particles</h2>
    <p>TYPE representing a \(\mathrm{SPH}\) particle distribution</p>
    <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Inherits</h3>
      </div>
      <div class="panel-body">
    <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: type~~particles~~InheritsGraph Pages: 1 -->
<svg id="typeparticlesInheritsGraph" width="515pt" height="74pt"
 viewBox="0.00 0.00 515.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="type~~particles~~InheritsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>type~~particles~~InheritsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-70 511,-70 511,4 -4,4"/>
<!-- type~particles -->
<g id="type~~particles~~InheritsGraph_node1" class="node">
<title>type~particles</title>
<polygon fill="none" stroke="#000000" points="507,-45 453,-45 453,-21 507,-21 507,-45"/>
<text text-anchor="middle" x="480" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">particles</text>
</g>
<!-- timer -->
<g id="type~~particles~~InheritsGraph_node2" class="node">
<title>timer</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-66 0,-66 0,-42 54,-42 54,-66"/>
<text text-anchor="middle" x="27" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">timer</text>
</g>
<!-- type~particles&#45;&gt;timer -->
<g id="type~~particles~~InheritsGraph_edge2" class="edge">
<title>type~particles&#45;&gt;timer</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M452.683,-34.2664C375.0211,-37.8666 152.8608,-48.1654 64.1982,-52.2756"/>
<polygon fill="#000000" stroke="#000000" points="63.8933,-48.7859 54.0662,-52.7453 64.2176,-55.7783 63.8933,-48.7859"/>
<text text-anchor="middle" x="253.5" y="-53.4" font-family="Helvetica,sans-Serif" font-size="9.50" fill="#000000">placer_timer, same_particle_timer, apm_timers, importer_timer, sph_computer_timer</text>
</g>
<!-- type~eos -->
<g id="type~~particles~~InheritsGraph_node3" class="node">
<title>type~eos</title>
<g id="a_type~~particles~~InheritsGraph_node3"><a xlink:href=".././type/eos.html" xlink:title="eos">
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">eos</text>
</a>
</g>
</g>
<!-- type~particles&#45;&gt;type~eos -->
<g id="type~~particles~~InheritsGraph_edge1" class="edge">
<title>type~particles&#45;&gt;type~eos</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M452.5726,-25.3032C446.811,-23.9667 440.7401,-22.7629 435,-22 299.7148,-4.0208 137.0384,-7.4355 64.7727,-10.2288"/>
<polygon fill="#000000" stroke="#000000" points="64.2239,-6.7481 54.3742,-10.6511 64.508,-13.7423 64.2239,-6.7481"/>
<text text-anchor="middle" x="253.5" y="-24.4" font-family="Helvetica,sans-Serif" font-size="9.50" fill="#000000">all_eos</text>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="178pt" height="32pt"
 viewBox="0.00 0.00 177.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 173.5,-28 173.5,4 -4,4"/>
<!-- Type -->
<g id="node1" class="node">
<title>Type</title>
<polygon fill="#5cb85c" stroke="#5cb85c" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Type</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="169.5,-24 72.5,-24 72.5,0 169.5,0 169.5,-24"/>
<text text-anchor="middle" x="121" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a derived type to the parent type which it
    extends. Dashed arrows point from a derived type to the other
    types it contains as a components, with a label listing the name(s) of
    said component(s).
    </p>
    </div></div></div></div>
      </div>
    </div>
    
    
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/particles.html#variable-theta">Theta</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-ye">Ye</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-ye_table">Ye_table</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-all_eos">all_eos</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-apm_iterate">apm_iterate</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-apm_timers">apm_timers</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-baryon_density_index">baryon_density_index</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-baryon_density_parts">baryon_density_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-call_flag">call_flag</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-compose_eos">compose_eos</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-compose_filename">compose_filename</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-compose_path">compose_path</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-correct_nu">correct_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-distribution_id">distribution_id</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-empty_object">empty_object</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-energy_density_parts">energy_density_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-export_bin">export_bin</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-export_form_x">export_form_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-export_form_xy">export_form_xy</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_xx_parts">g_xx_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_xy_parts">g_xy_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_xz_parts">g_xz_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_yy_parts">g_yy_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_yz_parts">g_yz_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-g_zz_parts">g_zz_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-h">h</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-importer_timer~2">importer_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-lapse_parts">lapse_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-lorene_bns_id_parfile">lorene_bns_id_parfile</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-mass_fractions">mass_fractions</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-mass_ratios">mass_ratios</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-masses">masses</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-n_matter~2">n_matter</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nb_table">nb_table</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nbar_i">nbar_i</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nbar_tot">nbar_tot</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nlrf">nlrf</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nlrf_int">nlrf_int</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-npart">npart</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-npart_i">npart_i</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nstar">nstar</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nstar_int">nstar_int</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nu">nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nu_ratio_des">nu_ratio_des</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nuratio">nuratio</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-nuratio_i">nuratio_i</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-particle_density">particle_density</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-particle_density_int">particle_density_int</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-placer_timer">placer_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pmass">pmass</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pos">pos</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pos_x1">pos_x1</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pos_x2">pos_x2</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pressure_parts">pressure_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pressure_parts_cu">pressure_parts_cu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-pvol">pvol</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-randomize_phi">randomize_phi</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-randomize_r">randomize_r</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-randomize_theta">randomize_theta</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-read_nu">read_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-redistribute_nu">redistribute_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-reflect_particles_x">reflect_particles_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-same_particle_timer">same_particle_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-shift_parts_x">shift_parts_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-shift_parts_y">shift_parts_y</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-shift_parts_z">shift_parts_z</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-specific_energy_parts">specific_energy_parts</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-sph_computer_timer">sph_computer_timer</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-u_pwp">u_pwp</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-use_thres">use_thres</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v">v</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v_euler_parts_x">v_euler_parts_x</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v_euler_parts_y">v_euler_parts_y</a>
      
      <a class="list-group-item" href="../type/particles.html#variable-v_euler_parts_z">v_euler_parts_z</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#cons-1">Constructor</a></h3></div>
  <div id="cons-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../type/particles.html#interface-particles">particles</a>
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#fins-1">Finalization Procedures</a></h3></div>
  <div id="fins-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/particles.html#finalproc-destruct_particles">destruct_particles</a>
      
    </div>
  </div>
</div>



<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#boundprocs-1">Type-Bound Procedures</a></h3></div>
  <div id="boundprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-allocate_lorene_id_parts_memory">allocate_lorene_id_parts_memory</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-analyze_hydro">analyze_hydro</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-compute_ye">compute_Ye</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-compute_and_export_sph_variables">compute_and_export_SPH_variables</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-deallocate_lorene_id_parts_memory">deallocate_lorene_id_parts_memory</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_h">get_h</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nlrf">get_nlrf</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_npart">get_npart</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_npart_i">get_npart_i</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nu">get_nu</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nuratio">get_nuratio</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_nuratio_i">get_nuratio_i</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_pos">get_pos</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_pressure">get_pressure</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_pressure_cu">get_pressure_cu</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_theta">get_theta</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_u">get_u</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-get_vel">get_vel</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-impose_equatorial_plane_symmetry">impose_equatorial_plane_symmetry</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-is_empty">is_empty</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-perform_apm">perform_apm</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-place_particles_lattice">place_particles_lattice</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-place_particles_spherical_surfaces">place_particles_spherical_surfaces</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-print_formatted_lorene_id_particles">print_formatted_lorene_id_particles</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-print_summary">print_summary</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-read_compose_composition">read_compose_composition</a>
      
      <a class="list-group-item" href="../type/particles.html#boundprocedure-read_sphincs_dump_print_formatted">read_sphincs_dump_print_formatted</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../type/particles.html#src">particles</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    
    <section>
    <h2>Components</h2>
    
<table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Visibility</th>

<th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-theta"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>Theta</strong></td><td></td><td></td><td><p>1-D array storing the generalized Lorentz factor</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ye"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>Ye</strong></td><td></td><td></td><td><p>1-D array storing the electron fraction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ye_table"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>Ye_table</strong></td><td></td><td></td><td><p>Array storing the values of the electron fraction in the CompOSE table</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-all_eos"></span>type(<a href='../type/eos.html'>eos</a>),</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>all_eos</strong></td><td></td><td></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-apm_iterate"></span>logical,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>apm_iterate</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the Artificial Pressure Method (APM) has to be applied to the
 particles on star 1, <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-apm_timers"></span>type(timer),</td>
  
  <td>public,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>apm_timers</strong></td><td></td><td></td><td><p>Timer that times how long it takes to perform the APM on the matter
 objects</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-baryon_density_index"></span>integer,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>baryon_density_index</strong></td><td></td><td></td><td><p>Array storing the indices to use with <a href="../type/particles.html#variable-baryon_density_parts">baryon_density_parts</a>
 to sort the elements of <a href="../type/particles.html#variable-baryon_density_parts">baryon_density_parts</a> in increasing
 order</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-baryon_density_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>baryon_density_parts</strong></td><td></td><td></td><td><p>1-D array storing the baryon mass density in the fluid frame
 <script type="math/tex">[\mathrm{kg}\,\mathrm{m}^{-3}]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-call_flag"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>call_flag</strong></td><td> =</td><td>0</td><td><p>Flag that is set different than 0 if the SUBROUTINE
 compute_and_export_SPH_variables is called</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-compose_eos"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>compose_eos</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the electron fraction <script type="math/tex">Y_e</script> should be read from the CompOSE
 table with extension.beta, <code>.FALSE.</code> otherwise
 </p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>Chamge name of this variable to assign_Ye_compose. Check that
       the used EOS is indeed the one used to read <script type="math/tex">Y_e</script></p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-compose_filename"></span>character(len=:),</td>
  
  <td>private,</td>
  <td>ALLOCATABLE</td><td>::</td>
  <td><strong>compose_filename</strong></td><td></td><td></td><td><p>String storing the subpath of compose_path to the CompOSE file with</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-compose_path"></span>character(len=:),</td>
  
  <td>private,</td>
  <td>ALLOCATABLE</td><td>::</td>
  <td><strong>compose_path</strong></td><td></td><td></td><td><p>String storing the local path to the directory containing the
 CompOSE \(\mathrm{EOS}\)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-correct_nu"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the baryon number per particle should be corrected to account
 for the total baryon masses of the stars, <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-distribution_id"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>distribution_id</strong></td><td></td><td></td><td><p>Identification number for the particle distribution</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-empty_object"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>empty_object</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the object is empty, <code>.FALSE.</code> if it's not empty</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-energy_density_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>energy_density_parts</strong></td><td></td><td></td><td><p>1-D array storing the energy density</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-export_bin"></span>logical,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>export_bin</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the binary files for SPHINCS_BSSN are to be exported,
 <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-export_form_x"></span>logical,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>export_form_x</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the ID in the formatted files is to be on the x axis only,
 <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-export_form_xy"></span>logical,</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>export_form_xy</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the ID in the formatted files is to be on the xy plane only,
 <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g_xx_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>g_xx_parts</strong></td><td></td><td></td><td><p>Array storing the values of the xx component of the spatial metric
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g_xy_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>g_xy_parts</strong></td><td></td><td></td><td><p>Array storing the values of the xy component of the spatial metric
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g_xz_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>g_xz_parts</strong></td><td></td><td></td><td><p>Array storing the values of the xz component of the spatial metric
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g_yy_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>g_yy_parts</strong></td><td></td><td></td><td><p>Array storing the values of the xz component of the spatial metric
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g_yz_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>g_yz_parts</strong></td><td></td><td></td><td><p>Array storing the values of the yz component of the spatial metric
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-g_zz_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>g_zz_parts</strong></td><td></td><td></td><td><p>Array storing the values of the zz component of the spatial metric
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-h"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>h</strong></td><td></td><td></td><td><p>1-D array storing the smoothing length <script type="math/tex">L_\odot</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-importer_timer~2"></span>type(timer),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>importer_timer</strong></td><td></td><td></td><td><p>Timer that times how long it takes to import the <script type="math/tex">\texttt{\(\texttt{LORENE}\)}</script> ID
 at the particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lapse_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>lapse_parts</strong></td><td></td><td></td><td><p>Array storing the values of the lapse function on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-lorene_bns_id_parfile"></span>character(len=50),</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>lorene_bns_id_parfile</strong></td><td></td><td></td><td><p>String containing the name of the particles parameter file</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mass_fractions"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>mass_fractions</strong></td><td></td><td></td><td><p>Ratio between baryonic masses of the matter objects and the total
 baryonic mass of all the matter objects </p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p>always <script type="math/tex">< 1</script></p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-mass_ratios"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>mass_ratios</strong></td><td></td><td></td><td><p>Ratio between baryonic masses of the matter objects and the maximum
 baryonic mass among them </p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p>always <script type="math/tex">< 1</script></p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-masses"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>masses</strong></td><td></td><td></td><td><p>Baryonic masses of the matter objects <script type="math/tex">M_\odot</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-n_matter~2"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>n_matter</strong></td><td></td><td></td><td><p>Number of matter objects in the physical system</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nb_table"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nb_table</strong></td><td></td><td></td><td><p>Array storing the values of the baryon number density in the CompOSE
 table. </p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>ADD UNITS</p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nbar_i"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nbar_i</strong></td><td></td><td></td><td><p>Baryon numbers of the matter objects</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nbar_tot"></span>double precision,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>nbar_tot</strong></td><td></td><td></td><td><p>Total baryon number</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nlrf"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nlrf</strong></td><td></td><td></td><td><p>1-D array storing baryon density in the local rest frame
 <script type="math/tex">[\mathrm{baryon}\, (L_\odot)^{-3}]</script>, computed directly from
 the \(\texttt{LORENE}\) density</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nlrf_int"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nlrf_int</strong></td><td></td><td></td><td><p>1-D array storing baryon density in the local rest frame
 <script type="math/tex">[\mathrm{baryon}\, (L_\odot)^{-3}]</script>, computed from the kernel
 interpolated proper baryon number density <a href="../type/particles.html#variable-nstar_int">nstar_int</a></p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-npart"></span>integer,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>npart</strong></td><td></td><td></td><td><p>Total particle number</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-npart_i"></span>integer,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>npart_i</strong></td><td></td><td></td><td><p>Array storing the particle numbers for the matter objects</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nstar"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nstar</strong></td><td></td><td></td><td><p>1-D array storing the SPH estimate of the proper baryon number density
 <script type="math/tex">[\mathrm{baryon}\, (L_\odot)^{-3}]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nstar_int"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nstar_int</strong></td><td></td><td></td><td><p>1-D array storing the SPH estimate of the proper baryon number density,
 from kernel interpolation <script type="math/tex">[\mathrm{baryon}\, (L_\odot)^{-3}]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nu"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nu</strong></td><td></td><td></td><td><p>1-D array storing the baryon number per particle</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nu_ratio_des"></span>double precision,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>nu_ratio_des</strong></td><td></td><td></td><td><p>Desired ratio between the max and min of the baryon number per particle,
 over all the matter objects. <strong>Only used when redistribute_nu is .TRUE.</strong>
 </p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p>Almost deprecated</p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuratio"></span>double precision,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>nuratio</strong></td><td></td><td></td><td><p>Ratio between the max and min of the baryon number per particle, over
 all the matter objects</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nuratio_i"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>nuratio_i</strong></td><td></td><td></td><td><p>Baryon number ratios on the matter objects</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-particle_density"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>particle_density</strong></td><td></td><td></td><td><p>1-D array storing the particle number density
 <script type="math/tex">[\mathrm{particle}\, (L_\odot)^{-3}]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-particle_density_int"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>particle_density_int</strong></td><td></td><td></td><td><p>1-D array storing the SPH estimate of the particle number density, from
 kernel interpolation <script type="math/tex">[\mathrm{particle}\, (L_\odot)^{-3}]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-placer_timer"></span>type(timer),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>placer_timer</strong></td><td></td><td></td><td><p>Timer that times how long it takes to place particles on the stars</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pmass"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pmass</strong></td><td></td><td></td><td><p>1-D array storing the particle masses <script type="math/tex">M_\odot</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pos"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos</strong></td><td></td><td></td><td><p>2-D array storing the particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pos_x1"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_x1</strong></td><td></td><td></td><td><p>1-D array storing the position of the particles on the x axis for S 1</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pos_x2"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos_x2</strong></td><td></td><td></td><td><p>1-D array storing the position of the particles on the x axis for NS2</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pressure_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pressure_parts</strong></td><td></td><td></td><td><p>1-D array storing the pressure <script type="math/tex">[\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pressure_parts_cu"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pressure_parts_cu</strong></td><td></td><td></td><td><p>1-D array storing the pressure on the x axis
  <script type="math/tex">[\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]</script> for NS 1
DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x1
 1-D array storing the pressure on the x axis
  <script type="math/tex">[\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]</script> for NS 2
DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x2
 1-D array storing the first derivative of the pressure
  along the x axis <script type="math/tex">[\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]</script> for NS 1
DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x_der1
 1-D array storing the first derivative of the pressure
  along the x axis <script type="math/tex">[\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]</script> for NS2
DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x_der2
 1-D array storing the typical length scale for the pressure change
 1-D array storing the typical length scale for the pressure change
 1-D array storing the pressure in code units
  <script type="math/tex">[\mathrm{amu}\,c^2\,\mathrm{L_\odot}^{-3}]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-pvol"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td></td><td></td><td><p>1-D array storing the particle volumes <script type="math/tex">L_\odot^3</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-randomize_phi"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>randomize_phi</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the particle positions on spherical surfaces are randomized
 in the <script type="math/tex">\phi</script> direction, <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-randomize_r"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>randomize_r</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the particle positions on spherical surfaces are randomized
 in the <script type="math/tex">r</script> direction, <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-randomize_theta"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>randomize_theta</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the particle positions on spherical surfaces are randomized
 in the <script type="math/tex">\theta</script> direction, <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-read_nu"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>read_nu</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the baryon number per particle <script type="math/tex">\nu</script> has to be read from the
 formatted file containing the particle positions, <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-redistribute_nu"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>redistribute_nu</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the baryon number per particle should be reassigned, trying
 to obtain a baryon number ratio no larger than nu_ratio,
 when placing particles on lattices; <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-reflect_particles_x"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>reflect_particles_x</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the particles on star 2 should be the reflection of the
 particles on star 1 with respect to the <script type="math/tex">yz</script> plane, only if the baryon
 masses of the stars differe less than <script type="math/tex">0.2\%</script>; <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-same_particle_timer"></span>type(timer),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>same_particle_timer</strong></td><td></td><td></td><td><p>Timer that times how long it takes to check if there are multiple
 particles at the same positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-shift_parts_x"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>shift_parts_x</strong></td><td></td><td></td><td><p>Array storing the values of the x component of the shift vector
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-shift_parts_y"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>shift_parts_y</strong></td><td></td><td></td><td><p>Array storing the values of the y component of the shift vector
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-shift_parts_z"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>shift_parts_z</strong></td><td></td><td></td><td><p>Array storing the values of the z component of the shift vector
 on the particles</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-specific_energy_parts"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>specific_energy_parts</strong></td><td></td><td></td><td><p>1-D array storing the specific internal energy <script type="math/tex">[c^2]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-sph_computer_timer"></span>type(timer),</td>
  
  <td>public</td>
  <td></td><td>::</td>
  <td><strong>sph_computer_timer</strong></td><td></td><td></td><td><p>Timer that times how long it takes to compute the SPH variables at the
 particle pitions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-u_pwp"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>u_pwp</strong></td><td></td><td></td><td><p>1-D array storing the specific internal energy <script type="math/tex">[c^2]</script> computed using
 formula (9) in Read et al., Phys.Rev.D79:124032,2009,
 [arXiv:0812.2163][https://arxiv.org/abs/0812.2163]{:target="_blank"}</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-use_thres"></span>logical,</td>
  
  <td>private</td>
  <td></td><td>::</td>
  <td><strong>use_thres</strong></td><td></td><td></td><td><p><code>.TRUE.</code> if the threshold on the baryon mass density should e applied
 when placing particles on lattices, <code>.FALSE.</code> otherwise</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>v</strong></td><td></td><td></td><td><p>2-D array storing the coordinate fluid 4-velocity <script type="math/tex">[c]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v_euler_parts_x"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>v_euler_parts_x</strong></td><td></td><td></td><td><p>1-D array storing the x component of the fluid 3-velocity wrt
 the Eulerian observer <script type="math/tex">[c]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v_euler_parts_y"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>v_euler_parts_y</strong></td><td></td><td></td><td><p>1-D array storing the y component of the fluid 3-velocity wrt
 the Eulerian observer <script type="math/tex">[c]</script>
</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-v_euler_parts_z"></span>double precision,</td>
  
  <td>private,</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>v_euler_parts_z</strong></td><td></td><td></td><td><p>1-D array storing the z component of the fluid 3-velocity wrt
 the Eulerian observer <script type="math/tex">[c]</script>
</p></td>
  
</tr>

</tbody>
</table>

    </section>
    <br>
    
    
    
   <section>
   <h2>Constructor</h2>
     
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-particles"></span><h3>public interface <a href='../interface/particles.html'>particles</a>
    
  </h3></div>
  
  <div class="panel-body">
    
    <p>Interface of TYPE <a href="../type/particles.html">particles</a></p>
  </div>
  
  <ul class="list-group">
  
  
  
    <li class="list-group-item">
    
    
    <h3>
public interface <a href='../interface/construct_particles.html'>construct_particles</a>()
    
    
   
</h3>
    
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

    </li>
  
  
  </ul>
</div>

     
   </section>
   <br>
    
    
    
    <section>
    <h2>Finalization Procedures</h2>
     
         
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="finalproc-destruct_particles"></span><h3>final :: <strong>destruct_particles</strong> 
    </h3></div>
  <div class="panel-body">
    


    <p>Finalizer (Destructor) of [[particles]] object</p>
  </div>
  <ul class="list-group">
     <li class="list-group-item">
       
    
    <h3>
public interface <a href='../interface/destruct_particles.html'>destruct_particles</a>()
    
    
   
</h3>
    
    
    <h4>Arguments</h4>
    
      <em>None</em>
    
    

     </li>
  </ul>
</div>

         
    </section>
    <br>
    
    
     
    <section>
    <h2>Type-Bound Procedures</h2>
    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-allocate_lorene_id_parts_memory"></span><h3>procedure, public :: <strong>allocate_lorene_id_parts_memory</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Allocates memory for the <a href="../type/particles.html">particles</a> member arrays</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine allocate_lorene_id_parts_memory(THIS)
    
    
   
   <a href='../proc/allocate_lorene_id_parts_memory.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Allocates allocatable arrays member of a <a href="../type/particles.html">particles</a> object</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-analyze_hydro"></span><h3>procedure, public :: <strong>analyze_hydro</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Scans the hydro fields taken from <script type="math/tex">\texttt{\(\texttt{LORENE}\)}</script> to look
 for negative or zero values</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine analyze_hydro(THIS, namefile)
    
    
   
   <a href='../proc/analyze_hydro.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Scans the hydro fields taken from <script type="math/tex">\texttt{\(\texttt{LORENE}\)}</script> to look
 for negative or zero values</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile</strong></td><td><p>Name of the formatted file where the particle positions at which
 some of the hydro fields are negative or zero are printed to</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-compute_ye"></span><h3>procedure, public :: <strong>compute_Ye</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Interpates linearly the electron fraction <script type="math/tex">Y_e</script> at the particle
 densities; that is, assigns <script type="math/tex">Y_e</script> at the particle positions</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine compute_Ye(THIS)
    
    
   
   <a href='../proc/compute_ye.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Interpolates linearly the electron fraction <script type="math/tex">Y_e</script> at the particle
 densities; that is, assigns <script type="math/tex">Y_e</script> at the particle positions</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-compute_and_export_sph_variables"></span><h3>procedure, public :: <strong>compute_and_export_SPH_variables</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Computes the SPH variables at the particle positions, and optionally
 prints them to a binary file to be read by <script type="math/tex">\texttt{SPHINCS_BSSN}</script>
 and <script type="math/tex">\texttt{splash}</script>, and to a formatted file to be read by
 <script type="math/tex">\texttt{gnuplot}</script>, by calling
 <a href="../type/particles.html#boundprocedure-print_formatted_lorene_id_particles">print_formatted_lorene_id_particles</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine compute_and_export_SPH_variables(THIS, namefile)
    
    
   
   <a href='../proc/compute_and_export_sph_variables.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Computes the SPH variables at the particle positions, and optionally
 prints them to a binary file to be read by <script type="math/tex">\texttt{SPHINCS_BSSN}</script>
 and <script type="math/tex">\texttt{splash}</script>, and to a formatted file to be read by
 <script type="math/tex">\texttt{gnuplot}</script>, by calling
 <a href="../type/particles.html#boundprocedure-print_formatted_lorene_id_particles">print_formatted_lorene_id_particles</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile</strong></td><td><p>Name of the formatted file where the SPH ID is printed to</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-deallocate_lorene_id_parts_memory"></span><h3>procedure, public :: <strong>deallocate_lorene_id_parts_memory</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Deallocates memory for the <a href="../type/particles.html">particles</a> member arrays</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine deallocate_lorene_id_parts_memory(THIS)
    
    
   
   <a href='../proc/deallocate_lorene_id_parts_memory.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Deallocates allocatable arrays member of a <a href="../type/particles.html">particles</a> object</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_h"></span><h3>procedure, public :: <strong>get_h</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-h">h</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_h(THIS) result(h)
    
    
   
   <a href='../proc/get_h.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-h">h</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-h">h</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_nlrf"></span><h3>procedure, public :: <strong>get_nlrf</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-nlrf">nlrf</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_nlrf(THIS) result(nlrf)
    
    
   
   <a href='../proc/get_nlrf.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-nlrf">nlrf</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-nlrf">nlrf</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_npart"></span><h3>procedure, public :: <strong>get_npart</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-npart">npart</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_npart(THIS) result(n_part)
    
    
   
   <a href='../proc/get_npart.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-npart">npart</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer
  </small></h4>
  <p><a href="../type/particles.html#variable-npart">npart</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_npart_i"></span><h3>procedure, public :: <strong>get_npart_i</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns the number of particles on the object <code>i_matter</code></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_npart_i(THIS, i_matter) result(n_part)
    
    
   
   <a href='../proc/get_npart_i.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns the number of particles on the object <code>i_matter</code></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>i_matter</strong></td><td><p>Index of the matter object</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer
  </small></h4>
  <p>Number of particles on the object <code>i_matter</code></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_nu"></span><h3>procedure, public :: <strong>get_nu</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-nu">nu</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_nu(THIS) result(nu)
    
    
   
   <a href='../proc/get_nu.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-nu">nu</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-nu">nu</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_nuratio"></span><h3>procedure, public :: <strong>get_nuratio</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-nuratio">nuratio</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_nuratio(THIS) result(nuratio)
    
    
   
   <a href='../proc/get_nuratio.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-nuratio">nuratio</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision
  </small></h4>
  <p><a href="../type/particles.html#variable-nuratio">nuratio</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_nuratio_i"></span><h3>procedure, public :: <strong>get_nuratio_i</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns the baryon number ratio on the object <code>i_matter</code></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_nuratio_i(THIS, i_matter) result(nuratio)
    
    
   
   <a href='../proc/get_nuratio_i.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns the baryon number ratio on the object <code>i_matter</code></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>i_matter</strong></td><td><p>Index of the matter object</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>integer
  </small></h4>
  <p>Baryon number ratio on the object <code>i_matter</code></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_pos"></span><h3>procedure, public :: <strong>get_pos</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-pos">pos</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_pos(THIS) result(pos_u)
    
    
   
   <a href='../proc/get_pos.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-pos">pos</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:,:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-pos">pos</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_pressure"></span><h3>procedure, public :: <strong>get_pressure</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-pressure_parts">pressure_parts</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_pressure(THIS) result(pressure)
    
    
   
   <a href='../proc/get_pressure.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-pressure_parts">pressure_parts</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-pressure_parts">pressure_parts</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_pressure_cu"></span><h3>procedure, public :: <strong>get_pressure_cu</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-pressure_parts_cu">pressure_parts_cu</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_pressure_cu(THIS) result(pressure_cu)
    
    
   
   <a href='../proc/get_pressure_cu.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-pressure_parts_cu">pressure_parts_cu</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-pressure_parts_cu">pressure_parts_cu</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_theta"></span><h3>procedure, public :: <strong>get_theta</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-theta">Theta</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_theta(THIS) result(theta)
    
    
   
   <a href='../proc/get_theta.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-theta">Theta</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-theta">Theta</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_u"></span><h3>procedure, public :: <strong>get_u</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-specific_energy_parts">specific_energy_parts</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_u(THIS) result(u)
    
    
   
   <a href='../proc/get_u.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-specific_energy_parts">specific_energy_parts</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-specific_energy_parts">specific_energy_parts</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-get_vel"></span><h3>procedure, public :: <strong>get_vel</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <a href="../type/particles.html#variable-v">v</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public pure module module function get_vel(THIS) result(vel)
    
    
   
   <a href='../proc/get_vel.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <a href="../type/particles.html#variable-v">v</a></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>double precision,
  DIMENSION(:,:), ALLOCATABLE</small></h4>
  <p><a href="../type/particles.html#variable-v">v</a></p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-impose_equatorial_plane_symmetry"></span><h3>procedure, public, NOPASS :: <strong>impose_equatorial_plane_symmetry</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Reflects the positions of the particles on a matter object with respect
 to the <script type="math/tex">xy</script> plane</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine impose_equatorial_plane_symmetry(npart, pos, nu, com_star, verbose)
    
    
   
   <a href='../proc/impose_equatorial_plane_symmetry.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Mirror the particle with z&gt;0 with respect to the xy plane,
 to impose the equatorial-plane symmetry</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(3,npart)</td><td>::</td>
  <td><strong>pos</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td>DIMENSION(npart)</td><td>::</td>
  <td><strong>nu</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>com_star</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>verbose</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-is_empty"></span><h3>procedure, public :: <strong>is_empty</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Returns <code>.TRUE</code> if the <a href="../type/particles.html">particles</a> object is empty, <code>.FALSE</code> otherwise
 </p><div class="alert alert-warning" role="alert"><h4>Warning</h4><p>experimental, not actively used in the code yet</p></div>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module function is_empty(THIS) result(answer)
    
    
   
   <a href='../proc/is_empty.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Returns <code>.TRUE</code> if the <a href="../type/particles.html">particles</a> object is empty, <code>.FALSE</code> otherwise
 </p><a href="../interface/is_empty.html" class="pull-right"><emph>Read more&hellip;</emph></a>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>logical
  </small></h4>
  <p><code>.TRUE</code> if the <a href="../type/particles.html">particles</a> object is empty, <code>.FALSE</code> otherwise</p>
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-perform_apm"></span><h3>procedure, public, NOPASS :: <strong>perform_apm</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine perform_apm(get_density, get_nstar_p, pos_input, pvol, h_output, nu_output, center, com_star, mass, radx_comp, radx_opp, rady, radz, apm_max_it, max_inc, mass_it, correct_nu, nuratio_thres, nuratio_des, nx_gh, ny_gh, nz_gh, namefile_pos_id, namefile_pos, namefile_results, validate_position)
    
    
   
   <a href='../proc/perform_apm.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Performs the Artificial Pressure Method (APM) on one star's particles</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
function get_density(x, y, z) result(density)
    
    
   
</h5>
    



<p>Returns the baryon mass density at the desired point</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h6>Return Value <small>double precision
  </small></h6>
  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
subroutine get_nstar_p(npart_real, x, y, z, nstar_p)
    
    
   
</h5>
    



<p>Computes the proper baryon number density at the particle positions</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_real</strong></td><td><p>Number of real particles (i.e., no ghost particles included here)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong>(npart_real)</td><td><p>Array of <script type="math/tex">x</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong>(npart_real)</td><td><p>Array of <script type="math/tex">y</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong>(npart_real)</td><td><p>Array of <script type="math/tex">z</script> coordinates</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nstar_p</strong>(npart_real)</td><td><p>Array to store the computed proper baryon number density</p></td>
  
</tr>

</tbody>
</table>

      
    
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:,:)</td><td>::</td>
  <td><strong>pos_input</strong></td><td><p>Initial particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Initial particle volume</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>h_output</strong></td><td><p>Array to store the smoothing lengths computed at the end of the
 APM iteration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:)</td><td>::</td>
  <td><strong>nu_output</strong></td><td><p>Array to store the baryon number per particle computed at the end of
 the APM iteration</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star (point of highest density), computed by \(\texttt{LORENE}\)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>com_star</strong></td><td><p>Center of mass of the star, computed by \(\texttt{LORENE}\)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Mass of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radx_comp</strong></td><td><p>Radius of the star in the x direction, towards the companion</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radx_opp</strong></td><td><p>Radius of the star in the x direction, opposite to companion</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>rady</strong></td><td><p>Radius of the star in the y direction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radz</strong></td><td><p>Radius of the star in the z direction</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>apm_max_it</strong></td><td><p>Maximum number of APM iterations, irrespective of the EXIT condition</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>max_inc</strong></td><td><p>Sets the EXIT condition: If the average over all the
 particles of the relative error in the density estimate
 grows max_inc times, exit the iteration.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass_it</strong></td><td><p>If .TRUE. performs a second iteration after the APM one, without moving
 the particles, changing their mass in order to better match
 the star density. The mass ratio grows very fast in all the tried
 experiments, hence the suggested value is .FALSE.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>correct_nu</strong></td><td><p>If .TRUE., the baryon number per particle nu is corrected
 to include the total baryonic masses of the
 stars.</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuratio_thres</strong></td><td><p>Maximum mass ratio (equivalently baryon number ratio)
 to be used in the one-time-only final correction
 of the particle masses to match the star density even
 better (without moving the particles)</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nuratio_des</strong></td><td><p>Sets the EXIT condition: If the baryon number ratio
 is within 2.5% of nuratio_des, exit the iteration
 Set nuratio_des to 0 to deactivate and exit the APM
 iteration using max_inc</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nx_gh</strong></td><td><p>Number of lattice points in the x direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ny_gh</strong></td><td><p>Number of lattice points in the y direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nz_gh</strong></td><td><p>Number of lattice points in the z direction for ghosts</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_pos_id</strong></td><td><p>Name for the formatted file where the initial particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_pos</strong></td><td><p>Name for the formatted file where the particle positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_results</strong></td><td><p>Name for the formatted file where various quantities related</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(validate_position_int),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-place_particles_lattice"></span><h3>procedure, public :: <strong>place_particles_lattice</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Places particles on a single lattice that surrounds both stars</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine place_particles_lattice(THIS, central_density, xmin, xmax, ymin, ymax, zmin, zmax, npart_des, npart_out, stretch, thres, pos, pvol, get_density, validate_position)
    
    
   
   <a href='../proc/place_particles_lattice.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Places particles on a lattice containing a physical object</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>central_density</strong></td><td><p>Maximum baryon mass density of the system</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xmin</strong></td><td><p>Left <script type="math/tex">x</script> boundary of the lattice</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>xmax</strong></td><td><p>Right <script type="math/tex">x</script> boundary of the lattice</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ymin</strong></td><td><p>Left <script type="math/tex">y</script> boundary of the lattice</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ymax</strong></td><td><p>Right <script type="math/tex">y</script> boundary of the lattice</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>zmin</strong></td><td><p>Left <script type="math/tex">z</script> boundary of the lattice</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>zmax</strong></td><td><p>Right <script type="math/tex">z</script> boundary of the lattice</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_des</strong></td><td><p>Desired particle number</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_out</strong></td><td><p>Real, output particle number</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>stretch</strong></td><td><p>Stretching factor fo the lattice. <code>xmin</code> to <code>zmax</code> are multiplied by it</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>thres</strong></td><td><p>(~rho_max)/thres is the minimum mass density considered
when placing particles. Used only when redistribute_nu is
.FALSE. . When redistribute_nu is .TRUE. thres= 100*nu_ratio</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Array soring the inal particle volumes
Array storing the final particle volumes</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
function get_density(x, y, z) result(density)
    
    
   
</h5>
    



<p>Returns the baryon mass density at the desired point</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h6>Return Value <small>double precision
  </small></h6>
  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(validate_position_int),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-place_particles_spherical_surfaces"></span><h3>procedure, public :: <strong>place_particles_spherical_surfaces</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Places particles on spherical surfaces on one star</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine place_particles_spherical_surfaces(THIS, mass_star, radius, center, central_density, npart_approx, npart_out, pos, pvol, pmass, last_r, upper_bound, lower_bound, upper_factor, lower_factor, max_steps, filename_mass_profile, filename_shells_radii, filename_shells_pos, get_density, integrate_density, get_id, validate_position)
    
    
   
   <a href='../proc/place_particles_spherical_surfaces.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Places particles on spherical surfaces on one star</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass_star</strong></td><td><p>Baryonic mass of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radius</strong></td><td><p>Radius of the star in the x direction towards the companion</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>center</strong></td><td><p>(x|) coordinate of the center of the star, i.e.,
 of the point with highest density</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>central_density</strong></td><td><p>Central density of the star, i.e., highest density</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_approx</strong></td><td><p><a href="../type/idbase.html">idbase</a> object needed to access the BNS data
  </p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>Remove the <a href="../type/idbase.html">idbase</a> argument as done in SUBROUTINE perform_apm
CLASS(idbase),       INTENT( IN OUT ):: id
 Approximate particle number on the star</p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npart_out</strong></td><td><p>Final number of particles on the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>pos</strong></td><td><p>Array string the final positions</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pvol</strong></td><td><p>Array soring the inal particle volumes</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(out),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>pmass</strong></td><td><p>Array storing the final particle masses</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>last_r</strong></td><td><p>Radius of the last spherical surface</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>upper_bound</strong></td><td><p>Desired upper bound for the differences between particle
 masses on neighbouring spherical surfaces</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lower_bound</strong></td><td><p>Desired lower bound for the differences between particle
 masses on neighbouring spherical surfaces</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>upper_factor</strong></td><td><p>If, after max_steps, the iteration did not converge,
 multiply upper_bound by upper_factor, and lower_bound
 by lower_factor. upper_factor &gt;= 1, usually an increase of 1% works</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lower_factor</strong></td><td><p>If, after max_steps, the iteration did not converge,
 multiply upper_bound by upper_factor, and lower_bound
 by lower_factor. lower_factor &lt;= 1, usually a decrease of 1% works</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>max_steps</strong></td><td><p>If, after max_steps, the iteration did not converge,
 multiply upper_bound by upper_factor, and lower_bound
 by lower_factor. max_steps &gt;= 10. 100 is a nice value</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>filename_mass_profile</strong></td><td><p>Name of the file to store the radial mass profile</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>filename_shells_radii</strong></td><td><p>Name of the file to store the surface radii
 </p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>change name of variable to filename_surfaces_radii</p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>filename_shells_pos</strong></td><td><p>Name of the file to store the final particle positions
 </p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>change name of variable to filename_surfaces_pos</p></div></td>
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
function get_density(x, y, z) result(density)
    
    
   
</h5>
    



<p>Returns the baryon mass density at the desired point</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h6>Return Value <small>double precision
  </small></h6>
  <p>Baryon mass density at <script type="math/tex">(x,y,z)</script>
</p>
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
subroutine integrate_density(center, radius, central_density, dr, dth, dphi, mass, mass_profile, mass_profile_idx)
    
    
   
</h5>
    
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>center</strong></td><td><p>Center of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>radius</strong></td><td><p>Radius of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>central_density</strong></td><td><p>Central density of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dr</strong></td><td><p>Integration steps</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dth</strong></td><td><p>Integration steps</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dphi</strong></td><td><p>Integration steps</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mass</strong></td><td><p>Integrated mass of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:,:), ALLOCATABLE</td><td>::</td>
  <td><strong>mass_profile</strong></td><td><p>Array storing the radial mass profile of the star</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>mass_profile_idx</strong></td><td><p>Array to store the indices for array mass_profile, sorted so that
 mass_profile[mass_profile_idx] is in increasing order</p></td>
  
</tr>

</tbody>
</table>

      
    
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td colspan="7">
      <small>
    
    <h5>
subroutine get_id(x, y, z, g_xx, baryon_density, gamma_euler)
    
    
   
</h5>
    



<p>Returns the baryon mass density at the desired point</p>
    
    <h6>Arguments</h6>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td><p>
<script type="math/tex">x</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong></td><td><p>
<script type="math/tex">y</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>z</strong></td><td><p>
<script type="math/tex">z</script> coordinate of the desired point</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>g_xx</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>baryon_density</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>double precision,</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>gamma_euler</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    
</small>
  </td> 
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>procedure(validate_position_int),</td>
  <td></td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>validate_position</strong></td><td><p>Returns 1 if the position is not valid, 0 otherwise</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-print_formatted_lorene_id_particles"></span><h3>procedure, public :: <strong>print_formatted_lorene_id_particles</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Prints the SPH ID to a formatted file</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine print_formatted_lorene_id_particles(THIS, namefile)
    
    
   
   <a href='../proc/print_formatted_lorene_id_particles.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Prints the SPH ID to a formatted file</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile</strong></td><td><p>Name of the formatted output file</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-print_summary"></span><h3>procedure, public :: <strong>print_summary</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Prints the SPH ID to a formatted file</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine print_summary(THIS, filename)
    
    
   
   <a href='../proc/print_summary~2.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Prints a summary of the properties of the \(\mathrm{SPH}\) particle
 distribution, optionally, to a formatted file whose name
 is given as the optional argument <code>filename</code></p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>filename</strong></td><td><p>Name of the formatted file to print the summary to</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-read_compose_composition"></span><h3>procedure, public :: <strong>read_compose_composition</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Reads the <script type="math/tex">Y_e(n_b)</script> table in the CompOSE file with extension .beta</p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine read_compose_composition(THIS, namefile)
    
    
   
   <a href='../proc/read_compose_composition.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Reads the <script type="math/tex">Y_e(n_b)</script> table in the CompOSE file with extension .beta</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile</strong></td><td><p>To read the file great_eos.beta in directory compose_path/GREAT_EoS,
 namefile="GREAT_EoS/great_eos"</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
     
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="boundprocedure-read_sphincs_dump_print_formatted"></span><h3>procedure, public :: <strong>read_sphincs_dump_print_formatted</strong>  
    
  </h3></div>
  
  <div class="panel-body">
    


    <p>Reads the binary ID file printed by
 <a href="../type/particles.html#boundprocedure-compute_and_export_sph_variables">compute_and_export_SPH_variables</a></p>
  </div>
  
  <ul class="list-group">
    
      <li class="list-group-item">
      
        
          <h3>interface
          
          </h3>
  
          
          
    
    <h3>
public module module subroutine read_sphincs_dump_print_formatted(THIS, namefile_bin, namefile)
    
    
   
   <a href='../proc/read_sphincs_dump_print_formatted.html'><button type="button" class="btn btn-info depwarn">Implementation &rarr;</button></a>
    
</h3>
    



<p>Reads the binary ID file printed by
 <a href="../type/particles.html#boundprocedure-compute_and_export_sph_variables">compute_and_export_SPH_variables</a>
  and prints the data stored in it to a formatted file</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>class(<a href='../type/particles.html'>particles</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>THIS</strong></td><td><p><a href="../type/particles.html">particles</a> object which this PROCEDURE is a member of</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile_bin</strong></td><td><p>Name of the binary file to be read</p></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=*),</td>
  <td>intent(inout),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>namefile</strong></td><td><p>Name of the formatted file to be printed</p></td>
  
</tr>

</tbody>
</table>

      
    
    

        
      
      </li>
    
  </ul>
</div>

    
    </section>
    
    
    
    <section>
    <h3><span class="anchor" id="src"></span>Source Code</h3>
    <div class="highlight"><pre><span></span>  <span class="k">TYPE</span><span class="kd">::</span> <span class="n">particles</span>
  <span class="c">!! TYPE representing a |sph| particle distribution</span>


    <span class="k">PRIVATE</span>


<span class="k">    </span><span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">npart</span>
    <span class="c">!! Total particle number</span>
    <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">n_matter</span>
    <span class="c">!! Number of matter objects in the physical system</span>
    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">npart_i</span>
    <span class="c">!! Array storing the particle numbers for the matter objects</span>
    <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">distribution_id</span>
    <span class="c">!! Identification number for the particle distribution</span>
    <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">call_flag</span><span class="o">=</span> <span class="mi">0</span>
    <span class="c">!# Flag that is set different than 0 if the SUBROUTINE</span>
    <span class="c">!  compute_and_export_SPH_variables is called</span>

    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">baryon_density_index</span>
    <span class="c">!# Array storing the indices to use with [[particles:baryon_density_parts]]</span>
    <span class="c">!  to sort the elements of [[particles:baryon_density_parts]] in increasing</span>
    <span class="c">!  order</span>

    <span class="c">!</span>
    <span class="c">!-- Hydro variables on the particles</span>
    <span class="c">!</span>

    <span class="c">!&gt; 2-D array storing the particle positions</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">pos</span>
    <span class="c">!&gt; 1-D array storing the position of the particles on the x axis for S 1</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">pos_x1</span>
    <span class="c">!&gt; 1-D array storing the position of the particles on the x axis for NS2</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">pos_x2</span>
    <span class="c">!&amp; 1-D array storing the baryon mass density in the fluid frame</span>
    <span class="c">!  \([\mathrm{kg}\,\mathrm{m}^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">baryon_density_parts</span>
    <span class="c">!&gt; 1-D array storing the energy density</span>
    <span class="c">!  \([\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">energy_density_parts</span>
    <span class="c">!&gt; 1-D array storing the specific internal energy \([c^2]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">specific_energy_parts</span>
    <span class="c">!&amp; 1-D array storing the specific internal energy \([c^2]\) computed using</span>
    <span class="c">!  formula (9) in Read et al., Phys.Rev.D79:124032,2009,</span>
    <span class="c">!  [arXiv:0812.2163][https://arxiv.org/abs/0812.2163]{:target=&quot;_blank&quot;}</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">u_pwp</span>
    <span class="c">!&gt; 1-D array storing the pressure \([\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">pressure_parts</span>
    <span class="c">!&amp; 1-D array storing the pressure on the x axis</span>
    <span class="c">!  \([\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]\) for NS 1</span>
    <span class="c">!DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x1</span>
    <span class="c">!&amp; 1-D array storing the pressure on the x axis</span>
    <span class="c">!  \([\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]\) for NS 2</span>
    <span class="c">!DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x2</span>
    <span class="c">!&amp; 1-D array storing the first derivative of the pressure</span>
    <span class="c">!  along the x axis \([\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]\) for NS 1</span>
    <span class="c">!DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x_der1</span>
    <span class="c">!&amp; 1-D array storing the first derivative of the pressure</span>
    <span class="c">!  along the x axis \([\mathrm{kg}\,c^2\,\mathrm{m}^{-3}]\) for NS2</span>
    <span class="c">!DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_parts_x_der2</span>
    <span class="c">!&gt; 1-D array storing the typical length scale for the pressure change</span>
    <span class="c">!DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_length_scale_x1</span>
    <span class="c">!&gt; 1-D array storing the typical length scale for the pressure change</span>
    <span class="c">!DOUBLE PRECISION, DIMENSION(:),   ALLOCATABLE:: pressure_length_scale_x2</span>
    <span class="c">!&amp; 1-D array storing the pressure in code units</span>
    <span class="c">!  \([\mathrm{amu}\,c^2\,\mathrm{L_\odot}^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">pressure_parts_cu</span>
    <span class="c">!&amp; 1-D array storing the x component of the fluid 3-velocity wrt</span>
    <span class="c">!  the Eulerian observer \([c]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">v_euler_parts_x</span>
    <span class="c">!&amp; 1-D array storing the y component of the fluid 3-velocity wrt</span>
    <span class="c">!  the Eulerian observer \([c]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">v_euler_parts_y</span>
    <span class="c">!&amp; 1-D array storing the z component of the fluid 3-velocity wrt</span>
    <span class="c">!  the Eulerian observer \([c]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">v_euler_parts_z</span>

    <span class="c">!</span>
    <span class="c">!-- Arrays to store the electron fraction Ye as a function of the</span>
    <span class="c">!-- baryon number density for beta-equilibrated EoS at T~0,</span>
    <span class="c">!-- imported from the CompOSE database&#39;s and software&#39;s files</span>
    <span class="c">!</span>

    <span class="c">!&amp; Array storing the values of the baryon number density in the CompOSE</span>
    <span class="c">!  table. @todo ADD UNITS</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nb_table</span>
    <span class="c">!&gt; Array storing the values of the electron fraction in the CompOSE table</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">Ye_table</span>

    <span class="c">!</span>
    <span class="c">!-- Spacetime fields</span>
    <span class="c">!</span>

    <span class="c">!&gt; Array storing the values of the lapse function on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">lapse_parts</span>
    <span class="c">!&amp; Array storing the values of the x component of the shift vector</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">shift_parts_x</span>
    <span class="c">!&amp; Array storing the values of the y component of the shift vector</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">shift_parts_y</span>
    <span class="c">!&amp; Array storing the values of the z component of the shift vector</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">shift_parts_z</span>
    <span class="c">!&amp; Array storing the values of the xx component of the spatial metric</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">g_xx_parts</span>
    <span class="c">!&amp; Array storing the values of the xy component of the spatial metric</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">g_xy_parts</span>
    <span class="c">!&amp; Array storing the values of the xz component of the spatial metric</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">g_xz_parts</span>
    <span class="c">!&amp; Array storing the values of the xz component of the spatial metric</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">g_yy_parts</span>
    <span class="c">!&amp; Array storing the values of the yz component of the spatial metric</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">g_yz_parts</span>
    <span class="c">!&amp; Array storing the values of the zz component of the spatial metric</span>
    <span class="c">!  on the particles</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">g_zz_parts</span>

    <span class="c">!</span>
    <span class="c">!-- SPH fields</span>
    <span class="c">!</span>

    <span class="c">!&amp; 1-D array storing baryon density in the local rest frame</span>
    <span class="c">!  \([\mathrm{baryon}\, (L_\odot)^{-3}]\), computed directly from</span>
    <span class="c">!  the |lorene| density</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nlrf</span>
    <span class="c">!&amp; 1-D array storing baryon density in the local rest frame</span>
    <span class="c">!  \([\mathrm{baryon}\, (L_\odot)^{-3}]\), computed from the kernel</span>
    <span class="c">!  interpolated proper baryon number density [[particles:nstar_int]]</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nlrf_int</span>
    <span class="c">!&gt; 1-D array storing the baryon number per particle</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nu</span>
    <span class="c">!&amp; 1-D array storing the SPH estimate of the proper baryon number density</span>
    <span class="c">!  \([\mathrm{baryon}\, (L_\odot)^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nstar</span>
    <span class="c">!&amp; 1-D array storing the particle number density</span>
    <span class="c">!  \([\mathrm{particle}\, (L_\odot)^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">particle_density</span>
    <span class="c">!&amp; 1-D array storing the SPH estimate of the proper baryon number density,</span>
    <span class="c">!  from kernel interpolation \([\mathrm{baryon}\, (L_\odot)^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nstar_int</span>
    <span class="c">!&amp; 1-D array storing the SPH estimate of the particle number density, from</span>
    <span class="c">!  kernel interpolation \([\mathrm{particle}\, (L_\odot)^{-3}]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">particle_density_int</span>
    <span class="c">!&gt; 2-D array storing the coordinate fluid 4-velocity \([c]\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">v</span>
    <span class="c">!&gt; 1-D array storing the generalized Lorentz factor</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">Theta</span>
    <span class="c">!&gt; 1-D array storing the electron fraction</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">Ye</span>
    <span class="c">!&gt; 1-D array storing the smoothing length \(L_\odot\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">h</span>
    <span class="c">!&gt; 1-D array storing the particle volumes \(L_\odot^3\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">pvol</span>
    <span class="c">!&gt; 1-D array storing the particle masses \(M_\odot\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">pmass</span>
    <span class="c">!&gt; Baryonic masses of the matter objects \(M_\odot\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">masses</span>
    <span class="c">!&amp; Ratio between baryonic masses of the matter objects and the maximum</span>
    <span class="c">!  baryonic mass among them @warning always \(&lt; 1\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">mass_ratios</span>
    <span class="c">!&amp; Ratio between baryonic masses of the matter objects and the total</span>
    <span class="c">!  baryonic mass of all the matter objects @warning always \(&lt; 1\)</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">mass_fractions</span>
    <span class="c">!&gt; Total baryon number</span>
    <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">nbar_tot</span>
    <span class="c">!&gt; Baryon numbers of the matter objects</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nbar_i</span>
    <span class="c">!&amp; Ratio between the max and min of the baryon number per particle, over</span>
    <span class="c">!  all the matter objects</span>
    <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">nuratio</span>
    <span class="c">!&amp; Desired ratio between the max and min of the baryon number per particle,</span>
    <span class="c">!  over all the matter objects. **Only used when redistribute_nu is .TRUE.**</span>
    <span class="c">!  @warning Almost deprecated</span>
    <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">nu_ratio_des</span>
    <span class="c">!&gt; Baryon number ratios on the matter objects</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span>   <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">nuratio_i</span>

    <span class="c">!</span>
    <span class="c">!-- Strings</span>
    <span class="c">!</span>

    <span class="c">!&gt; String containing the name of the particles parameter file</span>
    <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">50</span> <span class="p">)</span><span class="kd">::</span> <span class="n">lorene_bns_id_parfile</span>

    <span class="c">!&amp; String storing the local path to the directory containing the</span>
    <span class="c">!  CompOSE |eos|</span>
    <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">compose_path</span>
    <span class="c">!&gt; String storing the subpath of compose_path to the CompOSE file with</span>
    <span class="c">!  .beta extension</span>
    <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">compose_filename</span>

    <span class="c">!</span>
    <span class="c">!-- Equations of state</span>
    <span class="c">!</span>

    <span class="k">TYPE</span><span class="p">(</span><span class="n">eos</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">all_eos</span>

    <span class="c">!</span>
    <span class="c">!-- Steering variables</span>
    <span class="c">!</span>

    <span class="c">!&gt; `.TRUE.` if the object is empty, `.FALSE.` if it&#39;s not empty</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">empty_object</span>
    <span class="c">!&amp; `.TRUE.` if the binary files for SPHINCS_BSSN are to be exported,</span>
    <span class="c">!  `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">export_bin</span>
    <span class="c">!&amp; `.TRUE.` if the ID in the formatted files is to be on the xy plane only,</span>
    <span class="c">!  `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">export_form_xy</span>
    <span class="c">!&amp; `.TRUE.` if the ID in the formatted files is to be on the x axis only,</span>
    <span class="c">!  `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">export_form_x</span>
    <span class="c">!&amp; `.TRUE.` if the threshold on the baryon mass density should e applied</span>
    <span class="c">!  when placing particles on lattices, `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">use_thres</span>
    <span class="c">!&amp; `.TRUE.` if the baryon number per particle should be reassigned, trying</span>
    <span class="c">!  to obtain a baryon number ratio no larger than nu_ratio,</span>
    <span class="c">!  when placing particles on lattices; `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">redistribute_nu</span>
    <span class="c">!&amp; `.TRUE.` if the baryon number per particle should be corrected to account</span>
    <span class="c">!  for the total baryon masses of the stars, `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">correct_nu</span>
    <span class="c">!&amp; `.TRUE.` if the electron fraction \(Y_e\) should be read from the CompOSE</span>
    <span class="c">!  table with extension.beta, `.FALSE.` otherwise</span>
    <span class="c">!  @todo Chamge name of this variable to assign_Ye_compose. Check that</span>
    <span class="c">!        the used EOS is indeed the one used to read \(Y_e\)</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">compose_eos</span>
    <span class="c">!&amp; `.TRUE.` if the particle positions on spherical surfaces are randomized</span>
    <span class="c">!  in the \(\phi\) direction, `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">randomize_phi</span>
    <span class="c">!&amp; `.TRUE.` if the particle positions on spherical surfaces are randomized</span>
    <span class="c">!  in the \(\theta\) direction, `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">randomize_theta</span>
    <span class="c">!&amp; `.TRUE.` if the particle positions on spherical surfaces are randomized</span>
    <span class="c">!  in the \(r\) direction, `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">randomize_r</span>
    <span class="c">!&amp; `.TRUE.` if the Artificial Pressure Method (APM) has to be applied to the</span>
    <span class="c">!  particles on star 1, `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">apm_iterate</span>
    <span class="c">!&amp; `.TRUE.` if the baryon number per particle \(\nu\) has to be read from the</span>
    <span class="c">!  formatted file containing the particle positions, `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">read_nu</span>
    <span class="c">!&amp; `.TRUE.` if the particles on star 2 should be the reflection of the</span>
    <span class="c">!  particles on star 1 with respect to the \(yz\) plane, only if the baryon</span>
    <span class="c">!  masses of the stars differe less than \(0.2\%\); `.FALSE.` otherwise</span>
    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">reflect_particles_x</span>

    <span class="c">!</span>
    <span class="c">!-- Timers</span>
    <span class="c">!</span>

    <span class="c">!&gt; Timer that times how long it takes to place particles on the stars</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">timer</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">placer_timer</span>
    <span class="c">!&amp; Timer that times how long it takes to check if there are multiple</span>
    <span class="c">!  particles at the same positions</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">timer</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">same_particle_timer</span>
    <span class="c">!&amp; Timer that times how long it takes to perform the APM on the matter</span>
    <span class="c">!  objects</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">timer</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">apm_timers</span>
    <span class="c">!&amp; Timer that times how long it takes to import the \(\texttt{|lorene|}\) ID</span>
    <span class="c">!  at the particle positions</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">timer</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">importer_timer</span>
    <span class="c">!&amp; Timer that times how long it takes to compute the SPH variables at the</span>
    <span class="c">!  particle pitions</span>
    <span class="k">TYPE</span><span class="p">(</span><span class="n">timer</span><span class="p">),</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">sph_computer_timer</span>


    <span class="k">CONTAINS</span>


    <span class="c">!-------------------!</span>
    <span class="c">!--  SUBROUTINES  --!</span>
    <span class="c">!-------------------!</span>

    <span class="k">PROCEDURE</span><span class="kd">::</span> <span class="n">place_particles_lattice</span>
    <span class="c">!! Places particles on a single lattice that surrounds both stars</span>

    <span class="k">PROCEDURE</span><span class="kd">::</span> <span class="n">place_particles_spherical_surfaces</span>
    <span class="c">!! Places particles on spherical surfaces on one star</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">NOPASS</span><span class="kd">::</span> <span class="n">impose_equatorial_plane_symmetry</span>
    <span class="c">!# Reflects the positions of the particles on a matter object with respect</span>
    <span class="c">!  to the \(xy\) plane</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">NOPASS</span><span class="kd">::</span> <span class="n">perform_apm</span>
    <span class="c">!! Performs the Artificial Pressure Method (APM) on one star&#39;s particles</span>

  <span class="c">!  GENERIC:: reshape_sph_field =&gt; reshape_sph_field_1d_ptr, &amp;</span>
  <span class="c">!                                 reshape_sph_field_2d_ptr</span>
  <span class="c">!  !# GENERIC PROCEDURE, overloded to reallocate 1d and 2d arrays</span>
  <span class="c">!  PROCEDURE:: reshape_sph_field_1d_ptr =&gt; reshape_sph_field_1d</span>
  <span class="c">!  !! Reallocates a 1d array</span>
  <span class="c">!  PROCEDURE:: reshape_sph_field_2d_ptr =&gt; reshape_sph_field_2d</span>
  <span class="c">!  !! Reallocates a 2d array</span>

    <span class="k">PROCEDURE</span><span class="kd">::</span> <span class="n">allocate_lorene_id_parts_memory</span>
    <span class="c">!! Allocates memory for the [[particles]] member arrays</span>

    <span class="k">PROCEDURE</span><span class="kd">::</span> <span class="n">deallocate_lorene_id_parts_memory</span>
    <span class="c">!! Deallocates memory for the [[particles]] member arrays</span>

    <span class="k">PROCEDURE</span><span class="kd">::</span> <span class="n">read_compose_composition</span>
    <span class="c">!! Reads the \(Y_e(n_b)\) table in the CompOSE file with extension .beta</span>

    <span class="k">PROCEDURE</span><span class="kd">::</span> <span class="n">compute_Ye</span>
    <span class="c">!# Interpates linearly the electron fraction \(Y_e\) at the particle</span>
    <span class="c">!  densities; that is, assigns \(Y_e\) at the particle positions</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">analyze_hydro</span>
    <span class="c">!# Scans the hydro fields taken from \(\texttt{|lorene|}\) to look</span>
    <span class="c">!  for negative or zero values</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">compute_and_export_SPH_variables</span>
    <span class="c">!# Computes the SPH variables at the particle positions, and optionally</span>
    <span class="c">!  prints them to a binary file to be read by \(\texttt{SPHINCS_BSSN}\)</span>
    <span class="c">!  and \(\texttt{splash}\), and to a formatted file to be read by</span>
    <span class="c">!  \(\texttt{gnuplot}\), by calling</span>
    <span class="c">!  [[particles:print_formatted_lorene_id_particles]]</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">read_sphincs_dump_print_formatted</span>
    <span class="c">!# Reads the binary ID file printed by</span>
    <span class="c">!  [[particles:compute_and_export_SPH_variables]]</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">print_formatted_lorene_id_particles</span>
    <span class="c">!! Prints the SPH ID to a formatted file</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">print_summary</span>
    <span class="c">!! Prints the SPH ID to a formatted file</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">is_empty</span>
    <span class="c">!# Returns `.TRUE` if the [[particles]] object is empty, `.FALSE` otherwise</span>
    <span class="c">!  @warning experimental, not actively used in the code yet</span>

    <span class="c">!PROCEDURE, PUBLIC:: write_lorene_bns_id_dump</span>

    <span class="c">!-----------------!</span>
    <span class="c">!--  FUNCTIONS  --!</span>
    <span class="c">!-----------------!</span>

    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_npart</span>
    <span class="c">!! Returns [[particles:npart]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_npart_i</span>
    <span class="c">!! Returns the number of particles on the object `i_matter`</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_nuratio</span>
    <span class="c">!! Returns [[particles:nuratio]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_nuratio_i</span>
    <span class="c">!! Returns the baryon number ratio on the object `i_matter`</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_pos</span>
    <span class="c">!! Returns [[particles:pos]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_vel</span>
    <span class="c">!! Returns [[particles:v]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_nlrf</span>
    <span class="c">!! Returns [[particles:nlrf]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_nu</span>
    <span class="c">!! Returns [[particles:nu]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_u</span>
    <span class="c">!! Returns [[particles:specific_energy_parts]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_pressure</span>
    <span class="c">!! Returns [[particles:pressure_parts]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_pressure_cu</span>
    <span class="c">!! Returns [[particles:pressure_parts_cu]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_theta</span>
    <span class="c">!! Returns [[particles:theta]]</span>
    <span class="k">PROCEDURE</span><span class="p">,</span> <span class="k">PUBLIC</span><span class="kd">::</span> <span class="n">get_h</span>
    <span class="c">!! Returns [[particles:h]]</span>

    <span class="k">FINAL</span><span class="kd">::</span> <span class="n">destruct_particles</span>
    <span class="c">!! Finalizer (Destructor) of [[particles]] object</span>

  <span class="k">END TYPE </span><span class="n">particles</span>
</pre></div>

    </section>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2021 <a rel="license" href="http://www.gnu.org/licenses/old-licenses/fdl-1.2.en.html">GNU Free Documentation License</a>
                                          </p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
             on 2021-11-14 16:41:50 
            
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>