<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>convergence_test &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.5</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>About</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>convergence_test    <small>Program</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="62.0% of total for programs.">712 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/convergence_test.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/convergence_test.f90.html'>convergence_test.f90</a></li>
     <li class="active">convergence_test</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../program/convergence_test.html#variable-bssn_forms">bssn_forms</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-debug~15">debug</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-dir_out">dir_out</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-execution_timer">execution_timer</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-exist~22">exist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-idata~2">idata</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-max_bssn">max_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-min_bssn">min_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-name_logfile~5">name_logfile</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn">namefile_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn_bin">namefile_bssn_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts">namefile_parts</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts_bin">namefile_parts_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_sph">namefile_sph</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-original_dx">original_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-particles_dist">particles_dist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-ratio_dx">ratio_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems">systems</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems_name">systems_name</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_known">cauchy_convergence_test_known</a>
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_unknown">cauchy_convergence_test_unknown</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../program/convergence_test.html#src">convergence_test</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      <li class="list-group-item">
  <ul class="list-inline">
    <li><a href='../module/sphincs_id_fuka.html'>sphincs_id_fuka</a></li>
    <li><a href='../module/bssn_formulation.html'>bssn_formulation</a></li>
    <li><a href='../module/standard_tpo_formulation.html'>standard_tpo_formulation</a></li>
    <li><a href='../module/sphincs_id_interpolate.html'>sphincs_id_interpolate</a></li>
    <li><a href='../module/utility.html'>utility</a></li>
    <li><a href='../module/sphincs_id_lorene.html'>sphincs_id_lorene</a></li>
    <li>IFPORT</li>
    <li><a href='../module/sph_particles.html'>sph_particles</a></li>
    <li>timing</li>
    <li><a href='../module/sphincs_id_full.html'>sphincs_id_full</a></li>
    <li><a href='../module/id_base.html'>id_base</a></li>
  </ul>
      </li>
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~convergence_test~~UsesGraph Pages: 1 -->
<svg id="programconvergence_testUsesGraph" width="641pt" height="545pt"
 viewBox="0.00 0.00 641.00 544.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~convergence_test~~UsesGraph" class="graph" transform="scale(1.25 1.25) rotate(0) translate(4 675.66)">
<title>program~~convergence_test~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-675.66 796,-675.66 796,4 -4,4"/>
<!-- program~convergence_test -->
<g id="program~~convergence_test~~UsesGraph_node1" class="node">
<title>program~convergence_test</title>
<polygon fill="none" stroke="black" points="792,-209.71 685,-209.71 685,-185.71 792,-185.71 792,-209.71"/>
<text text-anchor="middle" x="738.5" y="-195.31" font-family="Helvetica,sans-Serif" font-size="10.50">convergence_test</text>
</g>
<!-- module~sphincs_id_fuka -->
<g id="program~~convergence_test~~UsesGraph_node2" class="node">
<title>module~sphincs_id_fuka</title>
<g id="a_program~~convergence_test~~UsesGraph_node2"><a xlink:href=".././module/sphincs_id_fuka.html" xlink:title="sphincs_id_fuka">
<polygon fill="#337ab7" stroke="#337ab7" points="631,-251.71 536,-251.71 536,-227.71 631,-227.71 631,-251.71"/>
<text text-anchor="middle" x="583.5" y="-237.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_fuka</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_fuka -->
<g id="program~~convergence_test~~UsesGraph_edge1" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_fuka</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M693.66,-209.75C676.37,-214.49 656.35,-219.99 638.21,-224.97"/>
<polygon fill="#000000" stroke="#000000" points="637.07,-221.65 628.35,-227.67 638.92,-228.4 637.07,-221.65"/>
</g>
<!-- module~utility -->
<g id="program~~convergence_test~~UsesGraph_node3" class="node">
<title>module~utility</title>
<g id="a_program~~convergence_test~~UsesGraph_node3"><a xlink:href=".././module/utility.html" xlink:title="utility">
<polygon fill="#337ab7" stroke="#337ab7" points="154,-539.71 100,-539.71 100,-515.71 154,-515.71 154,-539.71"/>
<text text-anchor="middle" x="127" y="-525.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge2" class="edge">
<title>program~convergence_test&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M732.78,-209.74C700.78,-289.14 508.95,-732.73 244,-661.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-661.71C185.54,-652.11 150.63,-584.7 135.99,-549.3"/>
<polygon fill="#000000" stroke="#000000" points="139.18,-547.85 132.25,-539.84 132.68,-550.43 139.18,-547.85"/>
</g>
<!-- module~id_base -->
<g id="program~~convergence_test~~UsesGraph_node4" class="node">
<title>module~id_base</title>
<g id="a_program~~convergence_test~~UsesGraph_node4"><a xlink:href=".././module/id_base.html" xlink:title="id_base">
<polygon fill="#337ab7" stroke="#337ab7" points="154,-215.71 100,-215.71 100,-191.71 154,-191.71 154,-215.71"/>
<text text-anchor="middle" x="127" y="-201.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">id_base</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge3" class="edge">
<title>program~convergence_test&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M582.5,-115.71C497.52,-104.67 493.61,-201.42 408,-197.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406,-197.71C334.05,-194.59 315.74,-200.05 244,-193.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-193.71C216.03,-191.42 186.73,-194.1 164.34,-197.27"/>
<polygon fill="#000000" stroke="#000000" points="163.63,-193.83 154.26,-198.79 164.67,-200.76 163.63,-193.83"/>
</g>
<!-- module~sphincs_id_interpolate -->
<g id="program~~convergence_test~~UsesGraph_node5" class="node">
<title>module~sphincs_id_interpolate</title>
<g id="a_program~~convergence_test~~UsesGraph_node5"><a xlink:href=".././module/sphincs_id_interpolate.html" xlink:title="sphincs_id_interpolate">
<polygon fill="#337ab7" stroke="#337ab7" points="649,-209.71 518,-209.71 518,-185.71 649,-185.71 649,-209.71"/>
<text text-anchor="middle" x="583.5" y="-195.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_interpolate</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_interpolate -->
<g id="program~~convergence_test~~UsesGraph_edge4" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_interpolate</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M684.85,-197.71C676.58,-197.71 667.91,-197.71 659.26,-197.71"/>
<polygon fill="#000000" stroke="#000000" points="659.15,-194.21 649.15,-197.71 659.15,-201.21 659.15,-194.21"/>
</g>
<!-- module~standard_tpo_formulation -->
<g id="program~~convergence_test~~UsesGraph_node6" class="node">
<title>module~standard_tpo_formulation</title>
<g id="a_program~~convergence_test~~UsesGraph_node6"><a xlink:href=".././module/standard_tpo_formulation.html" xlink:title="standard_tpo_formulation">
<polygon fill="#337ab7" stroke="#337ab7" points="482,-127.71 332,-127.71 332,-103.71 482,-103.71 482,-127.71"/>
<text text-anchor="middle" x="407" y="-113.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">standard_tpo_formulation</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~standard_tpo_formulation -->
<g id="program~~convergence_test~~UsesGraph_edge5" class="edge">
<title>program~convergence_test&#45;&gt;module~standard_tpo_formulation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M723.72,-185.66C707.05,-171.64 677.66,-148.65 649,-134.71 622.12,-121.64 614.14,-119.56 584.5,-115.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M582.5,-115.71C553.21,-111.91 520.91,-111 492.16,-111.34"/>
<polygon fill="#000000" stroke="#000000" points="492.08,-107.84 482.14,-111.5 492.2,-114.84 492.08,-107.84"/>
</g>
<!-- module~sphincs_id_lorene -->
<g id="program~~convergence_test~~UsesGraph_node7" class="node">
<title>module~sphincs_id_lorene</title>
<g id="a_program~~convergence_test~~UsesGraph_node7"><a xlink:href=".././module/sphincs_id_lorene.html" xlink:title="sphincs_id_lorene">
<polygon fill="#337ab7" stroke="#337ab7" points="636.5,-293.71 530.5,-293.71 530.5,-269.71 636.5,-269.71 636.5,-293.71"/>
<text text-anchor="middle" x="583.5" y="-279.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_lorene</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge6" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M723.35,-209.87C706.57,-223.78 677.3,-246.46 649,-260.71 645.27,-262.59 641.34,-264.35 637.33,-265.99"/>
<polygon fill="#000000" stroke="#000000" points="636,-262.75 627.91,-269.59 638.5,-269.29 636,-262.75"/>
</g>
<!-- IFPORT -->
<g id="program~~convergence_test~~UsesGraph_node8" class="node">
<title>IFPORT</title>
<polygon fill="#337ab7" stroke="#337ab7" points="610.5,-167.71 556.5,-167.71 556.5,-143.71 610.5,-143.71 610.5,-167.71"/>
<text text-anchor="middle" x="583.5" y="-153.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IFPORT</text>
</g>
<!-- program~convergence_test&#45;&gt;IFPORT -->
<g id="program~~convergence_test~~UsesGraph_edge7" class="edge">
<title>program~convergence_test&#45;&gt;IFPORT</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M693.66,-185.68C670.48,-179.32 642.39,-171.6 620.5,-165.6"/>
<polygon fill="#000000" stroke="#000000" points="621.19,-162.15 610.62,-162.88 619.33,-168.9 621.19,-162.15"/>
</g>
<!-- module~bssn_formulation -->
<g id="program~~convergence_test~~UsesGraph_node9" class="node">
<title>module~bssn_formulation</title>
<g id="a_program~~convergence_test~~UsesGraph_node9"><a xlink:href=".././module/bssn_formulation.html" xlink:title="bssn_formulation">
<polygon fill="#337ab7" stroke="#337ab7" points="635.5,-87.71 531.5,-87.71 531.5,-63.71 635.5,-63.71 635.5,-87.71"/>
<text text-anchor="middle" x="583.5" y="-73.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bssn_formulation</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~bssn_formulation -->
<g id="program~~convergence_test~~UsesGraph_edge8" class="edge">
<title>program~convergence_test&#45;&gt;module~bssn_formulation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M729.05,-185.48C714.69,-165.5 683.69,-125.68 649,-101.71 643.72,-98.06 637.85,-94.81 631.87,-91.94"/>
<polygon fill="#000000" stroke="#000000" points="632.99,-88.61 622.43,-87.76 630.16,-95.01 632.99,-88.61"/>
</g>
<!-- timing -->
<g id="program~~convergence_test~~UsesGraph_node10" class="node">
<title>timing</title>
<polygon fill="#337ab7" stroke="#337ab7" points="59,-235.71 5,-235.71 5,-211.71 59,-211.71 59,-235.71"/>
<text text-anchor="middle" x="32" y="-221.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timing</text>
</g>
<!-- program~convergence_test&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge9" class="edge">
<title>program~convergence_test&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-661.71C192.05,-653.22 171.96,-686.9 128,-661.71"/>
</g>
<!-- module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_node11" class="node">
<title>module~sph_particles</title>
<g id="a_program~~convergence_test~~UsesGraph_node11"><a xlink:href=".././module/sph_particles.html" xlink:title="sph_particles">
<polygon fill="#337ab7" stroke="#337ab7" points="284,-47.71 202,-47.71 202,-23.71 284,-23.71 284,-47.71"/>
<text text-anchor="middle" x="243" y="-33.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sph_particles</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_edge10" class="edge">
<title>program~convergence_test&#45;&gt;module~sph_particles</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M734.13,-185.3C725.55,-156.36 699.83,-84.62 649,-54.71 536.71,11.34 375.09,-8.18 294.17,-24.07"/>
<polygon fill="#000000" stroke="#000000" points="293.34,-20.67 284.24,-26.08 294.73,-27.53 293.34,-20.67"/>
</g>
<!-- module~sphincs_id_full -->
<g id="program~~convergence_test~~UsesGraph_node12" class="node">
<title>module~sphincs_id_full</title>
<g id="a_program~~convergence_test~~UsesGraph_node12"><a xlink:href=".././module/sphincs_id_full.html" xlink:title="sphincs_id_full">
<polygon fill="#337ab7" stroke="#337ab7" points="628,-335.71 539,-335.71 539,-311.71 628,-311.71 628,-335.71"/>
<text text-anchor="middle" x="583.5" y="-321.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_full</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_full -->
<g id="program~~convergence_test~~UsesGraph_edge11" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_full</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M730.38,-210.01C717.12,-231.83 686.57,-277.41 649,-302.71 645.43,-305.12 641.56,-307.26 637.56,-309.18"/>
<polygon fill="#000000" stroke="#000000" points="635.87,-306.09 628.03,-313.23 638.61,-312.53 635.87,-306.09"/>
</g>
<!-- module~sphincs_id_fuka&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge12" class="edge">
<title>module~sphincs_id_fuka&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M540.58,-227.66C497.57,-215.64 433.45,-198.82 408,-197.71"/>
</g>
<!-- module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_node16" class="node">
<title>module~ejecta_generic</title>
<g id="a_program~~convergence_test~~UsesGraph_node16"><a xlink:href=".././module/ejecta_generic.html" xlink:title="ejecta_generic">
<polygon fill="#337ab7" stroke="#337ab7" points="452.5,-249.71 361.5,-249.71 361.5,-225.71 452.5,-225.71 452.5,-249.71"/>
<text text-anchor="middle" x="407" y="-235.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ejecta_generic</text>
</a>
</g>
</g>
<!-- module~sphincs_id_fuka&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge13" class="edge">
<title>module~sphincs_id_fuka&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M535.74,-239.18C513.31,-238.92 486.3,-238.61 462.91,-238.34"/>
<polygon fill="#000000" stroke="#000000" points="462.82,-234.84 452.78,-238.23 462.74,-241.84 462.82,-234.84"/>
</g>
<!-- module~bns_fuka -->
<g id="program~~convergence_test~~UsesGraph_node19" class="node">
<title>module~bns_fuka</title>
<g id="a_program~~convergence_test~~UsesGraph_node19"><a xlink:href=".././module/bns_fuka.html" xlink:title="bns_fuka">
<polygon fill="#337ab7" stroke="#337ab7" points="436.5,-332.71 377.5,-332.71 377.5,-308.71 436.5,-308.71 436.5,-332.71"/>
<text text-anchor="middle" x="407" y="-318.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bns_fuka</text>
</a>
</g>
</g>
<!-- module~sphincs_id_fuka&#45;&gt;module~bns_fuka -->
<g id="program~~convergence_test~~UsesGraph_edge14" class="edge">
<title>module~sphincs_id_fuka&#45;&gt;module~bns_fuka</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M541.48,-251.81C533.59,-254.49 525.46,-257.5 518,-260.71 489.33,-273.07 458.24,-290.43 436.45,-303.29"/>
<polygon fill="#000000" stroke="#000000" points="434.51,-300.38 427.72,-308.51 438.1,-306.39 434.51,-300.38"/>
</g>
<!-- matrix -->
<g id="program~~convergence_test~~UsesGraph_node13" class="node">
<title>matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="59,-518.71 5,-518.71 5,-494.71 59,-494.71 59,-518.71"/>
<text text-anchor="middle" x="32" y="-504.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrix</text>
</g>
<!-- module~utility&#45;&gt;matrix -->
<g id="program~~convergence_test~~UsesGraph_edge15" class="edge">
<title>module~utility&#45;&gt;matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M99.6,-521.75C90.09,-519.6 79.2,-517.14 69.02,-514.84"/>
<polygon fill="#000000" stroke="#000000" points="69.67,-511.4 59.15,-512.62 68.13,-518.23 69.67,-511.4"/>
</g>
<!-- constants -->
<g id="program~~convergence_test~~UsesGraph_node15" class="node">
<title>constants</title>
<polygon fill="#337ab7" stroke="#337ab7" points="64,-560.71 0,-560.71 0,-536.71 64,-536.71 64,-560.71"/>
<text text-anchor="middle" x="32" y="-546.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">constants</text>
</g>
<!-- module~utility&#45;&gt;constants -->
<g id="program~~convergence_test~~UsesGraph_edge16" class="edge">
<title>module~utility&#45;&gt;constants</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M99.6,-533.67C91.65,-535.47 82.73,-537.48 74.06,-539.44"/>
<polygon fill="#000000" stroke="#000000" points="73.06,-536.08 64.08,-541.69 74.6,-542.91 73.06,-536.08"/>
</g>
<!-- module~id_base&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge17" class="edge">
<title>module~id_base&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M99.6,-209.39C90.09,-211.43 79.2,-213.78 69.02,-215.97"/>
<polygon fill="#000000" stroke="#000000" points="68.19,-212.57 59.15,-218.09 69.66,-219.41 68.19,-212.57"/>
</g>
<!-- module~sphincs_id_interpolate&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge18" class="edge">
<title>module~sphincs_id_interpolate&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M517.83,-199.04C484.93,-199.38 444.32,-199.29 408,-197.71"/>
</g>
<!-- module~sphincs_id_interpolate&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge19" class="edge">
<title>module~sphincs_id_interpolate&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M530.14,-209.71C508.82,-214.6 484.18,-220.25 462.63,-225.19"/>
<polygon fill="#000000" stroke="#000000" points="461.62,-221.83 452.65,-227.48 463.18,-228.65 461.62,-221.83"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge20" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M395.85,-127.94C380.79,-146.42 352.14,-182.91 332,-216.71 312.87,-248.82 316.82,-261.68 296,-292.71 276.89,-321.19 267.34,-324.59 244,-349.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-349.71C218.66,-374.84 209.55,-378.54 190,-406.71 167.41,-439.27 147.79,-481.16 136.95,-506.14"/>
<polygon fill="#000000" stroke="#000000" points="133.69,-504.86 132.99,-515.44 140.13,-507.61 133.69,-504.86"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge21" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-155.71C212.36,-161.75 180.82,-175.67 158.44,-186.98"/>
<polygon fill="#000000" stroke="#000000" points="156.72,-183.93 149.45,-191.64 159.94,-190.15 156.72,-183.93"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge22" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.53,-127.74C329.11,-136.26 284.03,-147.57 244,-155.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-155.71C192.16,-165.86 168.33,-114.72 128,-145.71"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_edge23" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;module~sph_particles</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M366.58,-103.6C355.22,-99.65 342.94,-94.92 332,-89.71 310.08,-79.28 286.73,-64.78 269.6,-53.43"/>
<polygon fill="#000000" stroke="#000000" points="271.5,-50.49 261.24,-47.82 267.59,-56.3 271.5,-50.49"/>
</g>
<!-- mesh_refinement -->
<g id="program~~convergence_test~~UsesGraph_node18" class="node">
<title>mesh_refinement</title>
<polygon fill="#337ab7" stroke="#337ab7" points="296,-127.71 190,-127.71 190,-103.71 296,-103.71 296,-127.71"/>
<text text-anchor="middle" x="243" y="-113.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mesh_refinement</text>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;mesh_refinement -->
<g id="program~~convergence_test~~UsesGraph_edge24" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;mesh_refinement</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M331.64,-115.71C323.22,-115.71 314.7,-115.71 306.45,-115.71"/>
<polygon fill="#000000" stroke="#000000" points="306.18,-112.21 296.18,-115.71 306.18,-119.21 306.18,-112.21"/>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge25" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.87,-269.69C528.93,-267.2 523.15,-264.24 518,-260.71 497.15,-246.45 503.3,-230.31 482,-216.71 453.38,-198.44 441.92,-199.18 408,-197.71"/>
</g>
<!-- module~diffstar_lorene -->
<g id="program~~convergence_test~~UsesGraph_node14" class="node">
<title>module~diffstar_lorene</title>
<g id="a_program~~convergence_test~~UsesGraph_node14"><a xlink:href=".././module/diffstar_lorene.html" xlink:title="diffstar_lorene">
<polygon fill="#337ab7" stroke="#337ab7" points="451.5,-459.71 362.5,-459.71 362.5,-435.71 451.5,-435.71 451.5,-459.71"/>
<text text-anchor="middle" x="407" y="-445.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diffstar_lorene</text>
</a>
</g>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~diffstar_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge27" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~diffstar_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M531.3,-293.76C526.48,-296.21 521.94,-299.16 518,-302.71 488.74,-329.09 505.46,-352.07 482,-383.71 468.77,-401.56 449.74,-417.87 434.3,-429.56"/>
<polygon fill="#000000" stroke="#000000" points="432.12,-426.82 426.14,-435.56 436.27,-432.45 432.12,-426.82"/>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge28" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.82,-269.69C512.39,-264.03 485.54,-257.26 462.33,-251.41"/>
<polygon fill="#000000" stroke="#000000" points="463.18,-248.02 452.63,-248.96 461.47,-254.8 463.18,-248.02"/>
</g>
<!-- module~bns_lorene -->
<g id="program~~convergence_test~~UsesGraph_node17" class="node">
<title>module~bns_lorene</title>
<g id="a_program~~convergence_test~~UsesGraph_node17"><a xlink:href=".././module/bns_lorene.html" xlink:title="bns_lorene">
<polygon fill="#337ab7" stroke="#337ab7" points="442,-374.71 372,-374.71 372,-350.71 442,-350.71 442,-374.71"/>
<text text-anchor="middle" x="407" y="-360.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bns_lorene</text>
</a>
</g>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~bns_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge26" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~bns_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M535.74,-293.76C529.54,-296.25 523.45,-299.22 518,-302.71 498.14,-315.44 502.1,-329.36 482,-341.71 472.86,-347.33 462.17,-351.49 451.8,-354.55"/>
<polygon fill="#000000" stroke="#000000" points="450.78,-351.2 442.02,-357.16 452.59,-357.96 450.78,-351.2"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge29" class="edge">
<title>module~bssn_formulation&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M534.92,-87.73C528.39,-91.25 522.41,-95.82 518,-101.71 419.77,-232.91 564.5,-327.1 482,-468.71 431.1,-556.08 392.39,-569.17 296,-599.71 251.09,-613.94 232.82,-619.35 190,-599.71 167.35,-589.33 149.85,-566.14 139.3,-548.86"/>
<polygon fill="#000000" stroke="#000000" points="142.21,-546.9 134.17,-539.99 136.15,-550.4 142.21,-546.9"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge30" class="edge">
<title>module~bssn_formulation&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406,-75.71C309.81,-69.87 270.8,-42.19 190,-94.71 162.31,-112.71 170.4,-131.05 154,-159.71 149.66,-167.29 144.82,-175.55 140.49,-182.84"/>
<polygon fill="#000000" stroke="#000000" points="137.48,-181.05 135.38,-191.44 143.5,-184.63 137.48,-181.05"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~standard_tpo_formulation -->
<g id="program~~convergence_test~~UsesGraph_edge31" class="edge">
<title>module~bssn_formulation&#45;&gt;module~standard_tpo_formulation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M531.09,-87.5C512.08,-91.85 490.33,-96.84 470.45,-101.4"/>
<polygon fill="#000000" stroke="#000000" points="469.52,-98.02 460.56,-103.66 471.08,-104.84 469.52,-98.02"/>
</g>
<!-- module~bssn_formulation&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge32" class="edge">
<title>module~bssn_formulation&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M531.3,-77.28C496.5,-77.97 449.43,-78.14 408,-75.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406,-75.71C350.19,-72.45 350.12,-28.71 296,-14.71 250.39,-2.91 229.81,10.49 190,-14.71 135.58,-49.17 179.08,-106.46 128,-145.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M126,-145.71C100.45,-164.88 72.55,-188.69 54.05,-204.93"/>
<polygon fill="#000000" stroke="#000000" points="51.67,-202.36 46.48,-211.6 56.3,-207.61 51.67,-202.36"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_edge33" class="edge">
<title>module~bssn_formulation&#45;&gt;module~sph_particles</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406,-75.71C364.86,-73.21 319.41,-61.14 287.14,-50.9"/>
<polygon fill="#000000" stroke="#000000" points="288.17,-47.55 277.58,-47.79 286.01,-54.21 288.17,-47.55"/>
</g>
<!-- module~bssn_formulation&#45;&gt;mesh_refinement -->
<g id="program~~convergence_test~~UsesGraph_edge34" class="edge">
<title>module~bssn_formulation&#45;&gt;mesh_refinement</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M406,-75.71C362.11,-73.05 313.31,-87.61 280.85,-99.9"/>
<polygon fill="#000000" stroke="#000000" points="279.37,-96.72 271.33,-103.62 281.92,-103.24 279.37,-96.72"/>
</g>
<!-- module~sph_particles&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge36" class="edge">
<title>module~sph_particles&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M227.05,-48.12C214.96,-59.06 198.58,-76.12 190,-94.71 155.58,-169.31 135.05,-427.1 129.52,-505.15"/>
<polygon fill="#000000" stroke="#000000" points="126.02,-505.1 128.82,-515.31 133,-505.58 126.02,-505.1"/>
</g>
<!-- module~sph_particles&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge35" class="edge">
<title>module~sph_particles&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M208.61,-47.72C201.77,-51.38 195.11,-55.99 190,-61.71 159.07,-96.3 173.88,-117.79 154,-159.71 150.26,-167.6 145.55,-175.93 141.17,-183.19"/>
<polygon fill="#000000" stroke="#000000" points="138.19,-181.37 135.9,-191.71 144.14,-185.05 138.19,-181.37"/>
</g>
<!-- module~sph_particles&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge37" class="edge">
<title>module~sph_particles&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M211.91,-47.76C204.32,-51.58 196.49,-56.25 190,-61.71 154.49,-91.58 164.79,-117.44 128,-145.71"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge38" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.83,-313.09C469.45,-296.11 340.91,-264.2 332,-258.71 311.35,-245.99 315.43,-232.22 296,-217.71 275.6,-202.48 269.36,-195.95 244,-193.71"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~diffstar_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge39" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~diffstar_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M565.45,-335.83C534.7,-357.68 469.78,-403.81 433.65,-429.49"/>
<polygon fill="#000000" stroke="#000000" points="431.24,-426.9 425.12,-435.55 435.3,-432.61 431.24,-426.9"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge40" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.79,-312.86C531.55,-310.13 524.35,-306.78 518,-302.71 498.14,-289.98 501.71,-276.67 482,-263.71 475.9,-259.7 469.11,-256.23 462.18,-253.25"/>
<polygon fill="#000000" stroke="#000000" points="463.29,-249.92 452.71,-249.48 460.7,-256.43 463.29,-249.92"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~bns_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge41" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~bns_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.92,-333.45C512.33,-339.39 478.46,-346.97 451.83,-352.92"/>
<polygon fill="#000000" stroke="#000000" points="451,-349.51 442.01,-355.11 452.53,-356.35 451,-349.51"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~bns_fuka -->
<g id="program~~convergence_test~~UsesGraph_edge42" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~bns_fuka</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M538.92,-322.96C510.67,-322.48 474.19,-321.85 446.91,-321.38"/>
<polygon fill="#000000" stroke="#000000" points="446.64,-317.88 436.58,-321.2 446.52,-324.87 446.64,-317.88"/>
</g>
<!-- module~diffstar_lorene&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge44" class="edge">
<title>module~diffstar_lorene&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M396.88,-459.79C379.4,-482.29 339.04,-531.12 296,-561.71 275.25,-576.46 267.56,-576.07 244,-585.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-585.71C206.7,-600.16 167.46,-569.11 145.45,-547.12"/>
<polygon fill="#000000" stroke="#000000" points="147.87,-544.59 138.41,-539.8 142.82,-549.44 147.87,-544.59"/>
</g>
<!-- module~diffstar_lorene&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge43" class="edge">
<title>module~diffstar_lorene&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.02,-459.72C326.39,-474.36 241.17,-492.16 190,-448.71 114.81,-384.87 199.04,-317.47 154,-229.71 152.93,-227.64 151.64,-225.62 150.21,-223.7"/>
<polygon fill="#000000" stroke="#000000" points="152.55,-221.06 143.31,-215.88 147.31,-225.7 152.55,-221.06"/>
</g>
<!-- module~diffstar_lorene&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge47" class="edge">
<title>module~diffstar_lorene&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-585.71C185.64,-608.78 180.84,-691.99 128,-661.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M126,-661.71C88.93,-640.47 46.94,-332.64 35.82,-246.16"/>
<polygon fill="#000000" stroke="#000000" points="39.28,-245.59 34.54,-236.11 32.33,-246.47 39.28,-245.59"/>
</g>
<!-- module~diffstar_base -->
<g id="program~~convergence_test~~UsesGraph_node20" class="node">
<title>module~diffstar_base</title>
<g id="a_program~~convergence_test~~UsesGraph_node20"><a xlink:href=".././module/diffstar_base.html" xlink:title="diffstar_base">
<polygon fill="#337ab7" stroke="#337ab7" points="283.5,-519.71 202.5,-519.71 202.5,-495.71 283.5,-495.71 283.5,-519.71"/>
<text text-anchor="middle" x="243" y="-505.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diffstar_base</text>
</a>
</g>
</g>
<!-- module~diffstar_lorene&#45;&gt;module~diffstar_base -->
<g id="program~~convergence_test~~UsesGraph_edge45" class="edge">
<title>module~diffstar_lorene&#45;&gt;module~diffstar_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M373.22,-459.85C348.1,-469.16 313.26,-482.06 286.09,-492.12"/>
<polygon fill="#000000" stroke="#000000" points="284.62,-488.94 276.46,-495.69 287.05,-495.5 284.62,-488.94"/>
</g>
<!-- iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_node22" class="node">
<title>iso_c_binding</title>
<g id="a_program~~convergence_test~~UsesGraph_node22"><a xlink:href="http://fortranwiki.org/fortran/show/iso_c_binding" xlink:title="iso_c_binding">
<polygon fill="#337ab7" stroke="#337ab7" points="285,-439.71 201,-439.71 201,-415.71 285,-415.71 285,-439.71"/>
<text text-anchor="middle" x="243" y="-425.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_c_binding</text>
</a>
</g>
</g>
<!-- module~diffstar_lorene&#45;&gt;iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_edge46" class="edge">
<title>module~diffstar_lorene&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M362.16,-442.3C341.45,-439.74 316.61,-436.68 295.05,-434.01"/>
<polygon fill="#000000" stroke="#000000" points="295.44,-430.54 285.09,-432.78 294.58,-437.48 295.44,-430.54"/>
</g>
<!-- module~ejecta_generic&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge49" class="edge">
<title>module~ejecta_generic&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M382.15,-249.84C348.26,-267.98 285.65,-304.87 244,-349.71"/>
</g>
<!-- module~ejecta_generic&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge48" class="edge">
<title>module~ejecta_generic&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.86,-225.68C327.96,-213.39 267.88,-195.82 244,-193.71"/>
</g>
<!-- module~bns_lorene&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge51" class="edge">
<title>module~bns_lorene&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M387.14,-374.8C370.52,-386.33 346.74,-405.1 332,-426.71 304.91,-466.43 335.24,-500.95 296,-528.71 257.48,-555.97 200.55,-548.37 163.86,-539.09"/>
<polygon fill="#000000" stroke="#000000" points="164.65,-535.68 154.08,-536.46 162.83,-542.44 164.65,-535.68"/>
</g>
<!-- module~bns_lorene&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge50" class="edge">
<title>module~bns_lorene&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M371.85,-354.91C318.38,-342.17 218.08,-315.98 190,-292.71 165.17,-272.14 173.57,-255.34 154,-229.71 152.37,-227.58 150.58,-225.45 148.72,-223.38"/>
<polygon fill="#000000" stroke="#000000" points="150.87,-220.56 141.41,-215.78 145.82,-225.41 150.87,-220.56"/>
</g>
<!-- module~bns_lorene&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge54" class="edge">
<title>module~bns_lorene&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M371.86,-364.82C326.85,-365.98 246.75,-362.34 190,-327.71 150.39,-303.55 171.39,-260.16 128,-243.71"/>
</g>
<!-- module~bns_base -->
<g id="program~~convergence_test~~UsesGraph_node21" class="node">
<title>module~bns_base</title>
<g id="a_program~~convergence_test~~UsesGraph_node21"><a xlink:href=".././module/bns_base.html" xlink:title="bns_base">
<polygon fill="#337ab7" stroke="#337ab7" points="274,-283.71 212,-283.71 212,-259.71 274,-259.71 274,-283.71"/>
<text text-anchor="middle" x="243" y="-269.31" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bns_base</text>
</a>
</g>
</g>
<!-- module~bns_lorene&#45;&gt;module~bns_base -->
<g id="program~~convergence_test~~UsesGraph_edge52" class="edge">
<title>module~bns_lorene&#45;&gt;module~bns_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M371.74,-357.53C358.56,-354.41 343.83,-349.48 332,-341.71 310.88,-327.85 315.74,-313.49 296,-297.71 291.92,-294.45 287.36,-291.44 282.68,-288.72"/>
<polygon fill="#000000" stroke="#000000" points="284.1,-285.51 273.64,-283.85 280.78,-291.67 284.1,-285.51"/>
</g>
<!-- module~bns_lorene&#45;&gt;iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_edge53" class="edge">
<title>module~bns_lorene&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M375.91,-374.79C349.88,-385.23 312.06,-400.41 283.58,-411.83"/>
<polygon fill="#000000" stroke="#000000" points="281.91,-408.73 273.93,-415.7 284.51,-415.23 281.91,-408.73"/>
</g>
<!-- module~bns_fuka&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge56" class="edge">
<title>module~bns_fuka&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M377.2,-316.52C340.52,-312.98 277.84,-313.29 244,-349.71"/>
</g>
<!-- module~bns_fuka&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge55" class="edge">
<title>module~bns_fuka&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M377.37,-313.02C362.95,-308.31 345.67,-301.3 332,-291.71 312.15,-277.78 316.01,-264.41 296,-250.71 275.7,-236.81 267.63,-238.58 244,-231.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-231.71C216.21,-224.21 186.75,-217.01 164.24,-211.79"/>
<polygon fill="#000000" stroke="#000000" points="164.96,-208.36 154.43,-209.54 163.39,-215.19 164.96,-208.36"/>
</g>
<!-- module~bns_fuka&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge59" class="edge">
<title>module~bns_fuka&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M242,-231.71C193.08,-217.48 175.64,-261.77 128,-243.71"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M126,-243.71C107.97,-236.88 87.04,-232.11 69.6,-228.96"/>
<polygon fill="#000000" stroke="#000000" points="69.7,-225.43 59.26,-227.2 68.53,-232.33 69.7,-225.43"/>
</g>
<!-- module~bns_fuka&#45;&gt;module~bns_base -->
<g id="program~~convergence_test~~UsesGraph_edge57" class="edge">
<title>module~bns_fuka&#45;&gt;module~bns_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M377.41,-312.06C351.49,-304.22 313.02,-292.59 284.04,-283.82"/>
<polygon fill="#000000" stroke="#000000" points="284.81,-280.4 274.23,-280.85 282.79,-287.1 284.81,-280.4"/>
</g>
<!-- module~bns_fuka&#45;&gt;iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_edge58" class="edge">
<title>module~bns_fuka&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M377.28,-325.39C362.99,-328.56 345.87,-333.68 332,-341.71 302.54,-358.79 275.64,-387.94 259.55,-407.51"/>
<polygon fill="#000000" stroke="#000000" points="256.66,-405.51 253.14,-415.5 262.12,-409.89 256.66,-405.51"/>
</g>
<!-- module~diffstar_base&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge61" class="edge">
<title>module~diffstar_base&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M202.45,-514.65C190.11,-516.82 176.57,-519.19 164.46,-521.32"/>
<polygon fill="#000000" stroke="#000000" points="163.49,-517.93 154.25,-523.11 164.7,-524.83 163.49,-517.93"/>
</g>
<!-- module~diffstar_base&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge60" class="edge">
<title>module~diffstar_base&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M206.35,-495.71C200.06,-492.11 194.19,-487.53 190,-481.71 123.85,-389.93 204.6,-330.9 154,-229.71 152.96,-227.62 151.68,-225.6 150.26,-223.67"/>
<polygon fill="#000000" stroke="#000000" points="152.61,-221.05 143.38,-215.85 147.36,-225.67 152.61,-221.05"/>
</g>
<!-- module~bns_base&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge63" class="edge">
<title>module~bns_base&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M229.72,-283.93C218.07,-296.11 200.79,-315.83 190,-335.71 158.95,-392.9 140.32,-468.2 132.43,-505.21"/>
<polygon fill="#000000" stroke="#000000" points="128.92,-504.9 130.32,-515.4 135.77,-506.32 128.92,-504.9"/>
</g>
<!-- module~bns_base&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge62" class="edge">
<title>module~bns_base&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M216.25,-259.67C207.77,-255.49 198.36,-250.61 190,-245.71 177.43,-238.35 163.98,-229.39 152.84,-221.64"/>
<polygon fill="#000000" stroke="#000000" points="154.65,-218.63 144.46,-215.73 150.62,-224.35 154.65,-218.63"/>
</g>
</g>
</svg>
</div><script>var panprogramconvergence_testUsesGraph = svgPanZoom('#programconvergence_testUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      </ul>
    </div>

    <p>Make a convergence test to check the validity of
  the code \(\texttt{SPHINCS_ID}\).</p>
<p>FT 8.12.2020</p>
<hr>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~convergence_test~~CallsGraph Pages: 1 -->
<svg id="programconvergence_testCallsGraph" width="641pt" height="348pt"
 viewBox="0.00 0.00 641.00 347.53" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~convergence_test~~CallsGraph" class="graph" transform="scale(2.5 2.5) rotate(0) translate(4 864)">
<title>program~~convergence_test~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-864 1597,-864 1597,4 -4,4"/>
<!-- program~convergence_test -->
<g id="program~~convergence_test~~CallsGraph_node1" class="node">
<title>program~convergence_test</title>
<polygon fill="none" stroke="black" points="107,-236 0,-236 0,-212 107,-212 107,-236"/>
<text text-anchor="middle" x="53.5" y="-221.6" font-family="Helvetica,sans-Serif" font-size="10.50">convergence_test</text>
</g>
<!-- proc~cauchy_convergence_test_known -->
<g id="program~~convergence_test~~CallsGraph_node2" class="node">
<title>proc~cauchy_convergence_test_known</title>
<g id="a_program~~convergence_test~~CallsGraph_node2"><a xlink:href=".././proc/cauchy_convergence_test_known.html" xlink:title="cauchy_convergence_test_known">
<polygon fill="#d9534f" stroke="#d9534f" points="340,-380 150,-380 150,-356 340,-356 340,-380"/>
<text text-anchor="middle" x="245" y="-365.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cauchy_convergence_test_known</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~cauchy_convergence_test_known -->
<g id="program~~convergence_test~~CallsGraph_edge1" class="edge">
<title>program~convergence_test&#45;&gt;proc~cauchy_convergence_test_known</title>
<path fill="none" stroke="#000000" d="M59.51,-236.09C70.56,-261.15 99.54,-318.77 143,-347 145.62,-348.7 148.35,-350.27 151.17,-351.71"/>
<polygon fill="#000000" stroke="#000000" points="149.86,-354.96 160.41,-355.91 152.75,-348.59 149.86,-354.96"/>
</g>
<!-- proc~read_sphincs_id_parameters -->
<g id="program~~convergence_test~~CallsGraph_node3" class="node">
<title>proc~read_sphincs_id_parameters</title>
<g id="a_program~~convergence_test~~CallsGraph_node3"><a xlink:href=".././proc/read_sphincs_id_parameters.html" xlink:title="read_sphincs_id_parameters">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-338 163,-338 163,-314 327,-314 327,-338"/>
<text text-anchor="middle" x="245" y="-323.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_sphincs_id_parameters</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~read_sphincs_id_parameters -->
<g id="program~~convergence_test~~CallsGraph_edge2" class="edge">
<title>program~convergence_test&#45;&gt;proc~read_sphincs_id_parameters</title>
<path fill="none" stroke="#000000" d="M63.95,-236.06C78.76,-254.07 109.26,-287.73 143,-305 147.01,-307.05 151.21,-308.9 155.51,-310.57"/>
<polygon fill="#000000" stroke="#000000" points="154.5,-313.93 165.09,-313.95 156.82,-307.33 154.5,-313.93"/>
</g>
<!-- interface~bssn -->
<g id="program~~convergence_test~~CallsGraph_node4" class="node">
<title>interface~bssn</title>
<g id="a_program~~convergence_test~~CallsGraph_node4"><a xlink:href=".././interface/bssn.html" xlink:title="bssn">
<polygon fill="#a7506f" stroke="#a7506f" points="272,-216 218,-216 218,-192 272,-192 272,-216"/>
<text text-anchor="middle" x="245" y="-201.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bssn</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;interface~bssn -->
<g id="program~~convergence_test~~CallsGraph_edge3" class="edge">
<title>program~convergence_test&#45;&gt;interface~bssn</title>
<path fill="none" stroke="#000000" d="M107.03,-218.46C139.13,-215.07 179.35,-210.82 207.88,-207.81"/>
<polygon fill="#000000" stroke="#000000" points="208.25,-211.29 217.83,-206.76 207.51,-204.33 208.25,-211.29"/>
</g>
<!-- interface~particles -->
<g id="program~~convergence_test~~CallsGraph_node5" class="node">
<title>interface~particles</title>
<g id="a_program~~convergence_test~~CallsGraph_node5"><a xlink:href=".././interface/particles.html" xlink:title="particles">
<polygon fill="#a7506f" stroke="#a7506f" points="274,-296 216,-296 216,-272 274,-272 274,-296"/>
<text text-anchor="middle" x="245" y="-281.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">particles</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;interface~particles -->
<g id="program~~convergence_test~~CallsGraph_edge4" class="edge">
<title>program~convergence_test&#45;&gt;interface~particles</title>
<path fill="none" stroke="#000000" d="M83.3,-236.03C100.46,-242.95 122.78,-251.54 143,-258 163.61,-264.59 186.99,-270.69 206.06,-275.33"/>
<polygon fill="#000000" stroke="#000000" points="205.35,-278.76 215.89,-277.68 206.98,-271.95 205.35,-278.76"/>
</g>
<!-- proc~allocate_idbase -->
<g id="program~~convergence_test~~CallsGraph_node6" class="node">
<title>proc~allocate_idbase</title>
<g id="a_program~~convergence_test~~CallsGraph_node6"><a xlink:href=".././proc/allocate_idbase.html" xlink:title="allocate_idbase">
<polygon fill="#d9534f" stroke="#d9534f" points="293,-174 197,-174 197,-150 293,-150 293,-174"/>
<text text-anchor="middle" x="245" y="-159.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_idbase</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~allocate_idbase -->
<g id="program~~convergence_test~~CallsGraph_edge5" class="edge">
<title>program~convergence_test&#45;&gt;proc~allocate_idbase</title>
<path fill="none" stroke="#000000" d="M76.84,-211.91C94.39,-202.84 119.69,-190.71 143,-183 157.02,-178.36 172.49,-174.53 187.02,-171.47"/>
<polygon fill="#000000" stroke="#000000" points="187.79,-174.89 196.9,-169.48 186.4,-168.03 187.79,-174.89"/>
</g>
<!-- makedirqq -->
<g id="program~~convergence_test~~CallsGraph_node7" class="node">
<title>makedirqq</title>
<polygon fill="#777777" stroke="#777777" points="280,-132 210,-132 210,-108 280,-108 280,-132"/>
<text text-anchor="middle" x="245" y="-117.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">makedirqq</text>
</g>
<!-- program~convergence_test&#45;&gt;makedirqq -->
<g id="program~~convergence_test~~CallsGraph_edge6" class="edge">
<title>program~convergence_test&#45;&gt;makedirqq</title>
<path fill="none" stroke="#000000" d="M63.64,-211.94C78.27,-193.55 108.79,-158.77 143,-141 160.35,-131.98 181.27,-126.84 199.56,-123.9"/>
<polygon fill="#000000" stroke="#000000" points="200.3,-127.33 209.7,-122.45 199.3,-120.41 200.3,-127.33"/>
</g>
<!-- timer -->
<g id="program~~convergence_test~~CallsGraph_node8" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="854.5,-108 800.5,-108 800.5,-84 854.5,-84 854.5,-108"/>
<text text-anchor="middle" x="827.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- program~convergence_test&#45;&gt;timer -->
<g id="program~~convergence_test~~CallsGraph_edge7" class="edge">
<title>program~convergence_test&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M107.05,-228.16C165.78,-231.88 263.59,-235.33 347,-225 520.4,-203.53 555.89,-160.93 725,-117 746.55,-111.4 770.99,-106.31 790.48,-102.54"/>
<polygon fill="#000000" stroke="#000000" points="791.3,-105.95 800.47,-100.64 789.99,-99.07 791.3,-105.95"/>
</g>
<!-- proc~cauchy_convergence_test_unknown -->
<g id="program~~convergence_test~~CallsGraph_node9" class="node">
<title>proc~cauchy_convergence_test_unknown</title>
<g id="a_program~~convergence_test~~CallsGraph_node9"><a xlink:href=".././proc/cauchy_convergence_test_unknown.html" xlink:title="cauchy_convergence_test_unknown">
<polygon fill="#d9534f" stroke="#d9534f" points="347,-90 143,-90 143,-66 347,-66 347,-90"/>
<text text-anchor="middle" x="245" y="-75.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cauchy_convergence_test_unknown</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~cauchy_convergence_test_unknown -->
<g id="program~~convergence_test~~CallsGraph_edge8" class="edge">
<title>program~convergence_test&#45;&gt;proc~cauchy_convergence_test_unknown</title>
<path fill="none" stroke="#000000" d="M59.45,-211.72C70.39,-186.25 99.18,-127.7 143,-99 145.61,-97.29 148.34,-95.71 151.15,-94.26"/>
<polygon fill="#000000" stroke="#000000" points="152.74,-97.38 160.38,-90.04 149.83,-91.02 152.74,-97.38"/>
</g>
<!-- interface~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_node11" class="node">
<title>interface~construct_bssn</title>
<g id="a_program~~convergence_test~~CallsGraph_node11"><a xlink:href=".././interface/construct_bssn.html" xlink:title="construct_bssn">
<polygon fill="#a7506f" stroke="#a7506f" points="496,-173 405,-173 405,-149 496,-149 496,-173"/>
<text text-anchor="middle" x="450.5" y="-158.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_bssn</text>
</a>
</g>
</g>
<!-- interface~bssn&#45;&gt;interface~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge9" class="edge">
<title>interface~bssn&#45;&gt;interface~construct_bssn</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M272.17,-198.61C292.56,-194.39 321.59,-188.37 347,-183 362.56,-179.71 379.43,-176.11 394.92,-172.78"/>
<polygon fill="#000000" stroke="#000000" points="395.82,-176.17 404.86,-170.65 394.35,-169.33 395.82,-176.17"/>
</g>
<!-- interface~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_node10" class="node">
<title>interface~construct_particles_std</title>
<g id="a_program~~convergence_test~~CallsGraph_node10"><a xlink:href=".././interface/construct_particles_std.html" xlink:title="construct_particles_std">
<polygon fill="#a7506f" stroke="#a7506f" points="517.5,-317 383.5,-317 383.5,-293 517.5,-293 517.5,-317"/>
<text text-anchor="middle" x="450.5" y="-302.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_std</text>
</a>
</g>
</g>
<!-- interface~particles&#45;&gt;interface~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_edge10" class="edge">
<title>interface~particles&#45;&gt;interface~construct_particles_std</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M274.3,-286.92C299.84,-289.56 338.61,-293.56 373.2,-297.13"/>
<polygon fill="#000000" stroke="#000000" points="372.99,-300.62 383.3,-298.17 373.71,-293.66 372.99,-300.62"/>
</g>
<!-- interface~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_node12" class="node">
<title>interface~construct_particles_bin</title>
<g id="a_program~~convergence_test~~CallsGraph_node12"><a xlink:href=".././interface/construct_particles_bin.html" xlink:title="construct_particles_bin">
<polygon fill="#a7506f" stroke="#a7506f" points="518,-557 383,-557 383,-533 518,-533 518,-557"/>
<text text-anchor="middle" x="450.5" y="-542.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_bin</text>
</a>
</g>
</g>
<!-- interface~particles&#45;&gt;interface~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_edge11" class="edge">
<title>interface~particles&#45;&gt;interface~construct_particles_bin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M274.26,-283.11C296.35,-283.87 326.63,-288.32 347,-305 416.61,-362 439.9,-474.98 446.85,-522.8"/>
<polygon fill="#000000" stroke="#000000" points="443.42,-523.53 448.22,-532.98 450.35,-522.6 443.42,-523.53"/>
</g>
<!-- proc~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_node13" class="node">
<title>proc~construct_particles_std</title>
<g id="a_program~~convergence_test~~CallsGraph_node13"><a xlink:href=".././proc/construct_particles_std.html" xlink:title="construct_particles_std">
<polygon fill="#d94e8f" stroke="#d94e8f" points="688.5,-339 554.5,-339 554.5,-315 688.5,-315 688.5,-339"/>
<text text-anchor="middle" x="621.5" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_std</text>
</a>
</g>
</g>
<!-- interface~construct_particles_std&#45;&gt;proc~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_edge12" class="edge">
<title>interface~construct_particles_std&#45;&gt;proc~construct_particles_std</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M517.81,-313.63C526.54,-314.77 535.55,-315.94 544.43,-317.1"/>
<polygon fill="#000000" stroke="#000000" points="544.01,-320.57 554.38,-318.39 544.92,-313.63 544.01,-320.57"/>
</g>
<!-- proc~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_node14" class="node">
<title>proc~construct_bssn</title>
<g id="a_program~~convergence_test~~CallsGraph_node14"><a xlink:href=".././proc/construct_bssn.html" xlink:title="construct_bssn">
<polygon fill="#d94e8f" stroke="#d94e8f" points="667,-87 576,-87 576,-63 667,-63 667,-87"/>
<text text-anchor="middle" x="621.5" y="-72.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_bssn</text>
</a>
</g>
</g>
<!-- interface~construct_bssn&#45;&gt;proc~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge13" class="edge">
<title>interface~construct_bssn&#45;&gt;proc~construct_bssn</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M475.36,-148.86C504.67,-133.94 554.57,-108.55 587.53,-91.78"/>
<polygon fill="#000000" stroke="#000000" points="589.44,-94.73 596.77,-87.08 586.27,-88.49 589.44,-94.73"/>
</g>
<!-- proc~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_node15" class="node">
<title>proc~construct_particles_bin</title>
<g id="a_program~~convergence_test~~CallsGraph_node15"><a xlink:href=".././proc/construct_particles_bin.html" xlink:title="construct_particles_bin">
<polygon fill="#d94e8f" stroke="#d94e8f" points="689,-692 554,-692 554,-668 689,-668 689,-692"/>
<text text-anchor="middle" x="621.5" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_bin</text>
</a>
</g>
</g>
<!-- interface~construct_particles_bin&#45;&gt;proc~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_edge14" class="edge">
<title>interface~construct_particles_bin&#45;&gt;proc~construct_particles_bin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M466.8,-557.22C496.46,-580.91 561.96,-633.24 597.12,-661.32"/>
<polygon fill="#000000" stroke="#000000" points="595.36,-664.4 605.36,-667.91 599.73,-658.93 595.36,-664.4"/>
</g>
<!-- proc~construct_particles_std&#45;&gt;timer -->
<g id="program~~convergence_test~~CallsGraph_edge26" class="edge">
<title>proc~construct_particles_std&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M638.07,-314.98C653.3,-302.39 676.04,-281.25 689,-258 720.49,-201.51 678.23,-161.67 725,-117 742.11,-100.66 768.42,-95.56 789.97,-94.47"/>
<polygon fill="#000000" stroke="#000000" points="790.19,-97.97 800.1,-94.23 790.02,-90.97 790.19,-97.97"/>
</g>
<!-- read_options -->
<g id="program~~convergence_test~~CallsGraph_node17" class="node">
<title>read_options</title>
<polygon fill="#777777" stroke="#777777" points="868,-566 787,-566 787,-542 868,-542 868,-566"/>
<text text-anchor="middle" x="827.5" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_options</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;read_options -->
<g id="program~~convergence_test~~CallsGraph_edge19" class="edge">
<title>proc~construct_particles_std&#45;&gt;read_options</title>
<path fill="none" stroke="#000000" d="M624.7,-339.09C631.9,-374.97 658.24,-481.55 725,-533 739.66,-544.29 758.91,-549.9 776.71,-552.57"/>
<polygon fill="#000000" stroke="#000000" points="776.62,-556.09 786.97,-553.82 777.47,-549.14 776.62,-556.09"/>
</g>
<!-- interface~correct_center_of_mass -->
<g id="program~~convergence_test~~CallsGraph_node19" class="node">
<title>interface~correct_center_of_mass</title>
<g id="a_program~~convergence_test~~CallsGraph_node19"><a xlink:href=".././interface/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#a7506f" stroke="#a7506f" points="896.5,-360 758.5,-360 758.5,-336 896.5,-336 896.5,-360"/>
<text text-anchor="middle" x="827.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;interface~correct_center_of_mass -->
<g id="program~~convergence_test~~CallsGraph_edge21" class="edge">
<title>proc~construct_particles_std&#45;&gt;interface~correct_center_of_mass</title>
<path fill="none" stroke="#000000" d="M688.73,-333.82C707.66,-335.77 728.46,-337.91 748.04,-339.92"/>
<polygon fill="#000000" stroke="#000000" points="747.84,-343.42 758.15,-340.96 748.56,-336.46 747.84,-343.42"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_node21" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_program~~convergence_test~~CallsGraph_node21"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="930,-440 725,-440 725,-416 930,-416 930,-440"/>
<text text-anchor="middle" x="827.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_edge25" class="edge">
<title>proc~construct_particles_std&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M635.68,-339.26C654.22,-355.86 689.71,-385.33 725,-402 734.22,-406.36 744.28,-410.05 754.35,-413.17"/>
<polygon fill="#000000" stroke="#000000" points="753.42,-416.54 764,-415.98 755.38,-409.82 753.42,-416.54"/>
</g>
<!-- none~reflect_particles_yz_plane -->
<g id="program~~convergence_test~~CallsGraph_node22" class="node">
<title>none~reflect_particles_yz_plane</title>
<polygon fill="#d9534f" stroke="#d9534f" points="902,-318 753,-318 753,-294 902,-294 902,-318"/>
<text text-anchor="middle" x="827.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_yz_plane</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;none~reflect_particles_yz_plane -->
<g id="program~~convergence_test~~CallsGraph_edge15" class="edge">
<title>proc~construct_particles_std&#45;&gt;none~reflect_particles_yz_plane</title>
<path fill="none" stroke="#000000" d="M688.73,-320.18C705.93,-318.41 724.68,-316.48 742.65,-314.63"/>
<polygon fill="#000000" stroke="#000000" points="743.24,-318.09 752.83,-313.58 742.53,-311.13 743.24,-318.09"/>
</g>
<!-- alive -->
<g id="program~~convergence_test~~CallsGraph_node23" class="node">
<title>alive</title>
<polygon fill="#777777" stroke="#777777" points="854.5,-276 800.5,-276 800.5,-252 854.5,-252 854.5,-276"/>
<text text-anchor="middle" x="827.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alive</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;alive -->
<g id="program~~convergence_test~~CallsGraph_edge23" class="edge">
<title>proc~construct_particles_std&#45;&gt;alive</title>
<path fill="none" stroke="#000000" d="M648.14,-314.94C668.58,-305.71 698.15,-293.2 725,-285 746.3,-278.49 770.73,-273.37 790.28,-269.81"/>
<polygon fill="#000000" stroke="#000000" points="791.06,-273.23 800.3,-268.05 789.85,-266.34 791.06,-273.23"/>
</g>
<!-- interface~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_node27" class="node">
<title>interface~allocate_particles_memory</title>
<g id="a_program~~convergence_test~~CallsGraph_node27"><a xlink:href=".././interface/allocate_particles_memory.html" xlink:title="allocate_particles_memory">
<polygon fill="#a7506f" stroke="#a7506f" points="906,-234 749,-234 749,-210 906,-210 906,-234"/>
<text text-anchor="middle" x="827.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_particles_memory</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;interface~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_edge18" class="edge">
<title>proc~construct_particles_std&#45;&gt;interface~allocate_particles_memory</title>
<path fill="none" stroke="#000000" d="M633.48,-314.83C650.95,-296.27 687,-261.13 725,-243 729.55,-240.83 734.32,-238.88 739.21,-237.13"/>
<polygon fill="#000000" stroke="#000000" points="740.32,-240.45 748.73,-234.01 738.14,-233.8 740.32,-240.45"/>
</g>
<!-- ktable -->
<g id="program~~convergence_test~~CallsGraph_node28" class="node">
<title>ktable</title>
<polygon fill="#777777" stroke="#777777" points="854.5,-192 800.5,-192 800.5,-168 854.5,-168 854.5,-192"/>
<text text-anchor="middle" x="827.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ktable</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;ktable -->
<g id="program~~convergence_test~~CallsGraph_edge22" class="edge">
<title>proc~construct_particles_std&#45;&gt;ktable</title>
<path fill="none" stroke="#000000" d="M635.57,-314.99C649.61,-301.75 672.16,-279.47 689,-258 707.49,-234.42 700.37,-218.06 725,-201 743.98,-187.85 769.44,-182.61 790.11,-180.65"/>
<polygon fill="#000000" stroke="#000000" points="790.4,-184.14 800.12,-179.91 789.89,-177.16 790.4,-184.14"/>
</g>
<!-- com -->
<g id="program~~convergence_test~~CallsGraph_node29" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="1321.5,-399 1267.5,-399 1267.5,-375 1321.5,-375 1321.5,-399"/>
<text text-anchor="middle" x="1294.5" y="-384.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">com</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;com -->
<g id="program~~convergence_test~~CallsGraph_edge24" class="edge">
<title>proc~construct_particles_std&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M645.35,-339.14C665.64,-349.24 696.41,-362.9 725,-369 922.17,-411.08 1166.44,-397.49 1257.27,-390.26"/>
<polygon fill="#000000" stroke="#000000" points="1257.64,-393.74 1267.32,-389.44 1257.07,-386.77 1257.64,-393.74"/>
</g>
<!-- interface~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_node30" class="node">
<title>interface~check_particle_positions</title>
<g id="a_program~~convergence_test~~CallsGraph_node30"><a xlink:href=".././interface/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#a7506f" stroke="#a7506f" points="898.5,-150 756.5,-150 756.5,-126 898.5,-126 898.5,-150"/>
<text text-anchor="middle" x="827.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;interface~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_edge17" class="edge">
<title>proc~construct_particles_std&#45;&gt;interface~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M637.32,-314.93C652.17,-302.16 674.82,-280.72 689,-258 713.78,-218.28 689.59,-189.63 725,-159 731.41,-153.46 738.89,-149.25 746.84,-146.06"/>
<polygon fill="#000000" stroke="#000000" points="748.04,-149.35 756.34,-142.77 745.75,-142.73 748.04,-149.35"/>
</g>
<!-- set_units -->
<g id="program~~convergence_test~~CallsGraph_node31" class="node">
<title>set_units</title>
<polygon fill="#777777" stroke="#777777" points="857,-608 798,-608 798,-584 857,-584 857,-608"/>
<text text-anchor="middle" x="827.5" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_units</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;set_units -->
<g id="program~~convergence_test~~CallsGraph_edge20" class="edge">
<title>proc~construct_particles_std&#45;&gt;set_units</title>
<path fill="none" stroke="#000000" d="M623.61,-339.13C627.99,-379.62 647.84,-511.13 725,-575 742.31,-589.33 766.89,-594.68 787.53,-596.39"/>
<polygon fill="#000000" stroke="#000000" points="787.41,-599.89 797.59,-596.98 787.81,-592.9 787.41,-599.89"/>
</g>
<!-- proc~spherical_from_cartesian -->
<g id="program~~convergence_test~~CallsGraph_node34" class="node">
<title>proc~spherical_from_cartesian</title>
<g id="a_program~~convergence_test~~CallsGraph_node34"><a xlink:href=".././proc/spherical_from_cartesian.html" xlink:title="spherical_from_cartesian">
<polygon fill="#d9534f" stroke="#d9534f" points="900.5,-524 754.5,-524 754.5,-500 900.5,-500 900.5,-524"/>
<text text-anchor="middle" x="827.5" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spherical_from_cartesian</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;proc~spherical_from_cartesian -->
<g id="program~~convergence_test~~CallsGraph_edge16" class="edge">
<title>proc~construct_particles_std&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M626.36,-339.25C636.76,-370.17 668.51,-451.68 725,-491 731.04,-495.21 737.74,-498.6 744.74,-501.34"/>
<polygon fill="#000000" stroke="#000000" points="743.84,-504.73 754.43,-504.69 746.12,-498.12 743.84,-504.73"/>
</g>
<!-- proc~spatial_vector_norm_sym3x3 -->
<g id="program~~convergence_test~~CallsGraph_node35" class="node">
<title>proc~spatial_vector_norm_sym3x3</title>
<g id="a_program~~convergence_test~~CallsGraph_node35"><a xlink:href=".././proc/spatial_vector_norm_sym3x3.html" xlink:title="spatial_vector_norm_sym3x3">
<polygon fill="#d9534f" stroke="#d9534f" points="911,-482 744,-482 744,-458 911,-458 911,-482"/>
<text text-anchor="middle" x="827.5" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spatial_vector_norm_sym3x3</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;proc~spatial_vector_norm_sym3x3 -->
<g id="program~~convergence_test~~CallsGraph_edge27" class="edge">
<title>proc~construct_particles_std&#45;&gt;proc~spatial_vector_norm_sym3x3</title>
<path fill="none" stroke="#000000" d="M628.87,-339C642.73,-363.88 678.2,-421.07 725,-449 728.07,-450.83 731.27,-452.5 734.57,-454.03"/>
<polygon fill="#000000" stroke="#000000" points="733.5,-457.38 744.08,-457.97 736.18,-450.91 733.5,-457.38"/>
</g>
<!-- proc~construct_bssn&#45;&gt;timer -->
<g id="program~~convergence_test~~CallsGraph_edge29" class="edge">
<title>proc~construct_bssn&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M667.02,-79.58C703.99,-83.39 755.92,-88.73 790.36,-92.28"/>
<polygon fill="#000000" stroke="#000000" points="790.15,-95.78 800.45,-93.32 790.86,-88.81 790.15,-95.78"/>
</g>
<!-- deallocate_bssn -->
<g id="program~~convergence_test~~CallsGraph_node16" class="node">
<title>deallocate_bssn</title>
<polygon fill="#777777" stroke="#777777" points="876.5,-24 778.5,-24 778.5,0 876.5,0 876.5,-24"/>
<text text-anchor="middle" x="827.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_bssn</text>
</g>
<!-- proc~construct_bssn&#45;&gt;deallocate_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge28" class="edge">
<title>proc~construct_bssn&#45;&gt;deallocate_bssn</title>
<path fill="none" stroke="#000000" d="M648.14,-62.94C668.58,-53.71 698.15,-41.2 725,-33 738.78,-28.79 753.87,-25.16 768.1,-22.16"/>
<polygon fill="#000000" stroke="#000000" points="769.18,-25.51 778.28,-20.08 767.78,-18.65 769.18,-25.51"/>
</g>
<!-- initialize_bssn -->
<g id="program~~convergence_test~~CallsGraph_node25" class="node">
<title>initialize_bssn</title>
<polygon fill="#777777" stroke="#777777" points="870.5,-66 784.5,-66 784.5,-42 870.5,-42 870.5,-66"/>
<text text-anchor="middle" x="827.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initialize_bssn</text>
</g>
<!-- proc~construct_bssn&#45;&gt;initialize_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge30" class="edge">
<title>proc~construct_bssn&#45;&gt;initialize_bssn</title>
<path fill="none" stroke="#000000" d="M667.02,-70.42C698.57,-67.17 741.02,-62.8 774.2,-59.38"/>
<polygon fill="#000000" stroke="#000000" points="774.58,-62.86 784.17,-58.36 773.86,-55.9 774.58,-62.86"/>
</g>
<!-- proc~construct_particles_bin&#45;&gt;read_options -->
<g id="program~~convergence_test~~CallsGraph_edge31" class="edge">
<title>proc~construct_particles_bin&#45;&gt;read_options</title>
<path fill="none" stroke="#000000" d="M630.47,-668C645.89,-645.8 682.09,-598.48 725,-575 740.56,-566.49 759.18,-561.42 776.2,-558.4"/>
<polygon fill="#000000" stroke="#000000" points="777.21,-561.78 786.55,-556.77 776.12,-554.87 777.21,-561.78"/>
</g>
<!-- deallocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_node18" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="899,-734 756,-734 756,-710 899,-710 899,-734"/>
<text text-anchor="middle" x="827.5" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_sph_memory</text>
</g>
<!-- proc~construct_particles_bin&#45;&gt;deallocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_edge32" class="edge">
<title>proc~construct_particles_bin&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M680.96,-692.04C705.07,-697 733.18,-702.79 758.24,-707.95"/>
<polygon fill="#000000" stroke="#000000" points="757.53,-711.37 768.03,-709.96 758.94,-704.52 757.53,-711.37"/>
</g>
<!-- select_eos_parameters -->
<g id="program~~convergence_test~~CallsGraph_node20" class="node">
<title>select_eos_parameters</title>
<polygon fill="#777777" stroke="#777777" points="895.5,-692 759.5,-692 759.5,-668 895.5,-668 895.5,-692"/>
<text text-anchor="middle" x="827.5" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">select_eos_parameters</text>
</g>
<!-- proc~construct_particles_bin&#45;&gt;select_eos_parameters -->
<g id="program~~convergence_test~~CallsGraph_edge33" class="edge">
<title>proc~construct_particles_bin&#45;&gt;select_eos_parameters</title>
<path fill="none" stroke="#000000" d="M689.01,-680C708.22,-680 729.35,-680 749.16,-680"/>
<polygon fill="#000000" stroke="#000000" points="749.38,-683.5 759.38,-680 749.38,-676.5 749.38,-683.5"/>
</g>
<!-- proc~compute_g4 -->
<g id="program~~convergence_test~~CallsGraph_node24" class="node">
<title>proc~compute_g4</title>
<g id="a_program~~convergence_test~~CallsGraph_node24"><a xlink:href=".././proc/compute_g4.html" xlink:title="compute_g4">
<polygon fill="#d9534f" stroke="#d9534f" points="867,-650 788,-650 788,-626 867,-626 867,-650"/>
<text text-anchor="middle" x="827.5" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_g4</text>
</a>
</g>
</g>
<!-- proc~construct_particles_bin&#45;&gt;proc~compute_g4 -->
<g id="program~~convergence_test~~CallsGraph_edge37" class="edge">
<title>proc~construct_particles_bin&#45;&gt;proc~compute_g4</title>
<path fill="none" stroke="#000000" d="M680.96,-667.96C711.61,-661.65 748.71,-654.02 777.78,-648.03"/>
<polygon fill="#000000" stroke="#000000" points="778.62,-651.43 787.71,-645.99 777.21,-644.57 778.62,-651.43"/>
</g>
<!-- proc~spacetime_vector_norm_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_node26" class="node">
<title>proc~spacetime_vector_norm_sym4x4</title>
<g id="a_program~~convergence_test~~CallsGraph_node26"><a xlink:href=".././proc/spacetime_vector_norm_sym4x4.html" xlink:title="spacetime_vector_norm_sym4x4">
<polygon fill="#d9534f" stroke="#d9534f" points="921,-860 734,-860 734,-836 921,-836 921,-860"/>
<text text-anchor="middle" x="827.5" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spacetime_vector_norm_sym4x4</text>
</a>
</g>
</g>
<!-- proc~construct_particles_bin&#45;&gt;proc~spacetime_vector_norm_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_edge38" class="edge">
<title>proc~construct_particles_bin&#45;&gt;proc~spacetime_vector_norm_sym4x4</title>
<path fill="none" stroke="#000000" d="M627.25,-692.24C639.05,-720.88 672.53,-792.4 725,-827 727.58,-828.7 730.28,-830.27 733.06,-831.72"/>
<polygon fill="#000000" stroke="#000000" points="731.64,-834.92 742.18,-835.93 734.57,-828.56 731.64,-834.92"/>
</g>
<!-- proc~construct_particles_bin&#45;&gt;set_units -->
<g id="program~~convergence_test~~CallsGraph_edge34" class="edge">
<title>proc~construct_particles_bin&#45;&gt;set_units</title>
<path fill="none" stroke="#000000" d="M638.26,-667.88C657.62,-653.58 691.99,-630.09 725,-617 744.99,-609.07 768.44,-603.97 787.76,-600.78"/>
<polygon fill="#000000" stroke="#000000" points="788.38,-604.23 797.73,-599.24 787.32,-597.31 788.38,-604.23"/>
</g>
<!-- allocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_node32" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="892.5,-818 762.5,-818 762.5,-794 892.5,-794 892.5,-818"/>
<text text-anchor="middle" x="827.5" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_sph_memory</text>
</g>
<!-- proc~construct_particles_bin&#45;&gt;allocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_edge35" class="edge">
<title>proc~construct_particles_bin&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M630.47,-692C645.89,-714.2 682.09,-761.52 725,-785 733.58,-789.7 743.1,-793.35 752.77,-796.18"/>
<polygon fill="#000000" stroke="#000000" points="751.89,-799.57 762.45,-798.75 753.68,-792.8 751.89,-799.57"/>
</g>
<!-- proc~determinant_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_node33" class="node">
<title>proc~determinant_sym4x4</title>
<g id="a_program~~convergence_test~~CallsGraph_node33"><a xlink:href=".././proc/determinant_sym4x4.html" xlink:title="determinant_sym4x4">
<polygon fill="#d9534f" stroke="#d9534f" points="890,-776 765,-776 765,-752 890,-752 890,-776"/>
<text text-anchor="middle" x="827.5" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">determinant_sym4x4</text>
</a>
</g>
</g>
<!-- proc~construct_particles_bin&#45;&gt;proc~determinant_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_edge36" class="edge">
<title>proc~construct_particles_bin&#45;&gt;proc~determinant_sym4x4</title>
<path fill="none" stroke="#000000" d="M638.26,-692.12C657.62,-706.42 691.99,-729.91 725,-743 734.51,-746.77 744.8,-749.9 755.05,-752.49"/>
<polygon fill="#000000" stroke="#000000" points="754.31,-755.91 764.85,-754.81 755.92,-749.1 754.31,-755.91"/>
</g>
<!-- proc~correct_center_of_mass -->
<g id="program~~convergence_test~~CallsGraph_node38" class="node">
<title>proc~correct_center_of_mass</title>
<g id="a_program~~convergence_test~~CallsGraph_node38"><a xlink:href=".././proc/correct_center_of_mass.html" xlink:title="correct_center_of_mass">
<polygon fill="#d9534f" stroke="#d9534f" points="1137.5,-360 999.5,-360 999.5,-336 1137.5,-336 1137.5,-360"/>
<text text-anchor="middle" x="1068.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">correct_center_of_mass</text>
</a>
</g>
</g>
<!-- interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass -->
<g id="program~~convergence_test~~CallsGraph_edge39" class="edge">
<title>interface~correct_center_of_mass&#45;&gt;proc~correct_center_of_mass</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M896.67,-348C925.42,-348 959.08,-348 988.88,-348"/>
<polygon fill="#000000" stroke="#000000" points="989.24,-351.5 999.24,-348 989.24,-344.5 989.24,-351.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_node36" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_program~~convergence_test~~CallsGraph_node36"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="1171,-440 966,-440 966,-416 1171,-416 1171,-440"/>
<text text-anchor="middle" x="1068.5" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_edge40" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M930.2,-428C938.7,-428 947.31,-428 955.87,-428"/>
<polygon fill="#000000" stroke="#000000" points="955.89,-431.5 965.89,-428 955.89,-424.5 955.89,-431.5"/>
</g>
<!-- proc~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_node39" class="node">
<title>proc~allocate_particles_memory</title>
<g id="a_program~~convergence_test~~CallsGraph_node39"><a xlink:href=".././proc/allocate_particles_memory.html" xlink:title="allocate_particles_memory">
<polygon fill="#d9534f" stroke="#d9534f" points="1147,-234 990,-234 990,-210 1147,-210 1147,-234"/>
<text text-anchor="middle" x="1068.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_particles_memory</text>
</a>
</g>
</g>
<!-- interface~allocate_particles_memory&#45;&gt;proc~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_edge41" class="edge">
<title>interface~allocate_particles_memory&#45;&gt;proc~allocate_particles_memory</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M906.1,-222C929.59,-222 955.56,-222 979.68,-222"/>
<polygon fill="#000000" stroke="#000000" points="979.88,-225.5 989.88,-222 979.88,-218.5 979.88,-225.5"/>
</g>
<!-- proc~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_node37" class="node">
<title>proc~check_particle_positions</title>
<g id="a_program~~convergence_test~~CallsGraph_node37"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="1139.5,-150 997.5,-150 997.5,-126 1139.5,-126 1139.5,-150"/>
<text text-anchor="middle" x="1068.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- interface~check_particle_positions&#45;&gt;proc~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_edge42" class="edge">
<title>interface~check_particle_positions&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M898.59,-138C926.44,-138 958.63,-138 987.39,-138"/>
<polygon fill="#000000" stroke="#000000" points="987.41,-141.5 997.41,-138 987.41,-134.5 987.41,-141.5"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="program~~convergence_test~~CallsGraph_edge43" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M1135.19,-415.98C1175.03,-408.68 1224.36,-399.66 1257.26,-393.63"/>
<polygon fill="#000000" stroke="#000000" points="1258.13,-397.03 1267.33,-391.79 1256.87,-390.15 1258.13,-397.03"/>
</g>
<!-- interface~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node42" class="node">
<title>interface~find_particles_above_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node42"><a xlink:href=".././interface/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="1382,-483 1207,-483 1207,-459 1382,-459 1382,-483"/>
<text text-anchor="middle" x="1294.5" y="-468.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge44" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" d="M1132.19,-440.04C1159.75,-445.32 1192.28,-451.57 1220.88,-457.06"/>
<polygon fill="#000000" stroke="#000000" points="1220.34,-460.52 1230.82,-458.97 1221.66,-453.65 1220.34,-460.52"/>
</g>
<!-- interface~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node43" class="node">
<title>interface~reflect_particles_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node43"><a xlink:href=".././interface/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="1369.5,-441 1219.5,-441 1219.5,-417 1369.5,-417 1369.5,-441"/>
<text text-anchor="middle" x="1294.5" y="-426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge45" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" d="M1171.01,-428.45C1183.77,-428.51 1196.7,-428.57 1209.15,-428.62"/>
<polygon fill="#000000" stroke="#000000" points="1209.46,-432.12 1219.47,-428.67 1209.49,-425.12 1209.46,-432.12"/>
</g>
<!-- indexx -->
<g id="program~~convergence_test~~CallsGraph_node41" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="1321.5,-150 1267.5,-150 1267.5,-126 1321.5,-126 1321.5,-150"/>
<text text-anchor="middle" x="1294.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="program~~convergence_test~~CallsGraph_edge46" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M1139.76,-138C1178.72,-138 1225.55,-138 1257.21,-138"/>
<polygon fill="#000000" stroke="#000000" points="1257.33,-141.5 1267.33,-138 1257.33,-134.5 1257.33,-141.5"/>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;com -->
<g id="program~~convergence_test~~CallsGraph_edge48" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M1137.62,-359.86C1177.11,-366.74 1225.24,-375.12 1257.48,-380.73"/>
<polygon fill="#000000" stroke="#000000" points="1256.91,-384.18 1267.36,-382.45 1258.11,-377.29 1256.91,-384.18"/>
</g>
<!-- proc~is_finite_number -->
<g id="program~~convergence_test~~CallsGraph_node40" class="node">
<title>proc~is_finite_number</title>
<g id="a_program~~convergence_test~~CallsGraph_node40"><a xlink:href=".././proc/is_finite_number.html" xlink:title="is_finite_number">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1344.5,-357 1244.5,-357 1244.5,-333 1344.5,-333 1344.5,-357"/>
<text text-anchor="middle" x="1294.5" y="-342.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">is_finite_number</text>
</a>
</g>
</g>
<!-- proc~correct_center_of_mass&#45;&gt;proc~is_finite_number -->
<g id="program~~convergence_test~~CallsGraph_edge47" class="edge">
<title>proc~correct_center_of_mass&#45;&gt;proc~is_finite_number</title>
<path fill="none" stroke="#000000" d="M1137.62,-347.09C1168.36,-346.68 1204.34,-346.19 1233.99,-345.8"/>
<polygon fill="#000000" stroke="#000000" points="1234.24,-349.29 1244.19,-345.66 1234.14,-342.29 1234.24,-349.29"/>
</g>
<!-- proc~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node45" class="node">
<title>proc~find_particles_above_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node45"><a xlink:href=".././proc/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1593,-483 1418,-483 1418,-459 1593,-459 1593,-483"/>
<text text-anchor="middle" x="1505.5" y="-468.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge49" class="edge">
<title>interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1382.02,-471C1390.49,-471 1399.13,-471 1407.7,-471"/>
<polygon fill="#000000" stroke="#000000" points="1407.71,-474.5 1417.71,-471 1407.71,-467.5 1407.71,-474.5"/>
</g>
<!-- proc~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node44" class="node">
<title>proc~reflect_particles_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node44"><a xlink:href=".././proc/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1580.5,-441 1430.5,-441 1430.5,-417 1580.5,-417 1580.5,-441"/>
<text text-anchor="middle" x="1505.5" y="-426.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge50" class="edge">
<title>interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369.77,-429C1386.1,-429 1403.5,-429 1420.18,-429"/>
<polygon fill="#000000" stroke="#000000" points="1420.47,-432.5 1430.47,-429 1420.47,-425.5 1420.47,-432.5"/>
</g>
</g>
</svg>
</div><script>var panprogramconvergence_testCallsGraph = svgPanZoom('#programconvergence_testCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
       <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../program/convergence_test.html#variable-bssn_forms">bssn_forms</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-debug~15">debug</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-dir_out">dir_out</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-execution_timer">execution_timer</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-exist~22">exist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-idata~2">idata</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-max_bssn">max_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-min_bssn">min_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-name_logfile~5">name_logfile</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn">namefile_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn_bin">namefile_bssn_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts">namefile_parts</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts_bin">namefile_parts_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_sph">namefile_sph</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-original_dx">original_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-particles_dist">particles_dist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-ratio_dx">ratio_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems">systems</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems_name">systems_name</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_known">cauchy_convergence_test_known</a>
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_unknown">cauchy_convergence_test_unknown</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../program/convergence_test.html#src">convergence_test</a>
  </div>
</div>

     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
    <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-bssn_forms"></span>type(<a href='../type/bssn.html'>bssn</a>),</td>
  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>bssn_forms</strong></td><td></td><td></td><td><p>Array storing the bssn objects,
 containing the BSSN variables on the gravity grid for each idbase object</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-debug~15"></span>logical,</td>
  <td>parameter</td><td>::</td>
  <td><strong>debug</strong></td><td> =</td><td>.FALSE.</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-dir_out"></span>logical(kind=4)</td>
  <td></td><td>::</td>
  <td><strong>dir_out</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-execution_timer"></span>type(timer)</td>
  <td></td><td>::</td>
  <td><strong>execution_timer</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-exist~22"></span>logical</td>
  <td></td><td>::</td>
  <td><strong>exist</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-idata~2"></span>class(<a href='../type/idbase.html'>idbase</a>),</td>
  <td>ALLOCATABLE</td><td>::</td>
  <td><strong>idata</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max_bssn"></span>integer,</td>
  <td>parameter</td><td>::</td>
  <td><strong>max_bssn</strong></td><td> =</td><td>3</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-min_bssn"></span>integer,</td>
  <td>parameter</td><td>::</td>
  <td><strong>min_bssn</strong></td><td> =</td><td>1</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-name_logfile~5"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>name_logfile</strong></td><td></td><td></td><td><p>String storing the name for the formatted file containing a summary about
 the \(\mathrm{BSSNOK}\) constraints violations</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_bssn"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_bssn</strong></td><td></td><td></td><td><p>String storing the name for the formatted file containing the \(\mathrm{BSSNOK}\) \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_bssn_bin"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_bssn_bin</strong></td><td></td><td></td><td><p>String storing the name for the binary file containing the \(\mathrm{BSSNOK}\) \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_parts"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_parts</strong></td><td></td><td></td><td><p>String storing the name for the formatted file containing the \(\mathrm{SPH}\)
 particle \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_parts_bin"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_parts_bin</strong></td><td></td><td></td><td><p>String storing the name for the binary file containing the \(\mathrm{SPH}\)
 particle \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_sph"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_sph</strong></td><td></td><td></td><td><p>String storing the name for ??</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-original_dx"></span>double precision</td>
  <td></td><td>::</td>
  <td><strong>original_dx</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-particles_dist"></span>type(<a href='../type/particles.html'>particles</a>)</td>
  <td></td><td>::</td>
  <td><strong>particles_dist</strong></td><td></td><td></td><td><p>Array storing the particles objects,
 containing the particle distributions for each idbase object.
 Multiple particle objects can contain different particle distributions
 for the same idbase object.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ratio_dx"></span>double precision</td>
  <td></td><td>::</td>
  <td><strong>ratio_dx</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-systems"></span>character(len=:),</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>systems</strong></td><td></td><td></td><td><p>String storing the name of the phyical systems</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-systems_name"></span>character(len=:),</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>systems_name</strong></td><td></td><td></td><td><p>String storing the name of the phyical systems</p></td>
</tr>
</tbody>
</table>

    </section>
    <br>
    
    
    

    


    <section>
    <h2>Subroutines</h2>
      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-cauchy_convergence_test_known"></span><h3>subroutine <a href='../proc/cauchy_convergence_test_known.html'>cauchy_convergence_test_known</a>(formul_dx, formul_dx2, use_constraints, ref_lev)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx2</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_constraints</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ref_lev</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-cauchy_convergence_test_unknown"></span><h3>subroutine <a href='../proc/cauchy_convergence_test_unknown.html'>cauchy_convergence_test_unknown</a>(formul_dx, formul_dx2, formul_dx4, use_constraints, ref_lev)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx2</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx4</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_constraints</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ref_lev</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

    </section>    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">PROGRAM </span><span class="n">convergence_test</span>

  <span class="c">!*****************************************************</span>
  <span class="c">!</span>
  <span class="c">!# Make a convergence test to check the validity of</span>
  <span class="c">!  the code |sphincsid|.</span>
  <span class="c">!</span>
  <span class="c">!  FT 8.12.2020</span>
  <span class="c">!</span>
  <span class="c">!*****************************************************</span>

<span class="cp">#ifdef __INTEL_COMPILER</span>

  <span class="k">USE </span><span class="n">IFPORT</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAKEDIRQQ</span>

<span class="cp">#endif</span>

<span class="cp">#if flavour == 1</span>

  <span class="k">USE </span><span class="n">sphincs_id_full</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#elif flavour == 2</span>

  <span class="k">USE </span><span class="n">sphincs_id_lorene</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#elif flavour == 3</span>

  <span class="k">USE </span><span class="n">sphincs_id_fuka</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#elif flavour == 4</span>

  <span class="k">USE </span><span class="n">sphincs_id_interpolate</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#endif</span>

  <span class="k">USE </span><span class="n">id_base</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">idbase</span><span class="p">,</span> <span class="n">initialize</span>
  <span class="k">USE </span><span class="n">sph_particles</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">particles</span>
  <span class="k">USE </span><span class="n">bssn_formulation</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">bssn</span>
  <span class="k">USE </span><span class="n">standard_tpo_formulation</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">tpo</span>
  <span class="k">USE </span><span class="n">timing</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">timer</span>
  <span class="k">USE </span><span class="n">utility</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">itr3</span><span class="p">,</span> <span class="n">ios</span><span class="p">,</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">test_status</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">read_sphincs_id_parameters</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="c">!----------</span>
                                      <span class="n">n_id</span><span class="p">,</span> <span class="n">common_path</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">placer</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_bin</span><span class="p">,</span> <span class="n">export_form</span><span class="p">,</span> <span class="n">export_form_xy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_form_x</span><span class="p">,</span> <span class="n">export_constraints_xy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_constraints_x</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">compute_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_constraints_details</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">constraints_step</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">compute_parts_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">numerator_ratio_dx</span><span class="p">,</span> <span class="n">denominator_ratio_dx</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">one_lapse</span><span class="p">,</span> <span class="n">zero_shift</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">run_sph</span><span class="p">,</span> <span class="n">run_spacetime</span><span class="p">,</span> <span class="n">sph_path</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">spacetime_path</span><span class="p">,</span> <span class="n">estimate_length_scale</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">test_int</span><span class="p">,</span> <span class="n">max_n_parts</span><span class="p">,</span> <span class="n">ref_lev</span>

  <span class="k">IMPLICIT NONE</span>

  <span class="c">! Loop limits for BSSN objects (for debugging; 3 is for production)</span>
  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">min_bssn</span><span class="o">=</span> <span class="mi">1</span>
  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">max_bssn</span><span class="o">=</span> <span class="mi">3</span>

  <span class="c">! Grid spacing for the first BSSN object; the other two will have</span>
  <span class="c">! original_dx/2 and original_dx/4 as grid spacings</span>
  <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">original_dx</span>
  <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">ratio_dx</span>

  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="p">:</span> <span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">systems</span><span class="p">,</span> <span class="n">systems_name</span>
  <span class="c">!! String storing the name of the phyical systems</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_parts</span>
  <span class="c">!# String storing the name for the formatted file containing the |sph|</span>
  <span class="c">!  particle |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_parts_bin</span>
  <span class="c">!# String storing the name for the binary file containing the |sph|</span>
  <span class="c">!  particle |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_sph</span>
  <span class="c">!# String storing the name for ??</span>
  <span class="c">!</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_bssn</span>
  <span class="c">!# String storing the name for the formatted file containing the |bssn| |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_bssn_bin</span>
  <span class="c">!# String storing the name for the binary file containing the |bssn| |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">name_logfile</span>
  <span class="c">!# String storing the name for the formatted file containing a summary about</span>
  <span class="c">!  the |bssn| constraints violations</span>

  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">debug</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
  <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">exist</span>
  <span class="kt">LOGICAL</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="kd">::</span> <span class="n">dir_out</span>

  <span class="k">CLASS</span><span class="p">(</span><span class="n">idbase</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">idata</span>

  <span class="k">TYPE</span><span class="p">(</span><span class="n">particles</span><span class="p">)</span><span class="kd">::</span> <span class="n">particles_dist</span>
  <span class="c">!# Array storing the particles objects,</span>
  <span class="c">!  containing the particle distributions for each idbase object.</span>
  <span class="c">!  Multiple particle objects can contain different particle distributions</span>
  <span class="c">!  for the same idbase object.</span>

  <span class="k">TYPE</span><span class="p">(</span><span class="n">bssn</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">bssn_forms</span>
  <span class="c">!# Array storing the bssn objects,</span>
  <span class="c">!  containing the BSSN variables on the gravity grid for each idbase object</span>

  <span class="k">TYPE</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span><span class="kd">::</span> <span class="n">execution_timer</span>

  <span class="c">!---------------------------!</span>
  <span class="c">!--  End of declarations  --!</span>
  <span class="c">!---------------------------!</span>

  <span class="c">! Conversions of some polytropic constants from formatted units to</span>
  <span class="c">! SPHINCS units, and vice versa</span>
  <span class="c">!gamma= 2</span>
  <span class="c">!PRINT *, 0.0332278*k_lorene2hydrobase( gamma )</span>
  <span class="c">!PRINT *</span>
  <span class="c">!gamma= 2.75</span>
  <span class="c">!PRINT *, 30000.0D0/k_lorene2hydrobase( gamma )</span>
  <span class="c">!gamma= 2.75</span>
  <span class="c">!PRINT *, 0.0332278*k_lorene2hydrobase( gamma )</span>
  <span class="c">!STOP</span>

  <span class="k">CALL </span><span class="nb">DATE_AND_TIME</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">values</span> <span class="p">)</span>
  <span class="n">run_id</span><span class="o">=</span> <span class="n">date</span> <span class="o">//</span> <span class="s2">&quot;-&quot;</span> <span class="o">//</span> <span class="nb">time</span>

<span class="nb">  </span><span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  ________________________________________________________________ &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;             ____________  ________  __________    __ ___          &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;            / ___/ _  / /_/ / / __ \/ ___/ ___/   / / __ \         &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;           (__  ) ___/ __  / / / / / /__(__  )___/ / /_/ /         &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;          /____/_/  /_/ /_/_/_/ /_/____/____/___/_/_____/          &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  Smoothed Particle Hydrodynamics IN Curved Spacetime              &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  Initial Data builder, v1.0 - Cauchy convergence test             &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  SPHINCS_ID  Copyright (C) 2020, 2021, 2022  Francesco Torsello   &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  SPHINCS_ID is free software: you can redistribute it and/or      &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  modify it under the terms of the GNU General Public License      &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  as published by the Free Software Foundation, either version     &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  of the License, or (at your option) any later version.           &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  SPHINCS_ID is distributed in the hope that it will be useful,    &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  but WITHOUT ANY WARRANTY; without even the implied warranty of   &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  General Public License for more details.                         &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  You should have received a copy of the GNU General Public License&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  along with SPHINCS_ID. If not, see https://www.gnu.org/licenses/.&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  The copy of the GNU General Public License should be in the file &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  &#39;COPYING&#39;.                                                       &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  ________________________________________________________________ &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  Run id: &quot;</span><span class="p">,</span> <span class="n">run_id</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  ________________________________________________________________ &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>

  <span class="n">execution_timer</span><span class="o">=</span> <span class="n">timer</span><span class="p">(</span> <span class="s2">&quot;execution_timer&quot;</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">execution_timer</span><span class="p">%</span> <span class="n">start_timer</span><span class="p">()</span>

  <span class="k">CALL </span><span class="n">read_sphincs_id_parameters</span><span class="p">()</span>

  <span class="n">ratio_dx</span><span class="o">=</span> <span class="n">numerator_ratio_dx</span><span class="o">/</span><span class="n">denominator_ratio_dx</span>

  <span class="c">! Check that ratio_dx &gt; 1</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">ratio_dx</span> <span class="o">&lt;=</span> <span class="mf">1.0D0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! numerator_ratio_dx has to be larger than &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;denominator_ratio_dx. The current values are &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">numerator_ratio_dx</span><span class="p">,</span> <span class="s2">&quot; and &quot;</span><span class="p">,</span> <span class="n">denominator_ratio_dx</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;, respectively.&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

<span class="cp">#ifdef __INTEL_COMPILER</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="n">DIRECTORY</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="n">MAKEDIRQQ</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">ELSE</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
  <span class="n">ENDIF</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">dir_out</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Failed to create subdirectory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Stopping...&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="n">DIRECTORY</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="n">MAKEDIRQQ</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">ELSE</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
  <span class="n">ENDIF</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">dir_out</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Failed to create subdirectory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Stopping...&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

<span class="cp">#endif</span>

<span class="cp">#ifdef __GFORTRAN__</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/.&quot;</span><span class="p">,</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Directory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">),</span> <span class="s2">&quot; does not exist!&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;   Please create it and re-run the executable. Stopping...&quot;</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/.&quot;</span><span class="p">,</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Directory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">),</span> <span class="s2">&quot; does not exist!&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;   Please create it and re-run the executable. Stopping...&quot;</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

<span class="cp">#endif</span>

  <span class="k">ALLOCATE</span><span class="p">(</span> <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="kd">::</span> <span class="n">systems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">ALLOCATE</span><span class="p">(</span> <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="kd">::</span> <span class="n">systems_name</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

  <span class="c">!</span>
  <span class="c">!-- Construct the idbase objects</span>
  <span class="c">!</span>
  <span class="k">CALL </span><span class="n">allocate_idbase</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">filenames</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">systems</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">systems_name</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Constructing idbase object for &quot;</span><span class="o">//</span><span class="n">systems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">initialize</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">common_path</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">filenames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span>
  <span class="c">! Set the variables to decide on using the geodesic gauge or not</span>
  <span class="c">! (lapse=1, shift=0)</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">set_one_lapse</span> <span class="p">(</span> <span class="n">one_lapse</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">set_zero_shift</span><span class="p">(</span> <span class="n">zero_shift</span> <span class="p">)</span>


  <span class="c">!</span>
  <span class="c">!-- Construct the bssn objects from the idbase object</span>
  <span class="c">!</span>
  <span class="n">construct_bssn_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Setting up BSSN object &quot;</span><span class="p">,</span> <span class="n">itr3</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">      </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)</span><span class="o">=</span> <span class="n">bssn</span><span class="p">(</span> <span class="n">idata</span> <span class="p">)</span>
      <span class="n">original_dx</span><span class="o">=</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

    <span class="k">ELSE</span>
<span class="k">      IF</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">==</span> <span class="n">min_bssn</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">        </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span><span class="o">=</span> <span class="n">bssn</span><span class="p">(</span> <span class="n">idata</span> <span class="p">)</span>
        <span class="n">original_dx</span><span class="o">=</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

      <span class="n">ENDIF</span>
      <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)</span><span class="o">=</span> <span class="n">bssn</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">),</span> <span class="p">&amp;</span>
                                   <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">),</span> <span class="p">&amp;</span>
                                   <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
          <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; ** ERROR! The grid spacing #&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot; is not equal to dx/&quot;</span><span class="p">,</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">),</span> <span class="s2">&quot;= &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
    <span class="n">ENDIF</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** The grid spacing is dx=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** The number of grid points for dx is:&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                            <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">),</span> <span class="s2">&quot;**3&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>

  <span class="n">ENDDO</span> <span class="n">construct_bssn_loop</span>

  <span class="k">IF</span><span class="p">(</span> <span class="n">debug</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_dx &quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_dy &quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_dz &quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="c">!STOP</span>
  <span class="n">ENDIF</span>

  <span class="c">!</span>
  <span class="c">!-- Compute the BSSN variables</span>
  <span class="c">!</span>
  <span class="n">compute_export_bssn_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing BSSN variables for BSSN formulation&quot;</span><span class="p">,</span> <span class="n">itr3</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn_bin</span><span class="p">,</span> <span class="s2">&quot;(A6,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;BSSN_l&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.bin&quot;</span>
    <span class="n">namefile_bssn_bin</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn_bin</span> <span class="p">)</span>

    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_bin</span><span class="o">=</span> <span class="n">export_bin</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_form_xy</span><span class="o">=</span> <span class="n">export_form_xy</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_form_x</span> <span class="o">=</span> <span class="n">export_form_x</span>
    <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                        <span class="n">compute_and_export_tpo_variables</span><span class="p">(</span> <span class="n">namefile_bssn_bin</span> <span class="p">)</span>
  <span class="n">ENDDO</span> <span class="n">compute_export_bssn_loop</span>

  <span class="c">!</span>
  <span class="c">!-- Print the BSSN initial data to a formatted file</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">export_form</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    </span><span class="n">export_bssn_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn</span><span class="p">,</span> <span class="s2">&quot;(A24,I1,A4)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                            <span class="s2">&quot;lorene-bns-id-bssn-form_&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="n">namefile_bssn</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>

      <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                  <span class="n">print_formatted_id_tpo_variables</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>
    <span class="n">ENDDO</span> <span class="n">export_bssn_loop</span>
  <span class="n">ENDIF</span>


  <span class="c">!</span>
  <span class="c">!-- Construct the particles object from the idbase object</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">compute_parts_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Placing particles&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="n">particles_dist</span><span class="o">=</span> <span class="n">particles</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="n">placer</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>

    <span class="c">!</span>
    <span class="c">!-- Compute the SPH variables</span>
    <span class="c">!</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;=====================&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing SPH variables &quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;=====================&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_parts</span><span class="p">,</span> <span class="s2">&quot;(A1,I1,A1,I1,A1)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                                <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span>
    <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_parts_bin</span><span class="p">,</span> <span class="s2">&quot;(A5)&quot;</span> <span class="p">)</span> <span class="n">systems_name</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">namefile_parts_bin</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">sph_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_parts_bin</span> <span class="p">)</span>

    <span class="n">particles_dist</span><span class="p">%</span> <span class="n">export_bin</span>    <span class="o">=</span> <span class="n">export_bin</span>
    <span class="n">particles_dist</span><span class="p">%</span> <span class="n">export_form_xy</span><span class="o">=</span> <span class="n">export_form_xy</span>
    <span class="n">particles_dist</span><span class="p">%</span> <span class="n">export_form_x</span> <span class="o">=</span> <span class="n">export_form_x</span>
    <span class="k">CALL </span><span class="n">particles_dist</span><span class="p">%</span> <span class="n">compute_and_print_sph_variables</span><span class="p">(</span> <span class="n">namefile_parts</span> <span class="p">)</span>

    <span class="c">!</span>
    <span class="c">!-- Print the particle initial data to a formatted file</span>
    <span class="c">!</span>
    <span class="k">IF</span><span class="p">(</span> <span class="n">export_form</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">      WRITE</span><span class="p">(</span> <span class="n">namefile_parts</span><span class="p">,</span> <span class="s2">&quot;(A34)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                             <span class="s2">&quot;lorene-bns-id-particles-form_1.dat&quot;</span>
      <span class="n">namefile_parts</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">sph_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_parts</span> <span class="p">)</span>
      <span class="k">CALL </span><span class="n">particles_dist</span><span class="p">%</span> <span class="n">print_formatted_id_particles</span><span class="p">(</span> <span class="n">namefile_parts</span> <span class="p">)</span>
    <span class="n">ENDIF</span>

  <span class="n">ENDIF</span>

  <span class="c">!</span>
  <span class="c">!-- Compute the BSSN constraints</span>
  <span class="c">!</span>
  <span class="n">compute_export_bssn_constraints_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>

    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">cons_step</span><span class="o">=</span> <span class="n">constraints_step</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints</span><span class="o">=</span> <span class="n">export_constraints</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints_details</span><span class="o">=</span> <span class="p">&amp;</span>
                        <span class="n">export_constraints_details</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints_xy</span><span class="o">=</span> <span class="n">export_constraints_xy</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints_x</span> <span class="o">=</span> <span class="n">export_constraints_x</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">compute_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing BSSN constraints for BSSN formulation&quot;</span><span class="p">,</span> <span class="n">itr3</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn</span><span class="p">,</span> <span class="s2">&quot;(A17,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;bssn-constraints-&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">name_logfile</span><span class="p">,</span> <span class="s2">&quot;(A28,I1,A4)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                          <span class="s2">&quot;bssn-constraints-statistics-&quot;</span><span class="p">,</span> <span class="n">itr3</span>

      <span class="n">namefile_bssn</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>
      <span class="n">name_logfile</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">name_logfile</span> <span class="p">)</span>

      <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                  <span class="n">compute_and_export_tpo_constraints</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">namefile_bssn</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">name_logfile</span> <span class="p">)</span>

    <span class="n">ENDIF</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">compute_parts_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing BSSN constraints with particle data for BSSN&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="s2">&quot; formulation&quot;</span><span class="p">,</span> <span class="n">itr3</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn</span><span class="p">,</span> <span class="s2">&quot;(A23,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;bssn-constraints-parts-&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                           <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_sph</span><span class="p">,</span> <span class="s2">&quot;(A12,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;sph-density-&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">name_logfile</span><span class="p">,</span> <span class="s2">&quot;(A34,I1,A4)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                           <span class="s2">&quot;bssn-constraints-parts-statistics-&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.log&quot;</span>

      <span class="n">namefile_bssn</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>
      <span class="n">namefile_sph</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">sph_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_sph</span> <span class="p">)</span>
      <span class="n">name_logfile</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">name_logfile</span> <span class="p">)</span>

      <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                  <span class="n">compute_and_export_tpo_constraints</span><span class="p">(</span> <span class="n">particles_dist</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">namefile_bssn</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">name_logfile</span> <span class="p">)</span>

    <span class="n">ENDIF</span>

  <span class="n">ENDDO</span> <span class="n">compute_export_bssn_constraints_loop</span>

<span class="c">! Here the bug appears. Since I am only computing the constraints with particles</span>
<span class="c">! it must be in there</span>
<span class="c">!STOP</span>

  <span class="c">!</span>
  <span class="c">!-- The BSSN formulations on grids with different resolutions are ready</span>
  <span class="c">!-- to be used in a convergence test</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">debug</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

  <span class="c">!</span>
  <span class="c">!-- Perform the convergence test with the appropriate constraints</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">compute_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Performing convergence test with constraints computed &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;without particle data.&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_unknown</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                                          <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_known</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

  <span class="n">ENDIF</span>

  <span class="k">IF</span><span class="p">(</span> <span class="n">compute_parts_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Performing convergence test with constraints computed &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;with particle data.&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_unknown</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                                          <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_known</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

  <span class="n">ENDIF</span>

  <span class="k">CALL </span><span class="n">execution_timer</span><span class="p">%</span> <span class="n">stop_timer</span><span class="p">()</span>

  <span class="k">CALL </span><span class="nb">DATE_AND_TIME</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">values</span> <span class="p">)</span>
  <span class="n">end_time</span><span class="o">=</span> <span class="n">date</span> <span class="o">//</span> <span class="s2">&quot;-&quot;</span> <span class="o">//</span> <span class="nb">time</span>

<span class="c">!STOP</span>

  <span class="c">!</span>
  <span class="c">!-- Print the timers</span>
  <span class="c">!</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;================================================&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Timing and summaries&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;================================================&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="c">!PRINT *, &quot; * BSSN formulation with uniform resolution:&quot;, &amp;</span>
  <span class="c">!         bssn_forms( 1 )% get_dx(ref_lev)</span>
  <span class="c">!PRINT *, &quot;    and number of points:&quot;, bssn_forms( 1 )% get_ngrid_x(ref_lev), &amp;</span>
  <span class="c">!         &quot;**3&quot;</span>
  <span class="c">!original_dx</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">grid_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">importer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">bssn_computer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="c">!PRINT *, &quot; * BSSN formulation with uniform resolution:&quot;, &amp;</span>
  <span class="c">!         bssn_forms( 2 )% get_dx(ref_lev)</span>
  <span class="c">!PRINT *, &quot;    and number of points:&quot;, bssn_forms( 2 )% get_ngrid_x(ref_lev), &amp;</span>
  <span class="c">!         &quot;**3&quot;</span>
  <span class="c">!original_dx/2</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">grid_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">importer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">bssn_computer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="c">!PRINT *, &quot; * BSSN formulation with uniform resolution:&quot;, &amp;</span>
  <span class="c">!         bssn_forms( 3 )% get_dx(ref_lev)</span>
  <span class="c">!PRINT *, &quot;    and number of points:&quot;, bssn_forms( 3 )% get_ngrid_x(ref_lev), &amp;</span>
  <span class="c">!         &quot;**3&quot;</span>
  <span class="c">!original_dx/4</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">grid_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">importer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">bssn_computer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Total:&quot;</span>
  <span class="k">CALL </span><span class="n">execution_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>

  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Run started on &quot;</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot; and ended on &quot;</span><span class="p">,</span> <span class="n">end_time</span>
  <span class="k">PRINT</span> <span class="o">*</span>

  <span class="c">!</span>
  <span class="c">!-- Destruct the formatted Bin_NS object by hand, since the pointer to it is</span>
  <span class="c">!-- global (because it is bound to C++) and cannot be nullified by the</span>
  <span class="c">!-- destructor of bns. In case of multiple idbase objects, this would lead</span>
  <span class="c">!-- to problems...</span>
  <span class="c">!-- TODO: fix this</span>
  <span class="c">!</span>
  <span class="c">!CALL binary% destruct_binary()</span>


  <span class="k">CONTAINS</span>


<span class="k">  SUBROUTINE </span><span class="n">cauchy_convergence_test_known</span><span class="p">(</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">,</span> <span class="p">&amp;</span>
                                            <span class="n">use_constraints</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

    <span class="k">IMPLICIT NONE</span>

<span class="k">    CLASS</span><span class="p">(</span><span class="n">tpo</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="n">OUT</span> <span class="p">)</span><span class="kd">::</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span>
    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span><span class="kd">::</span> <span class="n">use_constraints</span><span class="p">,</span> <span class="n">ref_lev</span>

    <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span>

    <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">min_abs_y</span><span class="p">,</span> <span class="n">min_abs_z</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">abs_grid</span>

    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">tiny_real</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">30</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">grid_dx</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">point_dx2</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">convergence_factor</span>

    <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span><span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">name_cauchy_ct</span><span class="p">,</span> <span class="n">name_cauchy_parts_ct</span>

    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">exist</span>

    <span class="n">nx</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">ny</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">nz</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">ny</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">nz</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Computing convergence factor...&quot;</span>

    <span class="n">choose_constraints</span><span class="p">:</span> <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">use_constraints</span> <span class="p">)</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">shared_grid_loops1</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

            <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                        <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
                        <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

           <span class="p">)</span><span class="k">THEN</span>

<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span>
              <span class="k">STOP</span>

<span class="k">            </span><span class="n">ENDIF</span>

            <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
             <span class="nb">LOG</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="p">(</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))&amp;</span>
            <span class="o">/</span><span class="p">(</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span><span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops1</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_ct</span><span class="o">=</span> <span class="mi">3109</span>
      <span class="n">name_cauchy_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;cauchy_convergence_test_known.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing he arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

      <span class="n">shared_grid_loops2</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

            <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                        <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
                        <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

           <span class="p">)</span><span class="k">THEN</span>

<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span>
              <span class="k">STOP</span>

<span class="k">            </span><span class="n">ENDIF</span>

            <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
             <span class="nb">LOG</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
               <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC_parts</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)&amp;</span>
            <span class="o">/</span><span class="p">(</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>  <span class="p">&amp;</span>
             <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops2</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_parts_ct</span><span class="o">=</span> <span class="mi">3111</span>
      <span class="n">name_cauchy_parts_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">&amp;</span>
                            <span class="o">//</span> <span class="s2">&quot;cauchy_convergence_test_known_parts.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_parts_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing e arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_parts_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE </span><span class="n">DEFAULT</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** There is no well defined algorithm &quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;corresponding to the number&quot;</span><span class="p">,</span> <span class="n">use_constraints</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Please set use_constraints to 1 or 2.&quot;</span>
      <span class="k">STOP</span>

<span class="k">    END SELECT </span><span class="n">choose_constraints</span>

    <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span> <span class="p">)</span>

  <span class="k">END SUBROUTINE </span><span class="n">cauchy_convergence_test_known</span>


  <span class="k">SUBROUTINE </span><span class="n">cauchy_convergence_test_unknown</span><span class="p">(</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">,</span> <span class="p">&amp;</span>
                                              <span class="n">formul_dx4</span><span class="p">,</span> <span class="n">use_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                              <span class="n">ref_lev</span> <span class="p">)</span>

    <span class="k">IMPLICIT NONE</span>

<span class="k">    CLASS</span><span class="p">(</span><span class="n">tpo</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="n">OUT</span> <span class="p">)</span><span class="kd">::</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">,</span> <span class="n">formul_dx4</span>
    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span><span class="kd">::</span> <span class="n">use_constraints</span><span class="p">,</span> <span class="n">ref_lev</span>

    <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span>

    <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">min_abs_y</span><span class="p">,</span> <span class="n">min_abs_z</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">abs_grid</span>

    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">tiny_real</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">30</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">grid_dx</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">point_dx2</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">point_dx4</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">convergence_factor</span>

    <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span><span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">name_cauchy_ct</span><span class="p">,</span> <span class="n">name_cauchy_parts_ct</span>

    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">exist</span>

    <span class="n">nx</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">ny</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">nz</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">ny</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">nz</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Computing convergence factor...&quot;</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">debug</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_dx=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span> <span class="p">%</span>  <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_dy=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span>  <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_dz=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span>  <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>
      <span class="c">!STOP</span>
    <span class="n">ENDIF</span>

    <span class="n">choose_constraints</span><span class="p">:</span> <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">use_constraints</span> <span class="p">)</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">shared_grid_loops3</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

           <span class="c">! grid_dx( :, 1 + ix, 1 + iy, 1 + iz ) = &amp;</span>
           <span class="c">!            formul_dx%  get_grid_point(  &amp;</span>
           <span class="c">!                             1 + ix,   1 + iy,   1 + iz   )</span>
           <span class="c">! point_dx2= formul_dx2% get_grid_point( &amp;</span>
           <span class="c">!                             1 + 2*ix, 1 + 2*iy, 1 + 2*iz )</span>
           <span class="c">! point_dx4= formul_dx4% get_grid_point( &amp;</span>
           <span class="c">!                             1 + 4*ix, 1 + 4*iy, 1 + 4*iz )</span>
           <span class="c">!</span>
           <span class="c">! IF( grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(1) &amp;</span>
           <span class="c">!.OR. grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(1) &amp;</span>
           <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(2) &amp;</span>
           <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(2) &amp;</span>
           <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(3) &amp;</span>
           <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(3) &amp;</span>

            <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                       <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
            <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
            <span class="n">point_dx4</span><span class="o">=</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

           <span class="p">)</span><span class="k">THEN</span>

<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span>
              <span class="k">STOP</span>

<span class="k">            </span><span class="n">ENDIF</span>

            <span class="c">!convergence_factor( 1 + ix, 1 + iy, 1 + iz )= &amp;</span>
            <span class="c">! LOG( &amp;</span>
            <span class="c">! ABS( &amp;</span>
            <span class="c">! ( ABS(formul_dx%  get_HC( 1 + ix,   1 + iy,   1 + iz )) &amp;</span>
            <span class="c">! - ABS(formul_dx2% get_HC( 1 + 2*ix, 1 + 2*iy, 1 + 2*iz )))&amp;</span>
            <span class="c">!/( ABS(formul_dx2% get_HC( 1 + 2*ix, 1 + 2*iy, 1 + 2*iz )) &amp;</span>
            <span class="c">! - ABS(formul_dx4% get_HC( 1 + 4*ix, 1 + 4*iy, 1 + 4*iz ) )&amp;</span>
            <span class="c">! + 0*tiny_real ) &amp;</span>
            <span class="c">! ) &amp;</span>
            <span class="c">! )/ln2!/LOG(2.0)</span>

            <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
             <span class="nb">LOG</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
             <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                           <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)))</span> <span class="p">&amp;</span>
            <span class="o">/</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
             <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span><span class="p">&amp;</span>
             <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops3</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_ct</span><span class="o">=</span> <span class="mi">3108</span>
      <span class="n">name_cauchy_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">&amp;</span>
                      <span class="o">//</span><span class="s2">&quot;cauchy_convergence_test_unknown.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing the arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

      <span class="n">shared_grid_loops4</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

         <span class="c">! grid_dx( :, 1 + ix, 1 + iy, 1 + iz ) = &amp;</span>
         <span class="c">!            formul_dx%  get_grid_point(  &amp;</span>
         <span class="c">!                             1 + ix,   1 + iy,   1 + iz   )</span>
         <span class="c">! point_dx2= formul_dx2% get_grid_point( &amp;</span>
         <span class="c">!                             1 + 2*ix, 1 + 2*iy, 1 + 2*iz )</span>
         <span class="c">! point_dx4= formul_dx4% get_grid_point( &amp;</span>
         <span class="c">!                             1 + 4*ix, 1 + 4*iy, 1 + 4*iz )</span>
         <span class="c">!</span>
         <span class="c">! IF( grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(1) &amp;</span>
         <span class="c">!.OR. grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(1) &amp;</span>
         <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(2) &amp;</span>
         <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(2) &amp;</span>
         <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(3) &amp;</span>
         <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(3) &amp;</span>

          <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                     <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
          <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
          <span class="n">point_dx4</span><span class="o">=</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

          <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

         <span class="p">)</span><span class="k">THEN</span>

<span class="k">            PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
            <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">PRINT</span> <span class="o">*</span>
            <span class="k">STOP</span>

<span class="k">          </span><span class="n">ENDIF</span>

          <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
           <span class="nb">LOG</span><span class="p">(</span> <span class="p">&amp;</span>
           <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
           <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)))&amp;</span>
          <span class="o">/</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span> <span class="p">)&amp;</span>
           <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
           <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">&amp;</span>
           <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops4</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_parts_ct</span><span class="o">=</span> <span class="mi">3110</span>
      <span class="n">name_cauchy_parts_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">&amp;</span>
                            <span class="o">//</span><span class="s2">&quot;cauchy_convergence_test_unknown_parts.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_parts_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing the arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_parts_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE </span><span class="n">DEFAULT</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** There is no well defined algorithm &quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;corresponding to the number&quot;</span><span class="p">,</span> <span class="n">use_constraints</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Please set use_constraints to 1 or 2.&quot;</span>
      <span class="k">STOP</span>

<span class="k">    END SELECT </span><span class="n">choose_constraints</span>

    <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span> <span class="p">)</span>

  <span class="k">END SUBROUTINE </span><span class="n">cauchy_convergence_test_unknown</span>


<span class="k">END PROGRAM </span><span class="n">convergence_test</span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-05-24 07:35:10           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>