<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Documentation of \mathrm{SPHINCS\_ID} Figure caption: Projection of the SPH particles on the xy plane, for a binary neutron star system with gravitational masses of 1.2M_\odot (left) and 1.8M_\odot (right), with equation of state 'BBKF(DD2-SF) quark-hadron model RDF 1.8 (with electrons)' from the \texttt{CompOSE} database. The solution was computed with \texttt{LORENE} and the \texttt{CompOSE} software, and the particles were placed with \texttt{SPHINCS_ID} using the Artificial Pressure Method. The color bar shows the baryon mass density. The plot was made with \texttt{SPLASH} and \texttt{GIMP}.">
    <meta name="author" content="Francesco Torsello" >
    <link rel="icon" href="../favicon.png">

    <title>convergence_test &ndash; SPHINCS_ID</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">SPHINCS_ID <small>1.0</small></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href='../page/index.html'>More</a></li>
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="../lists/files.html">Source Files</a></li>
            <li><a href="../lists/modules.html">Modules</a></li>
            <li><a href="../lists/procedures.html">Procedures</a></li>
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="../lists/types.html">Derived Types</a></li>
            <li><a href="../lists/programs.html">Programs</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>
          </ul>
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>convergence_test    <small>Program</small>
    </h1>
    <div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title="62.9% of total for programs.">720 statements</a>
     </li> 
    <li><i class="fa fa-code"></i><a href="../src/convergence_test.f90"> Source File</a></li>
  </ul>
  <ol class="breadcrumb in-well text-right">
     <li><a href='../sourcefile/convergence_test.f90.html'>convergence_test.f90</a></li>
     <li class="active">convergence_test</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    <div id="sidebar">
  <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-0">Variables</a></h3></div>
  <div id="vars-0" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../program/convergence_test.html#variable-bssn_forms">bssn_forms</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-debug~12">debug</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-dir_out">dir_out</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-execution_timer">execution_timer</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-exist~25">exist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-idata~2">idata</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-max_bssn">max_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-min_bssn">min_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-name_logfile~5">name_logfile</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn">namefile_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn_bin">namefile_bssn_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts">namefile_parts</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts_bin">namefile_parts_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_sph">namefile_sph</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-original_dx">original_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-particles_dist">particles_dist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-ratio_dx">ratio_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems">systems</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems_name">systems_name</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_known">cauchy_convergence_test_known</a>
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_unknown">cauchy_convergence_test_unknown</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../program/convergence_test.html#src">convergence_test</a>
  </div>
</div>

</div>

    </div>
    
    <div class="col-md-9" id='text'>
        <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      <li class="list-group-item">
  <ul class="list-inline">
    <li><a href='../module/sphincs_id_fuka.html'>sphincs_id_fuka</a></li>
    <li><a href='../module/sphincs_id_full.html'>sphincs_id_full</a></li>
    <li><a href='../module/standard_tpo_formulation.html'>standard_tpo_formulation</a></li>
    <li>IFPORT</li>
    <li><a href='../module/sphincs_id_lorene.html'>sphincs_id_lorene</a></li>
    <li><a href='../module/sphincs_id_interpolate.html'>sphincs_id_interpolate</a></li>
    <li><a href='../module/bssn_formulation.html'>bssn_formulation</a></li>
    <li><a href='../module/id_base.html'>id_base</a></li>
    <li><a href='../module/utility.html'>utility</a></li>
    <li><a href="http://fortranwiki.org/fortran/show/iso_fortran_env">iso_fortran_env</a></li>
    <li><a href='../module/sph_particles.html'>sph_particles</a></li>
    <li>timing</li>
  </ul>
      </li>
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~convergence_test~~UsesGraph Pages: 1 -->
<svg id="programconvergence_testUsesGraph" width="641pt" height="451pt"
 viewBox="0.00 0.00 641.00 450.63" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~convergence_test~~UsesGraph" class="graph" transform="scale(1.23 1.23) rotate(0) translate(4 551.38)">
<title>program~~convergence_test~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-551.38 786,-551.38 786,4 -4,4"/>
<!-- program~convergence_test -->
<g id="program~~convergence_test~~UsesGraph_node1" class="node">
<title>program~convergence_test</title>
<polygon fill="none" stroke="black" points="782,-285 675,-285 675,-261 782,-261 782,-285"/>
<text text-anchor="middle" x="728.5" y="-270.6" font-family="Helvetica,sans-Serif" font-size="10.50">convergence_test</text>
</g>
<!-- module~sphincs_id_lorene -->
<g id="program~~convergence_test~~UsesGraph_node2" class="node">
<title>module~sphincs_id_lorene</title>
<g id="a_program~~convergence_test~~UsesGraph_node2"><a xlink:href=".././module/sphincs_id_lorene.html" xlink:title="sphincs_id_lorene">
<polygon fill="#337ab7" stroke="#337ab7" points="626.5,-264 520.5,-264 520.5,-240 626.5,-240 626.5,-264"/>
<text text-anchor="middle" x="573.5" y="-249.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_lorene</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge11" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.85,-265.77C662.57,-264.09 649.38,-262.28 636.73,-260.54"/>
<polygon fill="#000000" stroke="#000000" points="637.12,-257.06 626.73,-259.17 636.16,-264 637.12,-257.06"/>
</g>
<!-- module~standard_tpo_formulation -->
<g id="program~~convergence_test~~UsesGraph_node3" class="node">
<title>module~standard_tpo_formulation</title>
<g id="a_program~~convergence_test~~UsesGraph_node3"><a xlink:href=".././module/standard_tpo_formulation.html" xlink:title="standard_tpo_formulation">
<polygon fill="#337ab7" stroke="#337ab7" points="472,-504 322,-504 322,-480 472,-480 472,-504"/>
<text text-anchor="middle" x="397" y="-489.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">standard_tpo_formulation</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~standard_tpo_formulation -->
<g id="program~~convergence_test~~UsesGraph_edge1" class="edge">
<title>program~convergence_test&#45;&gt;module~standard_tpo_formulation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.18,-285.2C715.94,-329.7 677.19,-483.35 574.5,-534"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.5,-534C549.05,-545.57 481.37,-523.92 437.51,-507.64"/>
<polygon fill="#000000" stroke="#000000" points="438.59,-504.3 428,-504.05 436.12,-510.85 438.59,-504.3"/>
</g>
<!-- module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_node4" class="node">
<title>module~sph_particles</title>
<g id="a_program~~convergence_test~~UsesGraph_node4"><a xlink:href=".././module/sph_particles.html" xlink:title="sph_particles">
<polygon fill="#337ab7" stroke="#337ab7" points="274,-426 192,-426 192,-402 274,-402 274,-426"/>
<text text-anchor="middle" x="233" y="-411.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sph_particles</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_edge2" class="edge">
<title>program~convergence_test&#45;&gt;module~sph_particles</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.5,-376C474.97,-411.26 352.21,-416.04 284.56,-415.56"/>
<polygon fill="#000000" stroke="#000000" points="284.23,-412.05 274.19,-415.44 284.15,-419.05 284.23,-412.05"/>
</g>
<!-- IFPORT -->
<g id="program~~convergence_test~~UsesGraph_node5" class="node">
<title>IFPORT</title>
<polygon fill="#337ab7" stroke="#337ab7" points="600.5,-66 546.5,-66 546.5,-42 600.5,-42 600.5,-66"/>
<text text-anchor="middle" x="573.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">IFPORT</text>
</g>
<!-- program~convergence_test&#45;&gt;IFPORT -->
<g id="program~~convergence_test~~UsesGraph_edge3" class="edge">
<title>program~convergence_test&#45;&gt;IFPORT</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M725.18,-260.77C718.22,-227.26 694.47,-132.93 639,-80 630.99,-72.36 620.44,-66.85 610.21,-62.94"/>
<polygon fill="#000000" stroke="#000000" points="611.17,-59.57 600.58,-59.65 608.91,-66.19 611.17,-59.57"/>
</g>
<!-- module~bssn_formulation -->
<g id="program~~convergence_test~~UsesGraph_node6" class="node">
<title>module~bssn_formulation</title>
<g id="a_program~~convergence_test~~UsesGraph_node6"><a xlink:href=".././module/bssn_formulation.html" xlink:title="bssn_formulation">
<polygon fill="#337ab7" stroke="#337ab7" points="625.5,-428 521.5,-428 521.5,-404 625.5,-404 625.5,-428"/>
<text text-anchor="middle" x="573.5" y="-413.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bssn_formulation</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~bssn_formulation -->
<g id="program~~convergence_test~~UsesGraph_edge4" class="edge">
<title>program~convergence_test&#45;&gt;module~bssn_formulation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M721.15,-285.34C708.51,-308.8 678.04,-360.13 639,-390 634.27,-393.62 628.97,-396.81 623.49,-399.6"/>
<polygon fill="#000000" stroke="#000000" points="621.77,-396.54 614.18,-403.93 624.72,-402.89 621.77,-396.54"/>
</g>
<!-- module~id_base -->
<g id="program~~convergence_test~~UsesGraph_node7" class="node">
<title>module~id_base</title>
<g id="a_program~~convergence_test~~UsesGraph_node7"><a xlink:href=".././module/id_base.html" xlink:title="id_base">
<polygon fill="#337ab7" stroke="#337ab7" points="144,-312 90,-312 90,-288 144,-288 144,-312"/>
<text text-anchor="middle" x="117" y="-297.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">id_base</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge6" class="edge">
<title>program~convergence_test&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M717.96,-285.17C703.04,-303.41 672.4,-337.75 639,-357 613.11,-371.92 602.68,-366.04 574.5,-376"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.5,-376C499.38,-401.85 475.45,-371.99 398,-376"/>
</g>
<!-- module~sphincs_id_fuka -->
<g id="program~~convergence_test~~UsesGraph_node8" class="node">
<title>module~sphincs_id_fuka</title>
<g id="a_program~~convergence_test~~UsesGraph_node8"><a xlink:href=".././module/sphincs_id_fuka.html" xlink:title="sphincs_id_fuka">
<polygon fill="#337ab7" stroke="#337ab7" points="621,-306 526,-306 526,-282 621,-282 621,-306"/>
<text text-anchor="middle" x="573.5" y="-291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_fuka</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_fuka -->
<g id="program~~convergence_test~~UsesGraph_edge7" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_fuka</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M674.85,-280.23C660.8,-282.16 645.55,-284.25 631.29,-286.21"/>
<polygon fill="#000000" stroke="#000000" points="630.54,-282.78 621.11,-287.6 631.49,-289.71 630.54,-282.78"/>
</g>
<!-- module~sphincs_id_full -->
<g id="program~~convergence_test~~UsesGraph_node9" class="node">
<title>module~sphincs_id_full</title>
<g id="a_program~~convergence_test~~UsesGraph_node9"><a xlink:href=".././module/sphincs_id_full.html" xlink:title="sphincs_id_full">
<polygon fill="#337ab7" stroke="#337ab7" points="618,-222 529,-222 529,-198 618,-198 618,-222"/>
<text text-anchor="middle" x="573.5" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_full</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_full -->
<g id="program~~convergence_test~~UsesGraph_edge12" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_full</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M704.2,-260.93C686.56,-252.05 661.59,-240 639,-231 634.2,-229.09 629.15,-227.22 624.08,-225.42"/>
<polygon fill="#000000" stroke="#000000" points="624.95,-222.02 614.36,-222.09 622.68,-228.64 624.95,-222.02"/>
</g>
<!-- module~sphincs_id_interpolate -->
<g id="program~~convergence_test~~UsesGraph_node10" class="node">
<title>module~sphincs_id_interpolate</title>
<g id="a_program~~convergence_test~~UsesGraph_node10"><a xlink:href=".././module/sphincs_id_interpolate.html" xlink:title="sphincs_id_interpolate">
<polygon fill="#337ab7" stroke="#337ab7" points="639,-348 508,-348 508,-324 639,-324 639,-348"/>
<text text-anchor="middle" x="573.5" y="-333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sphincs_id_interpolate</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~sphincs_id_interpolate -->
<g id="program~~convergence_test~~UsesGraph_edge9" class="edge">
<title>program~convergence_test&#45;&gt;module~sphincs_id_interpolate</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M704.2,-285.07C686.56,-293.95 661.59,-306 639,-315 634.2,-316.91 629.15,-318.78 624.08,-320.58"/>
<polygon fill="#000000" stroke="#000000" points="622.68,-317.36 614.36,-323.91 624.95,-323.98 622.68,-317.36"/>
</g>
<!-- module~utility -->
<g id="program~~convergence_test~~UsesGraph_node11" class="node">
<title>module~utility</title>
<g id="a_program~~convergence_test~~UsesGraph_node11"><a xlink:href=".././module/utility.html" xlink:title="utility">
<polygon fill="#337ab7" stroke="#337ab7" points="144,-232 90,-232 90,-208 144,-208 144,-232"/>
<text text-anchor="middle" x="117" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">utility</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge10" class="edge">
<title>program~convergence_test&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M717.09,-260.82C701.53,-243.18 670.62,-210.32 639,-189 571.38,-143.41 548.9,-140.13 472,-113 439.98,-101.7 424.63,-115.07 398,-94"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M396,-94C321.53,-29.47 260.42,12.94 180,-44 129.94,-79.44 120.02,-158.71 118.24,-197.61"/>
<polygon fill="#000000" stroke="#000000" points="114.73,-197.76 117.92,-207.86 121.73,-197.98 114.73,-197.76"/>
</g>
<!-- timing -->
<g id="program~~convergence_test~~UsesGraph_node12" class="node">
<title>timing</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-293 0,-293 0,-269 54,-269 54,-293"/>
<text text-anchor="middle" x="27" y="-278.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timing</text>
</g>
<!-- program~convergence_test&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge5" class="edge">
<title>program~convergence_test&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M572.5,-534C502.95,-568.31 474.43,-520.84 398,-534"/>
</g>
<!-- iso_fortran_env -->
<g id="program~~convergence_test~~UsesGraph_node13" class="node">
<title>iso_fortran_env</title>
<g id="a_program~~convergence_test~~UsesGraph_node13"><a xlink:href="http://fortranwiki.org/fortran/show/iso_fortran_env" xlink:title="iso_fortran_env">
<polygon fill="#337ab7" stroke="#337ab7" points="620.5,-24 526.5,-24 526.5,0 620.5,0 620.5,-24"/>
<text text-anchor="middle" x="573.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_fortran_env</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;iso_fortran_env -->
<g id="program~~convergence_test~~UsesGraph_edge8" class="edge">
<title>program~convergence_test&#45;&gt;iso_fortran_env</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M726.64,-260.79C723.24,-221.75 707.32,-98.74 639,-33 636.25,-30.35 633.16,-28.04 629.87,-26.02"/>
<polygon fill="#000000" stroke="#000000" points="631.24,-22.79 620.75,-21.32 628.03,-29.01 631.24,-22.79"/>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge15" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M520.4,-262.89C457.91,-276.34 357.19,-299.35 322,-315 278.98,-334.14 280.41,-381.97 234,-374"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-374C193.84,-367.52 157.77,-338.96 136.79,-319.28"/>
<polygon fill="#000000" stroke="#000000" points="139.13,-316.67 129.51,-312.23 134.26,-321.7 139.13,-316.67"/>
</g>
<!-- module~bns_lorene -->
<g id="program~~convergence_test~~UsesGraph_node14" class="node">
<title>module~bns_lorene</title>
<g id="a_program~~convergence_test~~UsesGraph_node14"><a xlink:href=".././module/bns_lorene.html" xlink:title="bns_lorene">
<polygon fill="#337ab7" stroke="#337ab7" points="432,-146 362,-146 362,-122 432,-122 432,-146"/>
<text text-anchor="middle" x="397" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bns_lorene</text>
</a>
</g>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~bns_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge13" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~bns_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M521.39,-239.85C516.55,-237.42 511.98,-234.5 508,-231 479.94,-206.31 500.53,-179.15 472,-155 463.49,-147.8 452.67,-143.06 441.94,-139.95"/>
<polygon fill="#000000" stroke="#000000" points="442.74,-136.54 432.19,-137.52 441.05,-143.33 442.74,-136.54"/>
</g>
<!-- module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_node15" class="node">
<title>module~ejecta_generic</title>
<g id="a_program~~convergence_test~~UsesGraph_node15"><a xlink:href=".././module/ejecta_generic.html" xlink:title="ejecta_generic">
<polygon fill="#337ab7" stroke="#337ab7" points="442.5,-348 351.5,-348 351.5,-324 442.5,-324 442.5,-348"/>
<text text-anchor="middle" x="397" y="-333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ejecta_generic</text>
</a>
</g>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge16" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M526.16,-264.04C519.83,-266.55 513.6,-269.51 508,-273 488.52,-285.13 491.34,-297.65 472,-310 465.85,-313.93 459.02,-317.36 452.08,-320.31"/>
<polygon fill="#000000" stroke="#000000" points="450.61,-317.13 442.59,-324.06 453.18,-323.64 450.61,-317.13"/>
</g>
<!-- module~diffstar_lorene -->
<g id="program~~convergence_test~~UsesGraph_node17" class="node">
<title>module~diffstar_lorene</title>
<g id="a_program~~convergence_test~~UsesGraph_node17"><a xlink:href=".././module/diffstar_lorene.html" xlink:title="diffstar_lorene">
<polygon fill="#337ab7" stroke="#337ab7" points="441.5,-188 352.5,-188 352.5,-164 441.5,-164 441.5,-188"/>
<text text-anchor="middle" x="397" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diffstar_lorene</text>
</a>
</g>
</g>
<!-- module~sphincs_id_lorene&#45;&gt;module~diffstar_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge14" class="edge">
<title>module~sphincs_id_lorene&#45;&gt;module~diffstar_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M526.63,-239.87C520.17,-237.37 513.77,-234.43 508,-231 489.08,-219.76 491.14,-207.87 472,-197 465.61,-193.37 458.56,-190.33 451.41,-187.8"/>
<polygon fill="#000000" stroke="#000000" points="452.26,-184.39 441.67,-184.65 450.1,-191.05 452.26,-184.39"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_edge17" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;module~sph_particles</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.92,-479.9C342.46,-476.15 331.55,-471.52 322,-466 303.72,-455.43 304.03,-445.99 286,-435 283.34,-433.38 280.54,-431.84 277.66,-430.38"/>
<polygon fill="#000000" stroke="#000000" points="278.89,-427.08 268.35,-426.01 275.91,-433.42 278.89,-427.08"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge18" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-496C209.9,-485.17 197.28,-494.51 180,-477 137.31,-433.73 123.91,-359.44 119.78,-322.38"/>
<polygon fill="#000000" stroke="#000000" points="123.24,-321.76 118.78,-312.15 116.27,-322.45 123.24,-321.76"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge19" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M349.94,-504.06C316.12,-510.4 270,-513.64 234,-496"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-496C209.9,-485.17 195.85,-495.82 180,-477 122.37,-408.6 170.22,-364.51 144,-279 140.08,-266.22 134.16,-252.52 128.96,-241.54"/>
<polygon fill="#000000" stroke="#000000" points="131.99,-239.78 124.46,-232.33 125.7,-242.85 131.99,-239.78"/>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge20" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-496C186.5,-473.71 161.86,-521.36 118,-496"/>
</g>
<!-- mesh_refinement -->
<g id="program~~convergence_test~~UsesGraph_node19" class="node">
<title>mesh_refinement</title>
<polygon fill="#337ab7" stroke="#337ab7" points="286,-468 180,-468 180,-444 286,-444 286,-468"/>
<text text-anchor="middle" x="233" y="-453.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mesh_refinement</text>
</g>
<!-- module~standard_tpo_formulation&#45;&gt;mesh_refinement -->
<g id="program~~convergence_test~~UsesGraph_edge21" class="edge">
<title>module~standard_tpo_formulation&#45;&gt;mesh_refinement</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M341.61,-479.91C327.04,-476.68 311.19,-473.15 296.24,-469.83"/>
<polygon fill="#000000" stroke="#000000" points="296.58,-466.32 286.06,-467.57 295.06,-473.15 296.58,-466.32"/>
</g>
<!-- module~sph_particles&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge24" class="edge">
<title>module~sph_particles&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M201.56,-401.91C194.05,-398.12 186.35,-393.46 180,-388 157.94,-369.03 139.78,-340.58 128.94,-321.2"/>
<polygon fill="#000000" stroke="#000000" points="131.92,-319.37 124.08,-312.25 125.77,-322.71 131.92,-319.37"/>
</g>
<!-- module~sph_particles&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge22" class="edge">
<title>module~sph_particles&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M220.71,-401.92C209.49,-389.52 192.24,-369.36 180,-350 167.82,-330.74 141.56,-273 127.44,-241.34"/>
<polygon fill="#000000" stroke="#000000" points="130.57,-239.78 123.31,-232.06 124.17,-242.62 130.57,-239.78"/>
</g>
<!-- module~sph_particles&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge23" class="edge">
<title>module~sph_particles&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M196.64,-426.07C190.88,-428.66 185.13,-431.64 180,-435 147.68,-456.2 151.46,-515.35 118,-496"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M116,-496C47.14,-456.18 32.15,-350.09 28.9,-303.49"/>
<polygon fill="#000000" stroke="#000000" points="32.38,-303.03 28.31,-293.25 25.39,-303.43 32.38,-303.03"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~standard_tpo_formulation -->
<g id="program~~convergence_test~~UsesGraph_edge25" class="edge">
<title>module~bssn_formulation&#45;&gt;module~standard_tpo_formulation</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M550.12,-428.13C530,-438.8 499.47,-454.4 472,-466 463.34,-469.66 453.97,-473.23 444.9,-476.51"/>
<polygon fill="#000000" stroke="#000000" points="443.49,-473.29 435.23,-479.93 445.83,-479.89 443.49,-473.29"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~sph_particles -->
<g id="program~~convergence_test~~UsesGraph_edge26" class="edge">
<title>module~bssn_formulation&#45;&gt;module~sph_particles</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.06,-428.05C496.98,-437.6 444.65,-449.71 398,-452"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M396,-452C353.12,-454.1 305.42,-440.95 272.96,-429.56"/>
<polygon fill="#000000" stroke="#000000" points="273.99,-426.21 263.39,-426.09 271.61,-432.79 273.99,-426.21"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge27" class="edge">
<title>module~bssn_formulation&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M543,-404C508.65,-391.26 449.99,-373.31 398,-376"/>
</g>
<!-- module~bssn_formulation&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge28" class="edge">
<title>module~bssn_formulation&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.09,-403.86C518.53,-400.35 512.51,-395.83 508,-390 432.04,-291.81 554.27,-205.98 472,-113 449.5,-87.57 424.63,-115.07 398,-94"/>
</g>
<!-- module~bssn_formulation&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge29" class="edge">
<title>module~bssn_formulation&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M563.36,-428.08C547.19,-448.61 511.52,-490.27 472,-513 442.37,-530.05 431.74,-528.51 398,-534"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M396,-534C272.91,-554.03 225.95,-558.43 118,-496"/>
</g>
<!-- module~bssn_formulation&#45;&gt;mesh_refinement -->
<g id="program~~convergence_test~~UsesGraph_edge30" class="edge">
<title>module~bssn_formulation&#45;&gt;mesh_refinement</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M396,-452C363.2,-453.61 326.62,-454.58 296.54,-455.16"/>
<polygon fill="#000000" stroke="#000000" points="296.12,-451.67 286.19,-455.35 296.25,-458.67 296.12,-451.67"/>
</g>
<!-- module~id_base&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge31" class="edge">
<title>module~id_base&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M89.6,-294.3C81.52,-292.56 72.49,-290.61 63.9,-288.75"/>
<polygon fill="#000000" stroke="#000000" points="64.59,-285.32 54.08,-286.63 63.12,-292.16 64.59,-285.32"/>
</g>
<!-- module~sphincs_id_fuka&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge33" class="edge">
<title>module~sphincs_id_fuka&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.95,-305.72C519.66,-308.28 513.49,-311.34 508,-315 487.55,-328.65 492.87,-344.01 472,-357 443.17,-374.94 431.91,-374.24 398,-376"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M396,-376C324.09,-379.72 304.97,-386.19 234,-374"/>
</g>
<!-- module~sphincs_id_fuka&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge32" class="edge">
<title>module~sphincs_id_fuka&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M525.74,-305.26C503.21,-310.68 476.06,-317.21 452.59,-322.86"/>
<polygon fill="#000000" stroke="#000000" points="451.69,-319.48 442.78,-325.22 453.33,-326.28 451.69,-319.48"/>
</g>
<!-- module~bns_fuka -->
<g id="program~~convergence_test~~UsesGraph_node16" class="node">
<title>module~bns_fuka</title>
<g id="a_program~~convergence_test~~UsesGraph_node16"><a xlink:href=".././module/bns_fuka.html" xlink:title="bns_fuka">
<polygon fill="#337ab7" stroke="#337ab7" points="426.5,-230 367.5,-230 367.5,-206 426.5,-206 426.5,-230"/>
<text text-anchor="middle" x="397" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bns_fuka</text>
</a>
</g>
</g>
<!-- module~sphincs_id_fuka&#45;&gt;module~bns_fuka -->
<g id="program~~convergence_test~~UsesGraph_edge34" class="edge">
<title>module~sphincs_id_fuka&#45;&gt;module~bns_fuka</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M532.25,-281.92C524.14,-279.2 515.74,-276.17 508,-273 480.64,-261.78 450.69,-246.6 428.95,-235.03"/>
<polygon fill="#000000" stroke="#000000" points="430.35,-231.81 419.88,-230.16 427.03,-237.97 430.35,-231.81"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge38" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M533.04,-222.02C514.58,-227.48 492.24,-233.86 472,-239 405.84,-255.8 388.11,-254.99 322,-272 282.5,-282.17 273.64,-288.42 234,-298"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~bns_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge35" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~bns_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M553.5,-197.91C533.74,-185.76 501.63,-167.13 472,-155 462.45,-151.09 451.93,-147.63 441.89,-144.7"/>
<polygon fill="#000000" stroke="#000000" points="442.63,-141.27 432.06,-141.95 440.75,-148.02 442.63,-141.27"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge36" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.7,-220.72C521.47,-223.47 514.29,-226.85 508,-231 487.75,-244.34 489.21,-254.92 472,-272 455.73,-288.15 436.04,-305.07 421.06,-317.45"/>
<polygon fill="#000000" stroke="#000000" points="418.79,-314.78 413.28,-323.83 423.23,-320.2 418.79,-314.78"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~bns_fuka -->
<g id="program~~convergence_test~~UsesGraph_edge37" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~bns_fuka</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.92,-212C500.67,-213.29 464.19,-214.97 436.91,-216.22"/>
<polygon fill="#000000" stroke="#000000" points="436.41,-212.74 426.58,-216.69 436.73,-219.73 436.41,-212.74"/>
</g>
<!-- module~sphincs_id_full&#45;&gt;module~diffstar_lorene -->
<g id="program~~convergence_test~~UsesGraph_edge39" class="edge">
<title>module~sphincs_id_full&#45;&gt;module~diffstar_lorene</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M528.92,-201.51C505.49,-196.94 476.41,-191.28 451.61,-186.45"/>
<polygon fill="#000000" stroke="#000000" points="452.12,-182.98 441.63,-184.5 450.78,-189.85 452.12,-182.98"/>
</g>
<!-- module~sphincs_id_interpolate&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge41" class="edge">
<title>module~sphincs_id_interpolate&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M536.59,-348.08C501.67,-358.91 446.89,-373.47 398,-376"/>
</g>
<!-- module~sphincs_id_interpolate&#45;&gt;module~ejecta_generic -->
<g id="program~~convergence_test~~UsesGraph_edge40" class="edge">
<title>module~sphincs_id_interpolate&#45;&gt;module~ejecta_generic</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M507.52,-336C489.63,-336 470.39,-336 453.11,-336"/>
<polygon fill="#000000" stroke="#000000" points="452.64,-332.5 442.64,-336 452.64,-339.5 452.64,-332.5"/>
</g>
<!-- matrix -->
<g id="program~~convergence_test~~UsesGraph_node18" class="node">
<title>matrix</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-232 0,-232 0,-208 54,-208 54,-232"/>
<text text-anchor="middle" x="27" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">matrix</text>
</g>
<!-- module~utility&#45;&gt;matrix -->
<g id="program~~convergence_test~~UsesGraph_edge42" class="edge">
<title>module~utility&#45;&gt;matrix</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M89.6,-220C81.61,-220 72.69,-220 64.18,-220"/>
<polygon fill="#000000" stroke="#000000" points="64.08,-216.5 54.08,-220 64.08,-223.5 64.08,-216.5"/>
</g>
<!-- module~bns_lorene&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge43" class="edge">
<title>module~bns_lorene&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.79,-125.59C308.22,-113.29 207.8,-94.03 180,-115 133.5,-150.07 163.79,-186.22 144,-241 139.4,-253.74 133.34,-267.61 128.23,-278.7"/>
<polygon fill="#000000" stroke="#000000" points="124.95,-277.45 123.87,-287.99 131.29,-280.43 124.95,-277.45"/>
</g>
<!-- module~bns_lorene&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge46" class="edge">
<title>module~bns_lorene&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.99,-124.33C349.12,-120.08 334.55,-114.56 322,-108 282.13,-87.16 278.02,-48.73 234,-58"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-58C207.09,-63.25 197.91,-63.91 180,-82 147.42,-114.92 130.3,-167.97 122.81,-197.79"/>
<polygon fill="#000000" stroke="#000000" points="119.37,-197.11 120.47,-207.65 126.18,-198.73 119.37,-197.11"/>
</g>
<!-- module~bns_lorene&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge47" class="edge">
<title>module~bns_lorene&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M383.28,-121.76C363.61,-103.26 324.07,-67.82 286,-44 264.42,-30.5 257.96,-28.59 234,-20"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-20C138.32,13.6 158.18,-79.42 54,-241 49.96,-247.27 45.54,-254.07 41.52,-260.26"/>
<polygon fill="#000000" stroke="#000000" points="38.51,-258.47 35.99,-268.76 44.38,-262.29 38.51,-258.47"/>
</g>
<!-- module~bns_base -->
<g id="program~~convergence_test~~UsesGraph_node20" class="node">
<title>module~bns_base</title>
<g id="a_program~~convergence_test~~UsesGraph_node20"><a xlink:href=".././module/bns_base.html" xlink:title="bns_base">
<polygon fill="#337ab7" stroke="#337ab7" points="264,-232 202,-232 202,-208 264,-208 264,-232"/>
<text text-anchor="middle" x="233" y="-217.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bns_base</text>
</a>
</g>
</g>
<!-- module~bns_lorene&#45;&gt;module~bns_base -->
<g id="program~~convergence_test~~UsesGraph_edge45" class="edge">
<title>module~bns_lorene&#45;&gt;module~bns_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.74,-139.18C348.56,-142.3 333.83,-147.23 322,-155 300.88,-168.86 306.35,-184.02 286,-199 282.14,-201.84 277.83,-204.37 273.4,-206.6"/>
<polygon fill="#000000" stroke="#000000" points="271.89,-203.44 264.23,-210.75 274.78,-209.82 271.89,-203.44"/>
</g>
<!-- iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_node21" class="node">
<title>iso_c_binding</title>
<g id="a_program~~convergence_test~~UsesGraph_node21"><a xlink:href="http://fortranwiki.org/fortran/show/iso_c_binding" xlink:title="iso_c_binding">
<polygon fill="#337ab7" stroke="#337ab7" points="275,-190 191,-190 191,-166 275,-166 275,-190"/>
<text text-anchor="middle" x="233" y="-175.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">iso_c_binding</text>
</a>
</g>
</g>
<!-- module~bns_lorene&#45;&gt;iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_edge44" class="edge">
<title>module~bns_lorene&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M361.64,-143.33C339.34,-149.39 309.88,-157.39 284.89,-164.18"/>
<polygon fill="#000000" stroke="#000000" points="283.93,-160.81 275.19,-166.81 285.76,-167.57 283.93,-160.81"/>
</g>
<!-- module~ejecta_generic&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge49" class="edge">
<title>module~ejecta_generic&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M359.49,-348.07C319.47,-360.67 257.77,-378.08 234,-374"/>
</g>
<!-- module~ejecta_generic&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge48" class="edge">
<title>module~ejecta_generic&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M351.22,-329.04C305.95,-320.69 235.01,-303.91 180,-274 163.49,-265.02 147.57,-251 136,-239.5"/>
<polygon fill="#000000" stroke="#000000" points="138.21,-236.75 128.72,-232.03 133.19,-241.63 138.21,-236.75"/>
</g>
<!-- module~bns_fuka&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge50" class="edge">
<title>module~bns_fuka&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.21,-225.5C353.07,-229.82 336.09,-236 322,-244 303.89,-254.28 303.61,-262.87 286,-274 264.48,-287.6 258.74,-292.02 234,-298"/>
</g>
<!-- module~bns_fuka&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge53" class="edge">
<title>module~bns_fuka&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.24,-227.03C328.07,-239.06 259.84,-258.97 234,-260"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-260C201.74,-261.21 169.35,-248.33 146.86,-236.87"/>
<polygon fill="#000000" stroke="#000000" points="148.34,-233.69 137.86,-232.09 145.05,-239.88 148.34,-233.69"/>
</g>
<!-- module~bns_fuka&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge54" class="edge">
<title>module~bns_fuka&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-260C172.93,-262.36 104.66,-270.5 63.98,-275.92"/>
<polygon fill="#000000" stroke="#000000" points="63.45,-272.46 54.01,-277.27 64.39,-279.4 63.45,-272.46"/>
</g>
<!-- module~bns_fuka&#45;&gt;module~bns_base -->
<g id="program~~convergence_test~~UsesGraph_edge52" class="edge">
<title>module~bns_fuka&#45;&gt;module~bns_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.41,-218.35C341.6,-218.67 303.36,-219.14 274.42,-219.5"/>
<polygon fill="#000000" stroke="#000000" points="274.18,-216 264.23,-219.63 274.27,-223 274.18,-216"/>
</g>
<!-- module~bns_fuka&#45;&gt;iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_edge51" class="edge">
<title>module~bns_fuka&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M367.41,-210.94C344.6,-205.31 312.06,-197.27 284.83,-190.55"/>
<polygon fill="#000000" stroke="#000000" points="285.62,-187.14 275.07,-188.14 283.94,-193.94 285.62,-187.14"/>
</g>
<!-- module~diffstar_lorene&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge55" class="edge">
<title>module~diffstar_lorene&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.24,-181.86C341.45,-184.97 330.54,-189.73 322,-197 293.23,-221.48 312.78,-247.35 286,-274 267.96,-291.95 258.74,-292.02 234,-298"/>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M232,-298C206.59,-304.14 177.05,-304.48 154.41,-303.37"/>
<polygon fill="#000000" stroke="#000000" points="154.41,-299.86 144.22,-302.75 153.99,-306.85 154.41,-299.86"/>
</g>
<!-- module~diffstar_lorene&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge58" class="edge">
<title>module~diffstar_lorene&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.41,-168C341.96,-164.92 331.18,-160.72 322,-155 272.6,-124.22 290.96,-46 234,-58"/>
</g>
<!-- module~diffstar_lorene&#45;&gt;timing -->
<g id="program~~convergence_test~~UsesGraph_edge59" class="edge">
<title>module~diffstar_lorene&#45;&gt;timing</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.38,-171.06C341.34,-167.95 330.27,-162.97 322,-155 284.65,-119.01 320.43,-82.78 286,-44 269.1,-24.96 257.96,-28.59 234,-20"/>
</g>
<!-- module~diffstar_lorene&#45;&gt;iso_c_binding -->
<g id="program~~convergence_test~~UsesGraph_edge56" class="edge">
<title>module~diffstar_lorene&#45;&gt;iso_c_binding</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.16,-176.54C331.55,-176.8 306.83,-177.1 285.34,-177.37"/>
<polygon fill="#000000" stroke="#000000" points="285.04,-173.87 275.09,-177.49 285.13,-180.87 285.04,-173.87"/>
</g>
<!-- module~diffstar_base -->
<g id="program~~convergence_test~~UsesGraph_node22" class="node">
<title>module~diffstar_base</title>
<g id="a_program~~convergence_test~~UsesGraph_node22"><a xlink:href=".././module/diffstar_base.html" xlink:title="diffstar_base">
<polygon fill="#337ab7" stroke="#337ab7" points="273.5,-148 192.5,-148 192.5,-124 273.5,-124 273.5,-148"/>
<text text-anchor="middle" x="233" y="-133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">diffstar_base</text>
</a>
</g>
</g>
<!-- module~diffstar_lorene&#45;&gt;module~diffstar_base -->
<g id="program~~convergence_test~~UsesGraph_edge57" class="edge">
<title>module~diffstar_lorene&#45;&gt;module~diffstar_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M352.16,-165.18C330.95,-159.94 305.4,-153.63 283.5,-148.22"/>
<polygon fill="#000000" stroke="#000000" points="284.26,-144.81 273.72,-145.81 282.59,-151.6 284.26,-144.81"/>
</g>
<!-- module~bns_base&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge61" class="edge">
<title>module~bns_base&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M204.55,-232.11C196.41,-236.13 187.63,-240.89 180,-246 164.77,-256.2 149.23,-269.75 137.51,-280.72"/>
<polygon fill="#000000" stroke="#000000" points="134.88,-278.4 130.06,-287.84 139.71,-283.46 134.88,-278.4"/>
</g>
<!-- module~bns_base&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge60" class="edge">
<title>module~bns_base&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M201.75,-220C187.17,-220 169.57,-220 154.28,-220"/>
<polygon fill="#000000" stroke="#000000" points="154.13,-216.5 144.13,-220 154.13,-223.5 154.13,-216.5"/>
</g>
<!-- module~diffstar_base&#45;&gt;module~id_base -->
<g id="program~~convergence_test~~UsesGraph_edge63" class="edge">
<title>module~diffstar_base&#45;&gt;module~id_base</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M192.46,-148C187.91,-150.49 183.62,-153.46 180,-157 150.98,-185.42 160.19,-203.75 144,-241 138.6,-253.42 132.5,-267.27 127.57,-278.44"/>
<polygon fill="#000000" stroke="#000000" points="124.26,-277.25 123.41,-287.81 130.66,-280.09 124.26,-277.25"/>
</g>
<!-- module~diffstar_base&#45;&gt;module~utility -->
<g id="program~~convergence_test~~UsesGraph_edge62" class="edge">
<title>module~diffstar_base&#45;&gt;module~utility</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M196.6,-148C190.84,-150.59 185.1,-153.59 180,-157 162.24,-168.85 145.48,-186.43 133.87,-200.01"/>
<polygon fill="#000000" stroke="#000000" points="131.04,-197.93 127.34,-207.86 136.42,-202.41 131.04,-197.93"/>
</g>
</g>
</svg>
</div><script>var panprogramconvergence_testUsesGraph = svgPanZoom('#programconvergence_testUsesGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="516pt" height="32pt"
 viewBox="0.00 0.00 516.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 512,-28 512,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="385.5,-24 328.5,-24 328.5,0 385.5,0 385.5,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="508,-24 404,-24 404,0 508,0 508,-24"/>
<text text-anchor="middle" x="456" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses.
    </p>
    </div></div></div></div>
      </li>
      </ul>
    </div>

    <p>Make a convergence test to check the validity of
  the code \(\texttt{SPHINCS_ID}\).</p>
<p>FT 8.12.2020</p>
<hr>
    <br>
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: program~~convergence_test~~CallsGraph Pages: 1 -->
<svg id="programconvergence_testCallsGraph" width="641pt" height="349pt"
 viewBox="0.00 0.00 641.00 349.13" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="program~~convergence_test~~CallsGraph" class="graph" transform="scale(2.5 2.5) rotate(0) translate(4 868)">
<title>program~~convergence_test~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-868 1597,-868 1597,4 -4,4"/>
<!-- program~convergence_test -->
<g id="program~~convergence_test~~CallsGraph_node1" class="node">
<title>program~convergence_test</title>
<polygon fill="none" stroke="black" points="107,-245 0,-245 0,-221 107,-221 107,-245"/>
<text text-anchor="middle" x="53.5" y="-230.6" font-family="Helvetica,sans-Serif" font-size="10.50">convergence_test</text>
</g>
<!-- proc~cauchy_convergence_test_known -->
<g id="program~~convergence_test~~CallsGraph_node2" class="node">
<title>proc~cauchy_convergence_test_known</title>
<g id="a_program~~convergence_test~~CallsGraph_node2"><a xlink:href=".././proc/cauchy_convergence_test_known.html" xlink:title="cauchy_convergence_test_known">
<polygon fill="#d9534f" stroke="#d9534f" points="340,-392 150,-392 150,-368 340,-368 340,-392"/>
<text text-anchor="middle" x="245" y="-377.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cauchy_convergence_test_known</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~cauchy_convergence_test_known -->
<g id="program~~convergence_test~~CallsGraph_edge2" class="edge">
<title>program~convergence_test&#45;&gt;proc~cauchy_convergence_test_known</title>
<path fill="none" stroke="#000000" d="M59.42,-245.38C70.31,-271.05 99,-330.06 143,-359 145.61,-360.72 148.33,-362.3 151.14,-363.75"/>
<polygon fill="#000000" stroke="#000000" points="149.82,-366.99 160.37,-367.98 152.73,-360.63 149.82,-366.99"/>
</g>
<!-- proc~allocate_idbase -->
<g id="program~~convergence_test~~CallsGraph_node3" class="node">
<title>proc~allocate_idbase</title>
<g id="a_program~~convergence_test~~CallsGraph_node3"><a xlink:href=".././proc/allocate_idbase.html" xlink:title="allocate_idbase">
<polygon fill="#d9534f" stroke="#d9534f" points="293,-350 197,-350 197,-326 293,-326 293,-350"/>
<text text-anchor="middle" x="245" y="-335.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_idbase</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~allocate_idbase -->
<g id="program~~convergence_test~~CallsGraph_edge1" class="edge">
<title>program~convergence_test&#45;&gt;proc~allocate_idbase</title>
<path fill="none" stroke="#000000" d="M63.61,-245.21C78.19,-263.82 108.65,-299.02 143,-317 156.41,-324.02 171.97,-328.69 186.8,-331.8"/>
<polygon fill="#000000" stroke="#000000" points="186.44,-335.3 196.92,-333.72 187.74,-328.42 186.44,-335.3"/>
</g>
<!-- interface~particles -->
<g id="program~~convergence_test~~CallsGraph_node4" class="node">
<title>interface~particles</title>
<g id="a_program~~convergence_test~~CallsGraph_node4"><a xlink:href=".././interface/particles.html" xlink:title="particles">
<polygon fill="#a7506f" stroke="#a7506f" points="274,-308 216,-308 216,-284 274,-284 274,-308"/>
<text text-anchor="middle" x="245" y="-293.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">particles</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;interface~particles -->
<g id="program~~convergence_test~~CallsGraph_edge3" class="edge">
<title>program~convergence_test&#45;&gt;interface~particles</title>
<path fill="none" stroke="#000000" d="M76.08,-245.03C93.64,-254.37 119.3,-267.04 143,-275 163.29,-281.82 186.65,-286.84 205.79,-290.27"/>
<polygon fill="#000000" stroke="#000000" points="205.21,-293.72 215.66,-291.96 206.39,-286.82 205.21,-293.72"/>
</g>
<!-- makedirqq -->
<g id="program~~convergence_test~~CallsGraph_node5" class="node">
<title>makedirqq</title>
<polygon fill="#777777" stroke="#777777" points="280,-266 210,-266 210,-242 280,-242 280,-266"/>
<text text-anchor="middle" x="245" y="-251.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">makedirqq</text>
</g>
<!-- program~convergence_test&#45;&gt;makedirqq -->
<g id="program~~convergence_test~~CallsGraph_edge4" class="edge">
<title>program~convergence_test&#45;&gt;makedirqq</title>
<path fill="none" stroke="#000000" d="M107.03,-238.82C136.17,-242.05 172.01,-246.02 199.71,-249.09"/>
<polygon fill="#000000" stroke="#000000" points="199.58,-252.6 209.9,-250.22 200.35,-245.64 199.58,-252.6"/>
</g>
<!-- proc~read_sphincs_id_parameters -->
<g id="program~~convergence_test~~CallsGraph_node6" class="node">
<title>proc~read_sphincs_id_parameters</title>
<g id="a_program~~convergence_test~~CallsGraph_node6"><a xlink:href=".././proc/read_sphincs_id_parameters.html" xlink:title="read_sphincs_id_parameters">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-224 163,-224 163,-200 327,-200 327,-224"/>
<text text-anchor="middle" x="245" y="-209.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_sphincs_id_parameters</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~read_sphincs_id_parameters -->
<g id="program~~convergence_test~~CallsGraph_edge5" class="edge">
<title>program~convergence_test&#45;&gt;proc~read_sphincs_id_parameters</title>
<path fill="none" stroke="#000000" d="M107.03,-227.18C121.23,-225.6 137.02,-223.86 152.68,-222.12"/>
<polygon fill="#000000" stroke="#000000" points="153.38,-225.56 162.93,-220.98 152.61,-218.61 153.38,-225.56"/>
</g>
<!-- proc~cauchy_convergence_test_unknown -->
<g id="program~~convergence_test~~CallsGraph_node7" class="node">
<title>proc~cauchy_convergence_test_unknown</title>
<g id="a_program~~convergence_test~~CallsGraph_node7"><a xlink:href=".././proc/cauchy_convergence_test_unknown.html" xlink:title="cauchy_convergence_test_unknown">
<polygon fill="#d9534f" stroke="#d9534f" points="347,-182 143,-182 143,-158 347,-158 347,-182"/>
<text text-anchor="middle" x="245" y="-167.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cauchy_convergence_test_unknown</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;proc~cauchy_convergence_test_unknown -->
<g id="program~~convergence_test~~CallsGraph_edge6" class="edge">
<title>program~convergence_test&#45;&gt;proc~cauchy_convergence_test_unknown</title>
<path fill="none" stroke="#000000" d="M76.08,-220.97C93.64,-211.63 119.3,-198.96 143,-191 150.08,-188.62 157.54,-186.46 165.06,-184.51"/>
<polygon fill="#000000" stroke="#000000" points="166.09,-187.86 174.96,-182.06 164.41,-181.06 166.09,-187.86"/>
</g>
<!-- interface~bssn -->
<g id="program~~convergence_test~~CallsGraph_node8" class="node">
<title>interface~bssn</title>
<g id="a_program~~convergence_test~~CallsGraph_node8"><a xlink:href=".././interface/bssn.html" xlink:title="bssn">
<polygon fill="#a7506f" stroke="#a7506f" points="272,-90 218,-90 218,-66 272,-66 272,-90"/>
<text text-anchor="middle" x="245" y="-75.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">bssn</text>
</a>
</g>
</g>
<!-- program~convergence_test&#45;&gt;interface~bssn -->
<g id="program~~convergence_test~~CallsGraph_edge7" class="edge">
<title>program~convergence_test&#45;&gt;interface~bssn</title>
<path fill="none" stroke="#000000" d="M60.54,-220.8C72.86,-197.12 103.13,-144.64 143,-115 162.23,-100.7 187.56,-91.44 208.04,-85.76"/>
<polygon fill="#000000" stroke="#000000" points="209.16,-89.09 217.95,-83.18 207.39,-82.31 209.16,-89.09"/>
</g>
<!-- timer -->
<g id="program~~convergence_test~~CallsGraph_node9" class="node">
<title>timer</title>
<polygon fill="#777777" stroke="#777777" points="854.5,-108 800.5,-108 800.5,-84 854.5,-84 854.5,-108"/>
<text text-anchor="middle" x="827.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">timer</text>
</g>
<!-- program~convergence_test&#45;&gt;timer -->
<g id="program~~convergence_test~~CallsGraph_edge8" class="edge">
<title>program~convergence_test&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M62.88,-220.87C76.92,-201.7 107.19,-164.92 143,-149 260.43,-96.79 666.13,-94.95 790.18,-95.65"/>
<polygon fill="#000000" stroke="#000000" points="790.27,-99.15 800.29,-95.72 790.32,-92.15 790.27,-99.15"/>
</g>
<!-- interface~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_node10" class="node">
<title>interface~construct_particles_std</title>
<g id="a_program~~convergence_test~~CallsGraph_node10"><a xlink:href=".././interface/construct_particles_std.html" xlink:title="construct_particles_std">
<polygon fill="#a7506f" stroke="#a7506f" points="517.5,-477 383.5,-477 383.5,-453 517.5,-453 517.5,-477"/>
<text text-anchor="middle" x="450.5" y="-462.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_std</text>
</a>
</g>
</g>
<!-- interface~particles&#45;&gt;interface~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_edge9" class="edge">
<title>interface~particles&#45;&gt;interface~construct_particles_std</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M274.29,-296.33C295.82,-297.83 325.35,-302.66 347,-317 394.49,-348.46 426.32,-410.15 440.71,-443.07"/>
<polygon fill="#000000" stroke="#000000" points="437.65,-444.83 444.77,-452.68 444.1,-442.1 437.65,-444.83"/>
</g>
<!-- interface~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_node11" class="node">
<title>interface~construct_particles_bin</title>
<g id="a_program~~convergence_test~~CallsGraph_node11"><a xlink:href=".././interface/construct_particles_bin.html" xlink:title="construct_particles_bin">
<polygon fill="#a7506f" stroke="#a7506f" points="518,-309 383,-309 383,-285 518,-285 518,-309"/>
<text text-anchor="middle" x="450.5" y="-294.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_bin</text>
</a>
</g>
</g>
<!-- interface~particles&#45;&gt;interface~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_edge10" class="edge">
<title>interface~particles&#45;&gt;interface~construct_particles_bin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M274.3,-296.14C299.74,-296.26 338.31,-296.45 372.79,-296.62"/>
<polygon fill="#000000" stroke="#000000" points="372.85,-300.12 382.87,-296.67 372.88,-293.12 372.85,-300.12"/>
</g>
<!-- interface~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_node12" class="node">
<title>interface~construct_bssn</title>
<g id="a_program~~convergence_test~~CallsGraph_node12"><a xlink:href=".././interface/construct_bssn.html" xlink:title="construct_bssn">
<polygon fill="#a7506f" stroke="#a7506f" points="496,-78 405,-78 405,-54 496,-54 496,-78"/>
<text text-anchor="middle" x="450.5" y="-63.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_bssn</text>
</a>
</g>
</g>
<!-- interface~bssn&#45;&gt;interface~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge11" class="edge">
<title>interface~bssn&#45;&gt;interface~construct_bssn</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M272.19,-76.46C303,-74.64 354.99,-71.57 394.72,-69.23"/>
<polygon fill="#000000" stroke="#000000" points="395.03,-72.72 404.8,-68.64 394.61,-65.73 395.03,-72.72"/>
</g>
<!-- proc~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_node13" class="node">
<title>proc~construct_particles_std</title>
<g id="a_program~~convergence_test~~CallsGraph_node13"><a xlink:href=".././proc/construct_particles_std.html" xlink:title="construct_particles_std">
<polygon fill="#d94e8f" stroke="#d94e8f" points="688.5,-612 554.5,-612 554.5,-588 688.5,-588 688.5,-612"/>
<text text-anchor="middle" x="621.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_std</text>
</a>
</g>
</g>
<!-- interface~construct_particles_std&#45;&gt;proc~construct_particles_std -->
<g id="program~~convergence_test~~CallsGraph_edge12" class="edge">
<title>interface~construct_particles_std&#45;&gt;proc~construct_particles_std</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M466.8,-477.22C496.46,-500.91 561.96,-553.24 597.12,-581.32"/>
<polygon fill="#000000" stroke="#000000" points="595.36,-584.4 605.36,-587.91 599.73,-578.93 595.36,-584.4"/>
</g>
<!-- proc~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_node14" class="node">
<title>proc~construct_particles_bin</title>
<g id="a_program~~convergence_test~~CallsGraph_node14"><a xlink:href=".././proc/construct_particles_bin.html" xlink:title="construct_particles_bin">
<polygon fill="#d94e8f" stroke="#d94e8f" points="689,-312 554,-312 554,-288 689,-288 689,-312"/>
<text text-anchor="middle" x="621.5" y="-297.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_particles_bin</text>
</a>
</g>
</g>
<!-- interface~construct_particles_bin&#45;&gt;proc~construct_particles_bin -->
<g id="program~~convergence_test~~CallsGraph_edge13" class="edge">
<title>interface~construct_particles_bin&#45;&gt;proc~construct_particles_bin</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M518.29,-298.19C526.62,-298.33 535.19,-298.49 543.66,-298.64"/>
<polygon fill="#000000" stroke="#000000" points="543.85,-302.14 553.92,-298.82 543.98,-295.14 543.85,-302.14"/>
</g>
<!-- proc~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_node15" class="node">
<title>proc~construct_bssn</title>
<g id="a_program~~convergence_test~~CallsGraph_node15"><a xlink:href=".././proc/construct_bssn.html" xlink:title="construct_bssn">
<polygon fill="#d94e8f" stroke="#d94e8f" points="667,-77 576,-77 576,-53 667,-53 667,-77"/>
<text text-anchor="middle" x="621.5" y="-62.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">construct_bssn</text>
</a>
</g>
</g>
<!-- interface~construct_bssn&#45;&gt;proc~construct_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge14" class="edge">
<title>interface~construct_bssn&#45;&gt;proc~construct_bssn</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M496.35,-65.73C517.63,-65.61 543.26,-65.46 565.69,-65.32"/>
<polygon fill="#000000" stroke="#000000" points="565.76,-68.82 575.74,-65.26 565.72,-61.82 565.76,-68.82"/>
</g>
<!-- proc~construct_particles_std&#45;&gt;timer -->
<g id="program~~convergence_test~~CallsGraph_edge26" class="edge">
<title>proc~construct_particles_std&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M625.68,-587.82C635.73,-549.03 667.48,-424.86 689,-321 707.68,-230.85 660.86,-183.05 725,-117 741.59,-99.92 768.15,-94.88 789.95,-94.01"/>
<polygon fill="#000000" stroke="#000000" points="790.24,-97.5 800.19,-93.88 790.15,-90.5 790.24,-97.5"/>
</g>
<!-- set_units -->
<g id="program~~convergence_test~~CallsGraph_node16" class="node">
<title>set_units</title>
<polygon fill="#777777" stroke="#777777" points="857,-444 798,-444 798,-420 857,-420 857,-444"/>
<text text-anchor="middle" x="827.5" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_units</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;set_units -->
<g id="program~~convergence_test~~CallsGraph_edge16" class="edge">
<title>proc~construct_particles_std&#45;&gt;set_units</title>
<path fill="none" stroke="#000000" d="M627.25,-587.76C639.05,-559.12 672.53,-487.6 725,-453 743.42,-440.85 767.48,-435.52 787.56,-433.27"/>
<polygon fill="#000000" stroke="#000000" points="788,-436.74 797.64,-432.35 787.36,-429.77 788,-436.74"/>
</g>
<!-- alive -->
<g id="program~~convergence_test~~CallsGraph_node19" class="node">
<title>alive</title>
<polygon fill="#777777" stroke="#777777" points="854.5,-864 800.5,-864 800.5,-840 854.5,-840 854.5,-864"/>
<text text-anchor="middle" x="827.5" y="-849.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">alive</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;alive -->
<g id="program~~convergence_test~~CallsGraph_edge23" class="edge">
<title>proc~construct_particles_std&#45;&gt;alive</title>
<path fill="none" stroke="#000000" d="M624.01,-612.12C629.5,-650.81 652.08,-772.2 725,-831 743.21,-845.69 769.11,-850.87 790.19,-852.42"/>
<polygon fill="#000000" stroke="#000000" points="790.24,-855.93 800.4,-852.92 790.58,-848.93 790.24,-855.93"/>
</g>
<!-- proc~spatial_vector_norm_sym3x3 -->
<g id="program~~convergence_test~~CallsGraph_node21" class="node">
<title>proc~spatial_vector_norm_sym3x3</title>
<g id="a_program~~convergence_test~~CallsGraph_node21"><a xlink:href=".././proc/spatial_vector_norm_sym3x3.html" xlink:title="spatial_vector_norm_sym3x3">
<polygon fill="#d9534f" stroke="#d9534f" points="911,-822 744,-822 744,-798 911,-798 911,-822"/>
<text text-anchor="middle" x="827.5" y="-807.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spatial_vector_norm_sym3x3</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;proc~spatial_vector_norm_sym3x3 -->
<g id="program~~convergence_test~~CallsGraph_edge25" class="edge">
<title>proc~construct_particles_std&#45;&gt;proc~spatial_vector_norm_sym3x3</title>
<path fill="none" stroke="#000000" d="M625.26,-612.07C633.69,-645.95 662.38,-742.48 725,-789 728.07,-791.28 731.33,-793.33 734.73,-795.16"/>
<polygon fill="#000000" stroke="#000000" points="733.46,-798.44 744,-799.55 736.45,-792.11 733.46,-798.44"/>
</g>
<!-- ktable -->
<g id="program~~convergence_test~~CallsGraph_node23" class="node">
<title>ktable</title>
<polygon fill="#777777" stroke="#777777" points="854.5,-780 800.5,-780 800.5,-756 854.5,-756 854.5,-780"/>
<text text-anchor="middle" x="827.5" y="-765.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ktable</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;ktable -->
<g id="program~~convergence_test~~CallsGraph_edge17" class="edge">
<title>proc~construct_particles_std&#45;&gt;ktable</title>
<path fill="none" stroke="#000000" d="M627.25,-612.24C639.05,-640.88 672.53,-712.4 725,-747 744.28,-759.71 769.73,-764.96 790.33,-767.03"/>
<polygon fill="#000000" stroke="#000000" points="790.05,-770.51 800.3,-767.82 790.61,-763.54 790.05,-770.51"/>
</g>
<!-- interface~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_node24" class="node">
<title>interface~impose_equatorial_plane_symmetry</title>
<g id="a_program~~convergence_test~~CallsGraph_node24"><a xlink:href=".././interface/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#a7506f" stroke="#a7506f" points="930,-738 725,-738 725,-714 930,-714 930,-738"/>
<text text-anchor="middle" x="827.5" y="-723.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;interface~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_edge18" class="edge">
<title>proc~construct_particles_std&#45;&gt;interface~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" d="M630.47,-612C645.89,-634.2 682.09,-681.52 725,-705 728.54,-706.94 732.24,-708.7 736.04,-710.29"/>
<polygon fill="#000000" stroke="#000000" points="735.08,-713.67 745.67,-713.94 737.56,-707.12 735.08,-713.67"/>
</g>
<!-- interface~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_node25" class="node">
<title>interface~check_particle_positions</title>
<g id="a_program~~convergence_test~~CallsGraph_node25"><a xlink:href=".././interface/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#a7506f" stroke="#a7506f" points="898.5,-696 756.5,-696 756.5,-672 898.5,-672 898.5,-696"/>
<text text-anchor="middle" x="827.5" y="-681.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;interface~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_edge19" class="edge">
<title>proc~construct_particles_std&#45;&gt;interface~check_particle_positions</title>
<path fill="none" stroke="#000000" d="M638.26,-612.12C657.62,-626.42 691.99,-649.91 725,-663 731.92,-665.74 739.25,-668.15 746.69,-670.26"/>
<polygon fill="#000000" stroke="#000000" points="745.93,-673.67 756.49,-672.85 747.72,-666.91 745.93,-673.67"/>
</g>
<!-- read_options -->
<g id="program~~convergence_test~~CallsGraph_node26" class="node">
<title>read_options</title>
<polygon fill="#777777" stroke="#777777" points="868,-486 787,-486 787,-462 868,-462 868,-486"/>
<text text-anchor="middle" x="827.5" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">read_options</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;read_options -->
<g id="program~~convergence_test~~CallsGraph_edge20" class="edge">
<title>proc~construct_particles_std&#45;&gt;read_options</title>
<path fill="none" stroke="#000000" d="M630.47,-588C645.89,-565.8 682.09,-518.48 725,-495 740.56,-486.49 759.18,-481.42 776.2,-478.4"/>
<polygon fill="#000000" stroke="#000000" points="777.21,-481.78 786.55,-476.77 776.12,-474.87 777.21,-481.78"/>
</g>
<!-- none~reflect_particles_yz_plane -->
<g id="program~~convergence_test~~CallsGraph_node27" class="node">
<title>none~reflect_particles_yz_plane</title>
<polygon fill="#d9534f" stroke="#d9534f" points="902,-654 753,-654 753,-630 902,-630 902,-654"/>
<text text-anchor="middle" x="827.5" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_yz_plane</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;none~reflect_particles_yz_plane -->
<g id="program~~convergence_test~~CallsGraph_edge21" class="edge">
<title>proc~construct_particles_std&#45;&gt;none~reflect_particles_yz_plane</title>
<path fill="none" stroke="#000000" d="M680.96,-612.04C705.07,-617 733.18,-622.79 758.24,-627.95"/>
<polygon fill="#000000" stroke="#000000" points="757.53,-631.37 768.03,-629.96 758.94,-624.52 757.53,-631.37"/>
</g>
<!-- interface~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_node28" class="node">
<title>interface~allocate_particles_memory</title>
<g id="a_program~~convergence_test~~CallsGraph_node28"><a xlink:href=".././interface/allocate_particles_memory.html" xlink:title="allocate_particles_memory">
<polygon fill="#a7506f" stroke="#a7506f" points="906,-612 749,-612 749,-588 906,-588 906,-612"/>
<text text-anchor="middle" x="827.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_particles_memory</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;interface~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_edge22" class="edge">
<title>proc~construct_particles_std&#45;&gt;interface~allocate_particles_memory</title>
<path fill="none" stroke="#000000" d="M688.73,-600C704.63,-600 721.85,-600 738.56,-600"/>
<polygon fill="#000000" stroke="#000000" points="738.89,-603.5 748.89,-600 738.89,-596.5 738.89,-603.5"/>
</g>
<!-- proc~spherical_from_cartesian -->
<g id="program~~convergence_test~~CallsGraph_node30" class="node">
<title>proc~spherical_from_cartesian</title>
<g id="a_program~~convergence_test~~CallsGraph_node30"><a xlink:href=".././proc/spherical_from_cartesian.html" xlink:title="spherical_from_cartesian">
<polygon fill="#d9534f" stroke="#d9534f" points="900.5,-570 754.5,-570 754.5,-546 900.5,-546 900.5,-570"/>
<text text-anchor="middle" x="827.5" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spherical_from_cartesian</text>
</a>
</g>
</g>
<!-- proc~construct_particles_std&#45;&gt;proc~spherical_from_cartesian -->
<g id="program~~convergence_test~~CallsGraph_edge24" class="edge">
<title>proc~construct_particles_std&#45;&gt;proc~spherical_from_cartesian</title>
<path fill="none" stroke="#000000" d="M680.96,-587.96C705.07,-583 733.18,-577.21 758.24,-572.05"/>
<polygon fill="#000000" stroke="#000000" points="758.94,-575.48 768.03,-570.04 757.53,-568.63 758.94,-575.48"/>
</g>
<!-- shorten_eos_name -->
<g id="program~~convergence_test~~CallsGraph_node31" class="node">
<title>shorten_eos_name</title>
<polygon fill="#777777" stroke="#777777" points="884,-528 771,-528 771,-504 884,-504 884,-528"/>
<text text-anchor="middle" x="827.5" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shorten_eos_name</text>
</g>
<!-- proc~construct_particles_std&#45;&gt;shorten_eos_name -->
<g id="program~~convergence_test~~CallsGraph_edge15" class="edge">
<title>proc~construct_particles_std&#45;&gt;shorten_eos_name</title>
<path fill="none" stroke="#000000" d="M638.26,-587.88C657.62,-573.58 691.99,-550.09 725,-537 736.3,-532.52 748.71,-528.94 760.86,-526.1"/>
<polygon fill="#000000" stroke="#000000" points="761.94,-529.44 770.96,-523.88 760.45,-522.6 761.94,-529.44"/>
</g>
<!-- proc~construct_particles_bin&#45;&gt;set_units -->
<g id="program~~convergence_test~~CallsGraph_edge27" class="edge">
<title>proc~construct_particles_bin&#45;&gt;set_units</title>
<path fill="none" stroke="#000000" d="M630.06,-312.33C645.05,-335.65 680.93,-386.08 725,-411 744.07,-421.79 767.97,-427.06 787.78,-429.63"/>
<polygon fill="#000000" stroke="#000000" points="787.4,-433.11 797.72,-430.74 788.17,-426.15 787.4,-433.11"/>
</g>
<!-- omp_set_num_threads -->
<g id="program~~convergence_test~~CallsGraph_node17" class="node">
<title>omp_set_num_threads</title>
<polygon fill="#777777" stroke="#777777" points="893.5,-402 761.5,-402 761.5,-378 893.5,-378 893.5,-402"/>
<text text-anchor="middle" x="827.5" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">omp_set_num_threads</text>
</g>
<!-- proc~construct_particles_bin&#45;&gt;omp_set_num_threads -->
<g id="program~~convergence_test~~CallsGraph_edge29" class="edge">
<title>proc~construct_particles_bin&#45;&gt;omp_set_num_threads</title>
<path fill="none" stroke="#000000" d="M636.72,-312.25C655.61,-327.85 690.6,-354.52 725,-369 733.4,-372.54 742.46,-375.5 751.58,-377.97"/>
<polygon fill="#000000" stroke="#000000" points="750.91,-381.41 761.47,-380.46 752.63,-374.62 750.91,-381.41"/>
</g>
<!-- deallocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_node18" class="node">
<title>deallocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="899,-360 756,-360 756,-336 899,-336 899,-360"/>
<text text-anchor="middle" x="827.5" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_sph_memory</text>
</g>
<!-- proc~construct_particles_bin&#45;&gt;deallocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_edge31" class="edge">
<title>proc~construct_particles_bin&#45;&gt;deallocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M666.01,-312.01C684.19,-316.89 705.56,-322.43 725,-327 734.96,-329.34 745.49,-331.68 755.87,-333.89"/>
<polygon fill="#000000" stroke="#000000" points="755.23,-337.34 765.73,-335.98 756.67,-330.49 755.23,-337.34"/>
</g>
<!-- proc~spacetime_vector_norm_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_node20" class="node">
<title>proc~spacetime_vector_norm_sym4x4</title>
<g id="a_program~~convergence_test~~CallsGraph_node20"><a xlink:href=".././proc/spacetime_vector_norm_sym4x4.html" xlink:title="spacetime_vector_norm_sym4x4">
<polygon fill="#d9534f" stroke="#d9534f" points="921,-318 734,-318 734,-294 921,-294 921,-318"/>
<text text-anchor="middle" x="827.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">spacetime_vector_norm_sym4x4</text>
</a>
</g>
</g>
<!-- proc~construct_particles_bin&#45;&gt;proc~spacetime_vector_norm_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_edge33" class="edge">
<title>proc~construct_particles_bin&#45;&gt;proc~spacetime_vector_norm_sym4x4</title>
<path fill="none" stroke="#000000" d="M689.01,-301.96C700.08,-302.28 711.77,-302.63 723.49,-302.97"/>
<polygon fill="#000000" stroke="#000000" points="723.67,-306.48 733.77,-303.27 723.88,-299.48 723.67,-306.48"/>
</g>
<!-- proc~construct_particles_bin&#45;&gt;read_options -->
<g id="program~~convergence_test~~CallsGraph_edge30" class="edge">
<title>proc~construct_particles_bin&#45;&gt;read_options</title>
<path fill="none" stroke="#000000" d="M626.94,-312.3C638.25,-341.79 671.15,-416.77 725,-453 740.1,-463.16 759.11,-468.57 776.59,-471.4"/>
<polygon fill="#000000" stroke="#000000" points="776.28,-474.89 786.66,-472.78 777.23,-467.95 776.28,-474.89"/>
</g>
<!-- select_eos_parameters -->
<g id="program~~convergence_test~~CallsGraph_node32" class="node">
<title>select_eos_parameters</title>
<polygon fill="#777777" stroke="#777777" points="895.5,-276 759.5,-276 759.5,-252 895.5,-252 895.5,-276"/>
<text text-anchor="middle" x="827.5" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">select_eos_parameters</text>
</g>
<!-- proc~construct_particles_bin&#45;&gt;select_eos_parameters -->
<g id="program~~convergence_test~~CallsGraph_edge28" class="edge">
<title>proc~construct_particles_bin&#45;&gt;select_eos_parameters</title>
<path fill="none" stroke="#000000" d="M689.01,-288.26C708.31,-284.86 729.54,-281.11 749.43,-277.6"/>
<polygon fill="#000000" stroke="#000000" points="750.14,-281.03 759.38,-275.85 748.92,-274.14 750.14,-281.03"/>
</g>
<!-- allocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_node33" class="node">
<title>allocate_sph_memory</title>
<polygon fill="#777777" stroke="#777777" points="892.5,-234 762.5,-234 762.5,-210 892.5,-210 892.5,-234"/>
<text text-anchor="middle" x="827.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_sph_memory</text>
</g>
<!-- proc~construct_particles_bin&#45;&gt;allocate_sph_memory -->
<g id="program~~convergence_test~~CallsGraph_edge32" class="edge">
<title>proc~construct_particles_bin&#45;&gt;allocate_sph_memory</title>
<path fill="none" stroke="#000000" d="M640.21,-287.95C660.03,-275 693.51,-254.7 725,-243 733.76,-239.74 743.15,-236.94 752.55,-234.55"/>
<polygon fill="#000000" stroke="#000000" points="753.41,-237.94 762.32,-232.2 751.77,-231.14 753.41,-237.94"/>
</g>
<!-- proc~determinant_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_node34" class="node">
<title>proc~determinant_sym4x4</title>
<g id="a_program~~convergence_test~~CallsGraph_node34"><a xlink:href=".././proc/determinant_sym4x4.html" xlink:title="determinant_sym4x4">
<polygon fill="#d9534f" stroke="#d9534f" points="890,-192 765,-192 765,-168 890,-168 890,-192"/>
<text text-anchor="middle" x="827.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">determinant_sym4x4</text>
</a>
</g>
</g>
<!-- proc~construct_particles_bin&#45;&gt;proc~determinant_sym4x4 -->
<g id="program~~convergence_test~~CallsGraph_edge34" class="edge">
<title>proc~construct_particles_bin&#45;&gt;proc~determinant_sym4x4</title>
<path fill="none" stroke="#000000" d="M631.39,-287.69C647.49,-266.39 683.66,-222.84 725,-201 734.28,-196.1 744.61,-192.34 755.02,-189.45"/>
<polygon fill="#000000" stroke="#000000" points="756.15,-192.78 764.99,-186.95 754.44,-185.99 756.15,-192.78"/>
</g>
<!-- proc~compute_g4 -->
<g id="program~~convergence_test~~CallsGraph_node35" class="node">
<title>proc~compute_g4</title>
<g id="a_program~~convergence_test~~CallsGraph_node35"><a xlink:href=".././proc/compute_g4.html" xlink:title="compute_g4">
<polygon fill="#d9534f" stroke="#d9534f" points="867,-150 788,-150 788,-126 867,-126 867,-150"/>
<text text-anchor="middle" x="827.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">compute_g4</text>
</a>
</g>
</g>
<!-- proc~construct_particles_bin&#45;&gt;proc~compute_g4 -->
<g id="program~~convergence_test~~CallsGraph_edge35" class="edge">
<title>proc~construct_particles_bin&#45;&gt;proc~compute_g4</title>
<path fill="none" stroke="#000000" d="M627.58,-287.84C639.85,-260.1 673.89,-191.99 725,-159 740.55,-148.97 759.98,-143.61 777.67,-140.78"/>
<polygon fill="#000000" stroke="#000000" points="778.4,-144.21 787.84,-139.4 777.46,-137.28 778.4,-144.21"/>
</g>
<!-- proc~construct_bssn&#45;&gt;timer -->
<g id="program~~convergence_test~~CallsGraph_edge38" class="edge">
<title>proc~construct_bssn&#45;&gt;timer</title>
<path fill="none" stroke="#000000" d="M667.02,-71.76C703.99,-77.38 755.92,-85.28 790.36,-90.51"/>
<polygon fill="#000000" stroke="#000000" points="790.04,-94 800.45,-92.04 791.09,-87.08 790.04,-94"/>
</g>
<!-- initialize_bssn -->
<g id="program~~convergence_test~~CallsGraph_node22" class="node">
<title>initialize_bssn</title>
<polygon fill="#777777" stroke="#777777" points="870.5,-66 784.5,-66 784.5,-42 870.5,-42 870.5,-66"/>
<text text-anchor="middle" x="827.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">initialize_bssn</text>
</g>
<!-- proc~construct_bssn&#45;&gt;initialize_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge37" class="edge">
<title>proc~construct_bssn&#45;&gt;initialize_bssn</title>
<path fill="none" stroke="#000000" d="M667.02,-62.6C698.44,-60.91 740.66,-58.63 773.77,-56.84"/>
<polygon fill="#000000" stroke="#000000" points="774.37,-60.32 784.17,-56.28 774,-53.33 774.37,-60.32"/>
</g>
<!-- deallocate_bssn -->
<g id="program~~convergence_test~~CallsGraph_node29" class="node">
<title>deallocate_bssn</title>
<polygon fill="#777777" stroke="#777777" points="876.5,-24 778.5,-24 778.5,0 876.5,0 876.5,-24"/>
<text text-anchor="middle" x="827.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">deallocate_bssn</text>
</g>
<!-- proc~construct_bssn&#45;&gt;deallocate_bssn -->
<g id="program~~convergence_test~~CallsGraph_edge36" class="edge">
<title>proc~construct_bssn&#45;&gt;deallocate_bssn</title>
<path fill="none" stroke="#000000" d="M658.3,-52.87C677.87,-46.48 702.62,-38.79 725,-33 738.88,-29.41 753.95,-26.02 768.12,-23.05"/>
<polygon fill="#000000" stroke="#000000" points="769.17,-26.41 778.26,-20.97 767.76,-19.55 769.17,-26.41"/>
</g>
<!-- proc~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_node37" class="node">
<title>proc~impose_equatorial_plane_symmetry</title>
<g id="a_program~~convergence_test~~CallsGraph_node37"><a xlink:href=".././proc/impose_equatorial_plane_symmetry.html" xlink:title="impose_equatorial_plane_symmetry">
<polygon fill="#d9534f" stroke="#d9534f" points="1171,-748 966,-748 966,-724 1171,-724 1171,-748"/>
<text text-anchor="middle" x="1068.5" y="-733.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">impose_equatorial_plane_symmetry</text>
</a>
</g>
</g>
<!-- interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry -->
<g id="program~~convergence_test~~CallsGraph_edge39" class="edge">
<title>interface~impose_equatorial_plane_symmetry&#45;&gt;proc~impose_equatorial_plane_symmetry</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M930.2,-730.26C938.7,-730.61 947.31,-730.97 955.87,-731.33"/>
<polygon fill="#000000" stroke="#000000" points="955.75,-734.83 965.89,-731.75 956.04,-727.83 955.75,-734.83"/>
</g>
<!-- proc~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_node36" class="node">
<title>proc~check_particle_positions</title>
<g id="a_program~~convergence_test~~CallsGraph_node36"><a xlink:href=".././proc/check_particle_positions.html" xlink:title="check_particle_positions">
<polygon fill="#d9534f" stroke="#d9534f" points="1139.5,-685 997.5,-685 997.5,-661 1139.5,-661 1139.5,-685"/>
<text text-anchor="middle" x="1068.5" y="-670.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_particle_positions</text>
</a>
</g>
</g>
<!-- interface~check_particle_positions&#45;&gt;proc~check_particle_positions -->
<g id="program~~convergence_test~~CallsGraph_edge40" class="edge">
<title>interface~check_particle_positions&#45;&gt;proc~check_particle_positions</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M898.59,-680.77C926.44,-679.49 958.63,-678.01 987.39,-676.69"/>
<polygon fill="#000000" stroke="#000000" points="987.58,-680.18 997.41,-676.23 987.26,-673.19 987.58,-680.18"/>
</g>
<!-- proc~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_node38" class="node">
<title>proc~allocate_particles_memory</title>
<g id="a_program~~convergence_test~~CallsGraph_node38"><a xlink:href=".././proc/allocate_particles_memory.html" xlink:title="allocate_particles_memory">
<polygon fill="#d9534f" stroke="#d9534f" points="1147,-612 990,-612 990,-588 1147,-588 1147,-612"/>
<text text-anchor="middle" x="1068.5" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">allocate_particles_memory</text>
</a>
</g>
</g>
<!-- interface~allocate_particles_memory&#45;&gt;proc~allocate_particles_memory -->
<g id="program~~convergence_test~~CallsGraph_edge41" class="edge">
<title>interface~allocate_particles_memory&#45;&gt;proc~allocate_particles_memory</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M906.1,-600C929.59,-600 955.56,-600 979.68,-600"/>
<polygon fill="#000000" stroke="#000000" points="979.88,-603.5 989.88,-600 979.88,-596.5 979.88,-603.5"/>
</g>
<!-- indexx -->
<g id="program~~convergence_test~~CallsGraph_node42" class="node">
<title>indexx</title>
<polygon fill="#777777" stroke="#777777" points="1321.5,-674 1267.5,-674 1267.5,-650 1321.5,-650 1321.5,-674"/>
<text text-anchor="middle" x="1294.5" y="-659.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">indexx</text>
</g>
<!-- proc~check_particle_positions&#45;&gt;indexx -->
<g id="program~~convergence_test~~CallsGraph_edge42" class="edge">
<title>proc~check_particle_positions&#45;&gt;indexx</title>
<path fill="none" stroke="#000000" d="M1139.76,-669.55C1178.72,-667.64 1225.55,-665.34 1257.21,-663.78"/>
<polygon fill="#000000" stroke="#000000" points="1257.51,-667.27 1267.33,-663.29 1257.17,-660.28 1257.51,-667.27"/>
</g>
<!-- interface~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node39" class="node">
<title>interface~reflect_particles_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node39"><a xlink:href=".././interface/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="1369.5,-800 1219.5,-800 1219.5,-776 1369.5,-776 1369.5,-800"/>
<text text-anchor="middle" x="1294.5" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge43" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" d="M1121.45,-748.06C1154.27,-755.68 1196.86,-765.57 1231.45,-773.6"/>
<polygon fill="#000000" stroke="#000000" points="1230.91,-777.06 1241.44,-775.91 1232.49,-770.24 1230.91,-777.06"/>
</g>
<!-- interface~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node40" class="node">
<title>interface~find_particles_above_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node40"><a xlink:href=".././interface/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#a7506f" stroke="#a7506f" points="1382,-758 1207,-758 1207,-734 1382,-734 1382,-758"/>
<text text-anchor="middle" x="1294.5" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge44" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;interface~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" d="M1171.01,-740.53C1179.49,-740.91 1188.05,-741.29 1196.49,-741.67"/>
<polygon fill="#000000" stroke="#000000" points="1196.57,-745.18 1206.72,-742.13 1196.88,-738.18 1196.57,-745.18"/>
</g>
<!-- com -->
<g id="program~~convergence_test~~CallsGraph_node41" class="node">
<title>com</title>
<polygon fill="#777777" stroke="#777777" points="1321.5,-716 1267.5,-716 1267.5,-692 1321.5,-692 1321.5,-716"/>
<text text-anchor="middle" x="1294.5" y="-701.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">com</text>
</g>
<!-- proc~impose_equatorial_plane_symmetry&#45;&gt;com -->
<g id="program~~convergence_test~~CallsGraph_edge45" class="edge">
<title>proc~impose_equatorial_plane_symmetry&#45;&gt;com</title>
<path fill="none" stroke="#000000" d="M1153.55,-723.99C1189.32,-718.88 1229.16,-713.19 1257.16,-709.19"/>
<polygon fill="#000000" stroke="#000000" points="1257.87,-712.63 1267.28,-707.75 1256.88,-705.7 1257.87,-712.63"/>
</g>
<!-- proc~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node43" class="node">
<title>proc~reflect_particles_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node43"><a xlink:href=".././proc/reflect_particles_xy_plane.html" xlink:title="reflect_particles_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1580.5,-800 1430.5,-800 1430.5,-776 1580.5,-776 1580.5,-800"/>
<text text-anchor="middle" x="1505.5" y="-785.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reflect_particles_xy_plane</text>
</a>
</g>
</g>
<!-- interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge46" class="edge">
<title>interface~reflect_particles_xy_plane&#45;&gt;proc~reflect_particles_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1369.77,-788C1386.1,-788 1403.5,-788 1420.18,-788"/>
<polygon fill="#000000" stroke="#000000" points="1420.47,-791.5 1430.47,-788 1420.47,-784.5 1420.47,-791.5"/>
</g>
<!-- proc~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_node44" class="node">
<title>proc~find_particles_above_xy_plane</title>
<g id="a_program~~convergence_test~~CallsGraph_node44"><a xlink:href=".././proc/find_particles_above_xy_plane.html" xlink:title="find_particles_above_xy_plane">
<polygon fill="#d9534f" stroke="#d9534f" points="1593,-758 1418,-758 1418,-734 1593,-734 1593,-758"/>
<text text-anchor="middle" x="1505.5" y="-743.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">find_particles_above_xy_plane</text>
</a>
</g>
</g>
<!-- interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane -->
<g id="program~~convergence_test~~CallsGraph_edge47" class="edge">
<title>interface~find_particles_above_xy_plane&#45;&gt;proc~find_particles_above_xy_plane</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1382.02,-746C1390.49,-746 1399.13,-746 1407.7,-746"/>
<polygon fill="#000000" stroke="#000000" points="1407.71,-749.5 1417.71,-746 1407.71,-742.5 1407.71,-749.5"/>
</g>
</g>
</svg>
</div><script>var panprogramconvergence_testCallsGraph = svgPanZoom('#programconvergence_testCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="594pt" height="32pt"
 viewBox="0.00 0.00 594.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 590,-28 590,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388,-24 244,-24 244,0 388,0 388,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="463.5,-24 406.5,-24 406.5,0 463.5,0 463.5,-24"/>
<text text-anchor="middle" x="435" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="586,-24 482,-24 482,0 586,0 586,-24"/>
<text text-anchor="middle" x="534" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
<br>
     <section class="visible-xs visible-sm hidden-md">
       <h3>Contents</h3>
 
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#vars-1">Variables</a></h3></div>
  <div id="vars-1" class="panel-collapse collapse">
    <div class="list-group">
      <a class="list-group-item" href="../program/convergence_test.html#variable-bssn_forms">bssn_forms</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-debug~12">debug</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-dir_out">dir_out</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-execution_timer">execution_timer</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-exist~25">exist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-idata~2">idata</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-max_bssn">max_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-min_bssn">min_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-name_logfile~5">name_logfile</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn">namefile_bssn</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_bssn_bin">namefile_bssn_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts">namefile_parts</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_parts_bin">namefile_parts_bin</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-namefile_sph">namefile_sph</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-original_dx">original_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-particles_dist">particles_dist</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-ratio_dx">ratio_dx</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems">systems</a>
      <a class="list-group-item" href="../program/convergence_test.html#variable-systems_name">systems_name</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_known">cauchy_convergence_test_known</a>
      <a class="list-group-item" href="../program/convergence_test.html#proc-cauchy_convergence_test_unknown">cauchy_convergence_test_unknown</a>
    </div>
  </div>
</div>
<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../program/convergence_test.html#src">convergence_test</a>
  </div>
</div>

     </section>
     <br class="visible-xs visible-sm hidden-md">


    <section>
    <h2>Variables</h2>
    <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Attributes</th><th></th><th>Name</th><th></th><th>Initial</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" id="variable-bssn_forms"></span>type(<a href='../type/bssn.html'>bssn</a>),</td>
  <td>DIMENSION(3)</td><td>::</td>
  <td><strong>bssn_forms</strong></td><td></td><td></td><td><p>Array storing the bssn objects,
 containing the BSSN variables on the gravity grid for each idbase object</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-debug~12"></span>logical,</td>
  <td>parameter</td><td>::</td>
  <td><strong>debug</strong></td><td> =</td><td>.FALSE.</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-dir_out"></span>logical(kind=4)</td>
  <td></td><td>::</td>
  <td><strong>dir_out</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-execution_timer"></span>type(timer)</td>
  <td></td><td>::</td>
  <td><strong>execution_timer</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-exist~25"></span>logical</td>
  <td></td><td>::</td>
  <td><strong>exist</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-idata~2"></span>class(<a href='../type/idbase.html'>idbase</a>),</td>
  <td>ALLOCATABLE</td><td>::</td>
  <td><strong>idata</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-max_bssn"></span>integer,</td>
  <td>parameter</td><td>::</td>
  <td><strong>max_bssn</strong></td><td> =</td><td>3</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-min_bssn"></span>integer,</td>
  <td>parameter</td><td>::</td>
  <td><strong>min_bssn</strong></td><td> =</td><td>1</td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-name_logfile~5"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>name_logfile</strong></td><td></td><td></td><td><p>String storing the name for the formatted file containing a summary about
 the \(\mathrm{BSSNOK}\) constraints violations</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_bssn"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_bssn</strong></td><td></td><td></td><td><p>String storing the name for the formatted file containing the \(\mathrm{BSSNOK}\) \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_bssn_bin"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_bssn_bin</strong></td><td></td><td></td><td><p>String storing the name for the binary file containing the \(\mathrm{BSSNOK}\) \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_parts"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_parts</strong></td><td></td><td></td><td><p>String storing the name for the formatted file containing the \(\mathrm{SPH}\)
 particle \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_parts_bin"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_parts_bin</strong></td><td></td><td></td><td><p>String storing the name for the binary file containing the \(\mathrm{SPH}\)
 particle \(\mathrm{ID}\)</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-namefile_sph"></span>character(len=500)</td>
  <td></td><td>::</td>
  <td><strong>namefile_sph</strong></td><td></td><td></td><td><p>String storing the name for ??</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-original_dx"></span>double precision</td>
  <td></td><td>::</td>
  <td><strong>original_dx</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-particles_dist"></span>type(<a href='../type/particles.html'>particles</a>)</td>
  <td></td><td>::</td>
  <td><strong>particles_dist</strong></td><td></td><td></td><td><p>Array storing the particles objects,
 containing the particle distributions for each idbase object.
 Multiple particle objects can contain different particle distributions
 for the same idbase object.</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-ratio_dx"></span>double precision</td>
  <td></td><td>::</td>
  <td><strong>ratio_dx</strong></td><td></td><td></td><td></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-systems"></span>character(len=:),</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>systems</strong></td><td></td><td></td><td><p>String storing the name of the phyical systems</p></td>
</tr>
<tr>
  <td><span class="anchor" id="variable-systems_name"></span>character(len=:),</td>
  <td>DIMENSION(:), ALLOCATABLE</td><td>::</td>
  <td><strong>systems_name</strong></td><td></td><td></td><td><p>String storing the name of the phyical systems</p></td>
</tr>
</tbody>
</table>

    </section>
    <br>
    
    
    

    


    <section>
    <h2>Subroutines</h2>
      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-cauchy_convergence_test_known"></span><h3>subroutine <a href='../proc/cauchy_convergence_test_known.html'>cauchy_convergence_test_known</a>(formul_dx, formul_dx2, use_constraints, ref_lev)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx2</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_constraints</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ref_lev</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

      <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-cauchy_convergence_test_unknown"></span><h3>subroutine <a href='../proc/cauchy_convergence_test_unknown.html'>cauchy_convergence_test_unknown</a>(formul_dx, formul_dx2, formul_dx4, use_constraints, ref_lev)</h3></div>
  <div class="panel-body">
           
<h4>Arguments</h4>      <table class="table table-striped varlist">
<thead><tr><th>Type</th><th>Intent</th><th>Optional</th><th>Attributes</th><th></th><th>Name</th><th></th></thead>
<tbody>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx2</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>class(<a href='../type/tpo.html'>tpo</a>),</td>
<td>intent(inout)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>formul_dx4</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>use_constraints</strong></td><td></td>
</tr>
<tr>
  <td><span class="anchor" ></span>integer,</td>
<td>intent(in)</td>
  <td></td>  <td></td><td>::</td>
  <td><strong>ref_lev</strong></td><td></td>
</tr>
</tbody>
</table>


  </div>
  </div>

    </section>    
    
    <section>
    <h2 id="src">Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">PROGRAM </span><span class="n">convergence_test</span>

  <span class="c">!*****************************************************</span>
  <span class="c">!</span>
  <span class="c">!# Make a convergence test to check the validity of</span>
  <span class="c">!  the code |sphincsid|.</span>
  <span class="c">!</span>
  <span class="c">!  FT 8.12.2020</span>
  <span class="c">!</span>
  <span class="c">!*****************************************************</span>

<span class="cp">#ifdef __INTEL_COMPILER</span>

  <span class="k">USE </span><span class="n">IFPORT</span><span class="p">,</span>          <span class="n">ONLY</span><span class="p">:</span> <span class="n">MAKEDIRQQ</span>

<span class="cp">#endif</span>

<span class="cp">#if flavour == 1</span>

  <span class="k">USE </span><span class="n">sphincs_id_full</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#elif flavour == 2</span>

  <span class="k">USE </span><span class="n">sphincs_id_lorene</span><span class="p">,</span>       <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#elif flavour == 3</span>

  <span class="k">USE </span><span class="n">sphincs_id_fuka</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#elif flavour == 4</span>

  <span class="k">USE </span><span class="n">sphincs_id_interpolate</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">allocate_idbase</span>

<span class="cp">#endif</span>

  <span class="k">USE </span><span class="n">id_base</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">idbase</span><span class="p">,</span> <span class="n">initialize</span>
  <span class="k">USE </span><span class="n">sph_particles</span><span class="p">,</span>            <span class="n">ONLY</span><span class="p">:</span> <span class="n">particles</span>
  <span class="k">USE </span><span class="n">bssn_formulation</span><span class="p">,</span>         <span class="n">ONLY</span><span class="p">:</span> <span class="n">bssn</span>
  <span class="k">USE </span><span class="n">standard_tpo_formulation</span><span class="p">,</span> <span class="n">ONLY</span><span class="p">:</span> <span class="n">tpo</span>
  <span class="k">USE </span><span class="n">timing</span><span class="p">,</span>                   <span class="n">ONLY</span><span class="p">:</span> <span class="n">timer</span>
  <span class="k">USE </span><span class="n">utility</span><span class="p">,</span>                  <span class="n">ONLY</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">itr3</span><span class="p">,</span> <span class="n">ios</span><span class="p">,</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">test_status</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">read_sphincs_id_parameters</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="c">!----------</span>
                                      <span class="n">n_id</span><span class="p">,</span> <span class="n">common_path</span><span class="p">,</span> <span class="n">filenames</span><span class="p">,</span> <span class="n">placer</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_bin</span><span class="p">,</span> <span class="n">export_form</span><span class="p">,</span> <span class="n">export_form_xy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_form_x</span><span class="p">,</span> <span class="n">export_constraints_xy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_constraints_x</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">compute_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">export_constraints_details</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">constraints_step</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">compute_parts_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">numerator_ratio_dx</span><span class="p">,</span> <span class="n">denominator_ratio_dx</span><span class="p">,&amp;</span>
                                      <span class="n">one_lapse</span><span class="p">,</span> <span class="n">zero_shift</span><span class="p">,</span> <span class="n">show_progress</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">run_sph</span><span class="p">,</span> <span class="n">run_spacetime</span><span class="p">,</span> <span class="n">sph_path</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">spacetime_path</span><span class="p">,</span> <span class="n">estimate_length_scale</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="n">test_int</span><span class="p">,</span> <span class="n">max_n_parts</span><span class="p">,</span> <span class="n">ref_lev</span>
  <span class="k">USE </span><span class="n">ISO_FORTRAN_ENV</span><span class="p">,</span>  <span class="n">ONLY</span><span class="p">:</span> <span class="n">COMPILER_VERSION</span><span class="p">,</span> <span class="n">COMPILER_OPTIONS</span>

  <span class="k">IMPLICIT NONE</span>

  <span class="c">! Loop limits for BSSN objects (for debugging; 3 is for production)</span>
  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">min_bssn</span><span class="o">=</span> <span class="mi">1</span>
  <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">max_bssn</span><span class="o">=</span> <span class="mi">3</span>

  <span class="c">! Grid spacing for the first BSSN object; the other two will have</span>
  <span class="c">! original_dx/2 and original_dx/4 as grid spacings</span>
  <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">original_dx</span>
  <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">ratio_dx</span>

  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="p">:</span> <span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">systems</span><span class="p">,</span> <span class="n">systems_name</span>
  <span class="c">!! String storing the name of the phyical systems</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_parts</span>
  <span class="c">!# String storing the name for the formatted file containing the |sph|</span>
  <span class="c">!  particle |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_parts_bin</span>
  <span class="c">!# String storing the name for the binary file containing the |sph|</span>
  <span class="c">!  particle |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_sph</span>
  <span class="c">!# String storing the name for ??</span>
  <span class="c">!</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_bssn</span>
  <span class="c">!# String storing the name for the formatted file containing the |bssn| |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">namefile_bssn_bin</span>
  <span class="c">!# String storing the name for the binary file containing the |bssn| |id|</span>
  <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span> <span class="mi">500</span> <span class="p">)</span><span class="kd">::</span> <span class="n">name_logfile</span>
  <span class="c">!# String storing the name for the formatted file containing a summary about</span>
  <span class="c">!  the |bssn| constraints violations</span>

  <span class="kt">LOGICAL</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">debug</span><span class="o">=</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span>
  <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">exist</span>
  <span class="kt">LOGICAL</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="kd">::</span> <span class="n">dir_out</span>

  <span class="k">CLASS</span><span class="p">(</span><span class="n">idbase</span><span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">idata</span>

  <span class="k">TYPE</span><span class="p">(</span><span class="n">particles</span><span class="p">)</span><span class="kd">::</span> <span class="n">particles_dist</span>
  <span class="c">!# Array storing the particles objects,</span>
  <span class="c">!  containing the particle distributions for each idbase object.</span>
  <span class="c">!  Multiple particle objects can contain different particle distributions</span>
  <span class="c">!  for the same idbase object.</span>

  <span class="k">TYPE</span><span class="p">(</span><span class="n">bssn</span><span class="p">),</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">bssn_forms</span>
  <span class="c">!# Array storing the bssn objects,</span>
  <span class="c">!  containing the BSSN variables on the gravity grid for each idbase object</span>

  <span class="k">TYPE</span><span class="p">(</span><span class="n">timer</span><span class="p">)</span><span class="kd">::</span> <span class="n">execution_timer</span>

  <span class="c">!---------------------------!</span>
  <span class="c">!--  End of declarations  --!</span>
  <span class="c">!---------------------------!</span>

  <span class="c">! Conversions of some polytropic constants from formatted units to</span>
  <span class="c">! SPHINCS units, and vice versa</span>
  <span class="c">!gamma= 2</span>
  <span class="c">!PRINT *, 0.0332278*k_lorene2hydrobase( gamma )</span>
  <span class="c">!PRINT *</span>
  <span class="c">!gamma= 2.75</span>
  <span class="c">!PRINT *, 30000.0D0/k_lorene2hydrobase( gamma )</span>
  <span class="c">!gamma= 2.75</span>
  <span class="c">!PRINT *, 0.0332278*k_lorene2hydrobase( gamma )</span>
  <span class="c">!STOP</span>

  <span class="k">CALL </span><span class="nb">DATE_AND_TIME</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">values</span> <span class="p">)</span>
  <span class="n">run_id</span><span class="o">=</span> <span class="n">date</span> <span class="o">//</span> <span class="s2">&quot;-&quot;</span> <span class="o">//</span> <span class="nb">time</span>

<span class="nb">  </span><span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  ________________________________________________________________ &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;             ____________  ________  __________    __ ___          &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;            / ___/ _  / /_/ / / __ \/ ___/ ___/   / / __ \         &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;           (__  ) ___/ __  / / / / / /__(__  )___/ / /_/ /         &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;          /____/_/  /_/ /_/_/_/ /_/____/____/___/_/_____/          &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  Smoothed Particle Hydrodynamics IN Curved Spacetime              &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  Initial Data builder, v1.0 - Cauchy convergence test             &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  SPHINCS_ID  Copyright (C) 2020, 2021, 2022  Francesco Torsello   &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  SPHINCS_ID is free software: you can redistribute it and/or      &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  modify it under the terms of the GNU General Public License      &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  as published by the Free Software Foundation, either version     &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  of the License, or (at your option) any later version.           &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  SPHINCS_ID is distributed in the hope that it will be useful,    &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  but WITHOUT ANY WARRANTY; without even the implied warranty of   &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  General Public License for more details.                         &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  You should have received a copy of the GNU General Public License&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  along with SPHINCS_ID. If not, see https://www.gnu.org/licenses/.&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  The copy of the GNU General Public License should be in the file &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  &#39;COPYING&#39;.                                                       &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  ________________________________________________________________ &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  SPHINCS_ID was compiled with: &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">COMPILER_VERSION</span><span class="p">()</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  using the options: &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">COMPILER_OPTIONS</span><span class="p">()</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  ________________________________________________________________ &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  Run id: &quot;</span><span class="p">,</span> <span class="n">run_id</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;  ________________________________________________________________ &quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>

  <span class="n">execution_timer</span><span class="o">=</span> <span class="n">timer</span><span class="p">(</span> <span class="s2">&quot;execution_timer&quot;</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">execution_timer</span><span class="p">%</span> <span class="n">start_timer</span><span class="p">()</span>

  <span class="k">CALL </span><span class="n">read_sphincs_id_parameters</span><span class="p">()</span>

  <span class="n">ratio_dx</span><span class="o">=</span> <span class="n">numerator_ratio_dx</span><span class="o">/</span><span class="n">denominator_ratio_dx</span>

  <span class="c">! Check that ratio_dx &gt; 1</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">ratio_dx</span> <span class="o">&lt;=</span> <span class="mf">1.0D0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! numerator_ratio_dx has to be larger than &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;denominator_ratio_dx. The current values are &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">numerator_ratio_dx</span><span class="p">,</span> <span class="s2">&quot; and &quot;</span><span class="p">,</span> <span class="n">denominator_ratio_dx</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;, respectively.&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

<span class="cp">#ifdef __INTEL_COMPILER</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="n">DIRECTORY</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="n">MAKEDIRQQ</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">ELSE</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
  <span class="n">ENDIF</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">dir_out</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Failed to create subdirectory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Stopping...&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="n">DIRECTORY</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="n">MAKEDIRQQ</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">ELSE</span>
<span class="k">    </span><span class="n">dir_out</span><span class="o">=</span> <span class="p">.</span><span class="n">TRUE</span><span class="p">.</span>
  <span class="n">ENDIF</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">dir_out</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Failed to create subdirectory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;Stopping...&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

<span class="cp">#endif</span>

<span class="cp">#ifdef __GFORTRAN__</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/.&quot;</span><span class="p">,</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Directory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">sph_path</span><span class="p">),</span> <span class="s2">&quot; does not exist!&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;   Please create it and re-run the executable. Stopping...&quot;</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

  <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;/.&quot;</span><span class="p">,</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>
  <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="nb">NOT</span><span class="p">.</span><span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** ERROR! Directory &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">),</span> <span class="s2">&quot; does not exist!&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;   Please create it and re-run the executable. Stopping...&quot;</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

<span class="cp">#endif</span>

  <span class="k">ALLOCATE</span><span class="p">(</span> <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="kd">::</span> <span class="n">systems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">ALLOCATE</span><span class="p">(</span> <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="kd">::</span> <span class="n">systems_name</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>

  <span class="c">!</span>
  <span class="c">!-- Construct the idbase objects</span>
  <span class="c">!</span>
  <span class="k">CALL </span><span class="n">allocate_idbase</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">filenames</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">systems</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">systems_name</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Constructing idbase object for &quot;</span><span class="o">//</span><span class="n">systems</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">initialize</span><span class="p">(</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">common_path</span><span class="p">)</span><span class="o">//</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">filenames</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span>
  <span class="c">! Set the variables to decide on using the geodesic gauge or not</span>
  <span class="c">! (lapse=1, shift=0)</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">set_one_lapse</span> <span class="p">(</span> <span class="n">one_lapse</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">set_zero_shift</span><span class="p">(</span> <span class="n">zero_shift</span> <span class="p">)</span>


  <span class="c">!</span>
  <span class="c">!-- Construct the bssn objects from the bns object</span>
  <span class="c">!</span>
  <span class="n">construct_bssn_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Setting up BSSN object &quot;</span><span class="p">,</span> <span class="n">itr3</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">      </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)</span><span class="o">=</span> <span class="n">bssn</span><span class="p">(</span> <span class="n">idata</span> <span class="p">)</span>
      <span class="n">original_dx</span><span class="o">=</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

    <span class="k">ELSE</span>
<span class="k">      IF</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">==</span> <span class="n">min_bssn</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">        </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)</span><span class="o">=</span> <span class="n">bssn</span><span class="p">(</span> <span class="n">idata</span> <span class="p">)</span>
        <span class="n">original_dx</span><span class="o">=</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

      <span class="n">ENDIF</span>
      <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)</span><span class="o">=</span> <span class="n">bssn</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">),</span> <span class="p">&amp;</span>
                                   <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">),</span> <span class="p">&amp;</span>
                                   <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
          <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; ** ERROR! The grid spacing #&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot; is not equal to dx/&quot;</span><span class="p">,</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">),</span> <span class="s2">&quot;= &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                 <span class="n">original_dx</span><span class="o">/</span><span class="p">(</span> <span class="n">ratio_dx</span><span class="o">**</span><span class="p">(</span> <span class="n">itr3</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
    <span class="n">ENDIF</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** The grid spacing is dx=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** The number of grid points for dx is:&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                            <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">),</span> <span class="s2">&quot;**3&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>

  <span class="n">ENDDO</span> <span class="n">construct_bssn_loop</span>

  <span class="k">IF</span><span class="p">(</span> <span class="n">debug</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 1 )% get_dx &quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 2 )% get_dy &quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;bssn_forms( 3 )% get_dz &quot;</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="c">!STOP</span>
  <span class="n">ENDIF</span>

  <span class="c">!</span>
  <span class="c">!-- Compute the BSSN variables</span>
  <span class="c">!</span>
  <span class="n">compute_export_bssn_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing BSSN variables for BSSN formulation&quot;</span><span class="p">,</span> <span class="n">itr3</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn_bin</span><span class="p">,</span> <span class="s2">&quot;(A6,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;BSSN_l&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.bin&quot;</span>
    <span class="n">namefile_bssn_bin</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn_bin</span> <span class="p">)</span>

    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_bin</span><span class="o">=</span> <span class="n">export_bin</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_form_xy</span><span class="o">=</span> <span class="n">export_form_xy</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_form_x</span> <span class="o">=</span> <span class="n">export_form_x</span>
    <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                        <span class="n">compute_and_export_tpo_variables</span><span class="p">(</span> <span class="n">namefile_bssn_bin</span> <span class="p">)</span>
  <span class="n">ENDDO</span> <span class="n">compute_export_bssn_loop</span>

  <span class="c">!</span>
  <span class="c">!-- Print the BSSN initial data to a formatted file</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">export_form</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    </span><span class="n">export_bssn_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn</span><span class="p">,</span> <span class="s2">&quot;(A24,I1,A4)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                            <span class="s2">&quot;lorene-bns-id-bssn-form_&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="n">namefile_bssn</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>

      <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                  <span class="n">print_formatted_id_tpo_variables</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>
    <span class="n">ENDDO</span> <span class="n">export_bssn_loop</span>
  <span class="n">ENDIF</span>


  <span class="c">!</span>
  <span class="c">!-- Construct the particles object from the bns object</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">compute_parts_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Placing particles&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="n">particles_dist</span><span class="o">=</span> <span class="n">particles</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="n">placer</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="p">)</span> <span class="p">)</span>

    <span class="c">!</span>
    <span class="c">!-- Compute the SPH variables</span>
    <span class="c">!</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;=====================&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing SPH variables &quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
             <span class="o">//</span> <span class="s2">&quot;=====================&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_parts</span><span class="p">,</span> <span class="s2">&quot;(A1,I1,A1,I1,A1)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                                <span class="s2">&quot;l&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span>
    <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_parts_bin</span><span class="p">,</span> <span class="s2">&quot;(A5)&quot;</span> <span class="p">)</span> <span class="n">systems_name</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">namefile_parts_bin</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">sph_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_parts_bin</span> <span class="p">)</span>

    <span class="n">particles_dist</span><span class="p">%</span> <span class="n">export_bin</span>    <span class="o">=</span> <span class="n">export_bin</span>
    <span class="n">particles_dist</span><span class="p">%</span> <span class="n">export_form_xy</span><span class="o">=</span> <span class="n">export_form_xy</span>
    <span class="n">particles_dist</span><span class="p">%</span> <span class="n">export_form_x</span> <span class="o">=</span> <span class="n">export_form_x</span>
    <span class="k">CALL </span><span class="n">particles_dist</span><span class="p">%</span> <span class="n">compute_and_print_sph_variables</span><span class="p">(</span> <span class="n">namefile_parts</span> <span class="p">)</span>

    <span class="c">!</span>
    <span class="c">!-- Print the particle initial data to a formatted file</span>
    <span class="c">!</span>
    <span class="k">IF</span><span class="p">(</span> <span class="n">export_form</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">      WRITE</span><span class="p">(</span> <span class="n">namefile_parts</span><span class="p">,</span> <span class="s2">&quot;(A34)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                             <span class="s2">&quot;lorene-bns-id-particles-form_1.dat&quot;</span>
      <span class="n">namefile_parts</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">sph_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_parts</span> <span class="p">)</span>
      <span class="k">CALL </span><span class="n">particles_dist</span><span class="p">%</span> <span class="n">print_formatted_id_particles</span><span class="p">(</span> <span class="n">namefile_parts</span> <span class="p">)</span>
    <span class="n">ENDIF</span>

  <span class="n">ENDIF</span>


  <span class="c">!</span>
  <span class="c">!-- Compute the BSSN constraints</span>
  <span class="c">!</span>
  <span class="n">compute_export_bssn_constraints_loop</span><span class="p">:</span> <span class="k">DO </span><span class="n">itr3</span> <span class="o">=</span> <span class="n">min_bssn</span><span class="p">,</span> <span class="n">max_bssn</span><span class="p">,</span> <span class="mi">1</span>

    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">cons_step</span><span class="o">=</span> <span class="n">constraints_step</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints</span><span class="o">=</span> <span class="n">export_constraints</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints_details</span><span class="o">=</span> <span class="p">&amp;</span>
                        <span class="n">export_constraints_details</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints_xy</span><span class="o">=</span> <span class="n">export_constraints_xy</span>
    <span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="n">export_constraints_x</span> <span class="o">=</span> <span class="n">export_constraints_x</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">compute_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing BSSN constraints for BSSN formulation&quot;</span><span class="p">,</span> <span class="n">itr3</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn</span><span class="p">,</span> <span class="s2">&quot;(A17,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;bssn-constraints-&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">name_logfile</span><span class="p">,</span> <span class="s2">&quot;(A28,I1,A4)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                          <span class="s2">&quot;bssn-constraints-statistics-&quot;</span><span class="p">,</span> <span class="n">itr3</span>

      <span class="n">namefile_bssn</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>
      <span class="n">name_logfile</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">name_logfile</span> <span class="p">)</span>

      <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                  <span class="n">compute_and_export_tpo_constraints</span><span class="p">(</span> <span class="n">idata</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">namefile_bssn</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">name_logfile</span> <span class="p">)</span>

    <span class="n">ENDIF</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">compute_parts_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Computing BSSN constraints with particle data for BSSN&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
               <span class="s2">&quot; formulation&quot;</span><span class="p">,</span> <span class="n">itr3</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;===============&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_bssn</span><span class="p">,</span> <span class="s2">&quot;(A23,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;bssn-constraints-parts-&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                           <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">namefile_sph</span><span class="p">,</span> <span class="s2">&quot;(A12,I1,A4)&quot;</span> <span class="p">)</span> <span class="s2">&quot;sph-density-&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.dat&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">name_logfile</span><span class="p">,</span> <span class="s2">&quot;(A34,I1,A4)&quot;</span> <span class="p">)</span> <span class="p">&amp;</span>
                           <span class="s2">&quot;bssn-constraints-parts-statistics-&quot;</span><span class="p">,</span> <span class="n">itr3</span><span class="p">,</span> <span class="s2">&quot;.log&quot;</span>

      <span class="n">namefile_bssn</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_bssn</span> <span class="p">)</span>
      <span class="n">namefile_sph</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">sph_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">namefile_sph</span> <span class="p">)</span>
      <span class="n">name_logfile</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">spacetime_path</span> <span class="p">)</span> <span class="o">//</span> <span class="nb">TRIM</span><span class="p">(</span> <span class="n">name_logfile</span> <span class="p">)</span>

      <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="n">itr3</span> <span class="p">)%</span> <span class="p">&amp;</span>
                  <span class="n">compute_and_export_tpo_constraints</span><span class="p">(</span> <span class="n">particles_dist</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">namefile_bssn</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="n">name_logfile</span> <span class="p">)</span>

    <span class="n">ENDIF</span>

  <span class="n">ENDDO</span> <span class="n">compute_export_bssn_constraints_loop</span>

<span class="c">! Here the bug appears. Since I am only computing the constraints with particles</span>
<span class="c">! it must be in there</span>
<span class="c">!STOP</span>

  <span class="c">!</span>
  <span class="c">!-- The BSSN formulations on grids with different resolutions are ready</span>
  <span class="c">!-- to be used in a convergence test</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">debug</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">30</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span>   <span class="mi">1</span> <span class="o">+</span> <span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">17</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span>
    <span class="k">STOP</span>
<span class="k">  </span><span class="n">ENDIF</span>

  <span class="c">!</span>
  <span class="c">!-- Perform the convergence test with the appropriate constraints</span>
  <span class="c">!</span>
  <span class="k">IF</span><span class="p">(</span> <span class="n">compute_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Performing convergence test with constraints computed &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;without particle data.&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_unknown</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                                          <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_known</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

  <span class="n">ENDIF</span>

  <span class="k">IF</span><span class="p">(</span> <span class="n">compute_parts_constraints</span> <span class="p">)</span><span class="k">THEN</span>

<span class="k">    PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Performing convergence test with constraints computed &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="s2">&quot;with particle data.&quot;</span>
    <span class="k">PRINT</span> <span class="o">*</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_unknown</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                                          <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
    <span class="k">CALL </span><span class="n">cauchy_convergence_test_known</span><span class="p">(</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">bssn_forms</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

  <span class="n">ENDIF</span>

  <span class="k">CALL </span><span class="n">execution_timer</span><span class="p">%</span> <span class="n">stop_timer</span><span class="p">()</span>

  <span class="k">CALL </span><span class="nb">DATE_AND_TIME</span><span class="p">(</span> <span class="n">date</span><span class="p">,</span> <span class="nb">time</span><span class="p">,</span> <span class="n">zone</span><span class="p">,</span> <span class="n">values</span> <span class="p">)</span>
  <span class="n">end_time</span><span class="o">=</span> <span class="n">date</span> <span class="o">//</span> <span class="s2">&quot;-&quot;</span> <span class="o">//</span> <span class="nb">time</span>

<span class="c">!STOP</span>

  <span class="c">!</span>
  <span class="c">!-- Print the timers</span>
  <span class="c">!</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;================================================&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; Timing and summaries&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;===================================================&quot;</span> <span class="p">&amp;</span>
           <span class="o">//</span> <span class="s2">&quot;================================================&quot;</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">CALL </span><span class="n">idata</span><span class="p">%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="c">!PRINT *, &quot; * BSSN formulation with uniform resolution:&quot;, &amp;</span>
  <span class="c">!         bssn_forms( 1 )% get_dx(ref_lev)</span>
  <span class="c">!PRINT *, &quot;    and number of points:&quot;, bssn_forms( 1 )% get_ngrid_x(ref_lev), &amp;</span>
  <span class="c">!         &quot;**3&quot;</span>
  <span class="c">!original_dx</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">grid_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">importer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">1</span> <span class="p">)%</span> <span class="n">bssn_computer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="c">!PRINT *, &quot; * BSSN formulation with uniform resolution:&quot;, &amp;</span>
  <span class="c">!         bssn_forms( 2 )% get_dx(ref_lev)</span>
  <span class="c">!PRINT *, &quot;    and number of points:&quot;, bssn_forms( 2 )% get_ngrid_x(ref_lev), &amp;</span>
  <span class="c">!         &quot;**3&quot;</span>
  <span class="c">!original_dx/2</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">grid_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">importer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)%</span> <span class="n">bssn_computer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="c">!PRINT *, &quot; * BSSN formulation with uniform resolution:&quot;, &amp;</span>
  <span class="c">!         bssn_forms( 3 )% get_dx(ref_lev)</span>
  <span class="c">!PRINT *, &quot;    and number of points:&quot;, bssn_forms( 3 )% get_ngrid_x(ref_lev), &amp;</span>
  <span class="c">!         &quot;**3&quot;</span>
  <span class="c">!original_dx/4</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">print_summary</span><span class="p">()</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">grid_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">importer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">CALL </span><span class="n">bssn_forms</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)%</span> <span class="n">bssn_computer_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Total:&quot;</span>
  <span class="k">CALL </span><span class="n">execution_timer</span><span class="p">%</span> <span class="n">print_timer</span><span class="p">(</span> <span class="mi">2</span> <span class="p">)</span>
  <span class="k">PRINT</span> <span class="o">*</span>

  <span class="k">PRINT</span> <span class="o">*</span>
  <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Run started on &quot;</span><span class="p">,</span> <span class="n">run_id</span><span class="p">,</span> <span class="s2">&quot; and ended on &quot;</span><span class="p">,</span> <span class="n">end_time</span>
  <span class="k">PRINT</span> <span class="o">*</span>

  <span class="c">!</span>
  <span class="c">!-- Destruct the formatted Bin_NS object by hand, since the pointer to it is</span>
  <span class="c">!-- global (because it is bound to C++) and cannot be nullified by the</span>
  <span class="c">!-- destructor of bns. In case of multiple bns objects, this would lead</span>
  <span class="c">!-- to problems...</span>
  <span class="c">!-- TODO: fix this</span>
  <span class="c">!</span>
  <span class="c">!CALL binary% destruct_binary()</span>


  <span class="k">CONTAINS</span>


<span class="k">  SUBROUTINE </span><span class="n">cauchy_convergence_test_known</span><span class="p">(</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">,</span> <span class="p">&amp;</span>
                                            <span class="n">use_constraints</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

    <span class="k">IMPLICIT NONE</span>

<span class="k">    CLASS</span><span class="p">(</span><span class="n">tpo</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="n">OUT</span> <span class="p">)</span><span class="kd">::</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span>
    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span><span class="kd">::</span> <span class="n">use_constraints</span><span class="p">,</span> <span class="n">ref_lev</span>

    <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span>

    <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">min_abs_y</span><span class="p">,</span> <span class="n">min_abs_z</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">abs_grid</span>

    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">tiny_real</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">30</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">grid_dx</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">point_dx2</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">convergence_factor</span>

    <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span><span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">name_cauchy_ct</span><span class="p">,</span> <span class="n">name_cauchy_parts_ct</span>

    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">exist</span>

    <span class="n">nx</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">ny</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">nz</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">ny</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">nz</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Computing convergence factor...&quot;</span>

    <span class="n">choose_constraints</span><span class="p">:</span> <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">use_constraints</span> <span class="p">)</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">shared_grid_loops1</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

            <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                        <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
                        <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                    <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

           <span class="p">)</span><span class="k">THEN</span>

<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span>
              <span class="k">STOP</span>

<span class="k">            </span><span class="n">ENDIF</span>

            <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
             <span class="nb">LOG</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="p">(</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))&amp;</span>
            <span class="o">/</span><span class="p">(</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span><span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops1</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_ct</span><span class="o">=</span> <span class="mi">3109</span>
      <span class="n">name_cauchy_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span><span class="o">//</span><span class="s2">&quot;cauchy_convergence_test_known.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing he arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

      <span class="n">shared_grid_loops2</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

            <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                        <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
                        <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                      <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

           <span class="p">)</span><span class="k">THEN</span>

<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span>
              <span class="k">STOP</span>

<span class="k">            </span><span class="n">ENDIF</span>

            <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
             <span class="nb">LOG</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
               <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC_parts</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)&amp;</span>
            <span class="o">/</span><span class="p">(</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                         <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>  <span class="p">&amp;</span>
             <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops2</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_parts_ct</span><span class="o">=</span> <span class="mi">3111</span>
      <span class="n">name_cauchy_parts_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">&amp;</span>
                            <span class="o">//</span> <span class="s2">&quot;cauchy_convergence_test_known_parts.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_parts_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing e arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_parts_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE </span><span class="n">DEFAULT</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** There is no well defined algorithm &quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;corresponding to the number&quot;</span><span class="p">,</span> <span class="n">use_constraints</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Please set use_constraints to 1 or 2.&quot;</span>
      <span class="k">STOP</span>

<span class="k">    END SELECT </span><span class="n">choose_constraints</span>

    <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span> <span class="p">)</span>

  <span class="k">END SUBROUTINE </span><span class="n">cauchy_convergence_test_known</span>


  <span class="k">SUBROUTINE </span><span class="n">cauchy_convergence_test_unknown</span><span class="p">(</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">,</span> <span class="p">&amp;</span>
                                              <span class="n">formul_dx4</span><span class="p">,</span> <span class="n">use_constraints</span><span class="p">,</span> <span class="p">&amp;</span>
                                              <span class="n">ref_lev</span> <span class="p">)</span>

    <span class="k">IMPLICIT NONE</span>

<span class="k">    CLASS</span><span class="p">(</span><span class="n">tpo</span><span class="p">),</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="n">OUT</span> <span class="p">)</span><span class="kd">::</span> <span class="n">formul_dx</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">,</span> <span class="n">formul_dx4</span>
    <span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span> <span class="n">IN</span> <span class="p">)</span><span class="kd">::</span> <span class="n">use_constraints</span><span class="p">,</span> <span class="n">ref_lev</span>

    <span class="kt">INTEGER</span><span class="kd">::</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span>

    <span class="kt">DOUBLE PRECISION</span><span class="kd">::</span> <span class="n">min_abs_y</span><span class="p">,</span> <span class="n">min_abs_z</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">abs_grid</span>

    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">PARAMETER</span><span class="kd">::</span> <span class="n">tiny_real</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">30</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">grid_dx</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">point_dx2</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="kd">::</span> <span class="n">point_dx4</span>
    <span class="kt">DOUBLE PRECISION</span><span class="p">,</span> <span class="k">DIMENSION</span><span class="p">(:,:,:),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">convergence_factor</span>

    <span class="kt">CHARACTER</span><span class="p">(</span> <span class="nb">LEN</span><span class="o">=</span><span class="p">:</span> <span class="p">),</span> <span class="k">ALLOCATABLE</span><span class="kd">::</span> <span class="n">name_cauchy_ct</span><span class="p">,</span> <span class="n">name_cauchy_parts_ct</span>

    <span class="kt">LOGICAL</span><span class="kd">::</span> <span class="n">exist</span>

    <span class="n">nx</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">ny</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
    <span class="n">nz</span><span class="o">=</span> <span class="n">formul_dx</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>

    <span class="n">nx</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">ny</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">nz</span><span class="o">=</span> <span class="nb">FLOOR</span><span class="p">(</span> <span class="nb">DBLE</span><span class="p">(</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span> <span class="p">)</span><span class="o">/</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>
    <span class="k">ALLOCATE</span><span class="p">(</span> <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">nz</span> <span class="p">)</span> <span class="p">)</span>

    <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** Computing convergence factor...&quot;</span>

    <span class="k">IF</span><span class="p">(</span> <span class="n">debug</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_ngrid_x=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_ngrid_x</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_ngrid_y=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_ngrid_y</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_ngrid_z=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_ngrid_z</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx%  get_dx=&quot;</span><span class="p">,</span> <span class="n">formul_dx</span> <span class="p">%</span>  <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx2% get_dy=&quot;</span><span class="p">,</span> <span class="n">formul_dx2</span><span class="p">%</span>  <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;formul_dx4% get_dz=&quot;</span><span class="p">,</span> <span class="n">formul_dx4</span><span class="p">%</span>  <span class="n">get_dx</span><span class="p">(</span><span class="n">ref_lev</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>
      <span class="c">!STOP</span>
    <span class="n">ENDIF</span>

    <span class="n">choose_constraints</span><span class="p">:</span> <span class="k">SELECT CASE</span><span class="p">(</span> <span class="n">use_constraints</span> <span class="p">)</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">shared_grid_loops3</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

           <span class="c">! grid_dx( :, 1 + ix, 1 + iy, 1 + iz ) = &amp;</span>
           <span class="c">!            formul_dx%  get_grid_point(  &amp;</span>
           <span class="c">!                             1 + ix,   1 + iy,   1 + iz   )</span>
           <span class="c">! point_dx2= formul_dx2% get_grid_point( &amp;</span>
           <span class="c">!                             1 + 2*ix, 1 + 2*iy, 1 + 2*iz )</span>
           <span class="c">! point_dx4= formul_dx4% get_grid_point( &amp;</span>
           <span class="c">!                             1 + 4*ix, 1 + 4*iy, 1 + 4*iz )</span>
           <span class="c">!</span>
           <span class="c">! IF( grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(1) &amp;</span>
           <span class="c">!.OR. grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(1) &amp;</span>
           <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(2) &amp;</span>
           <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(2) &amp;</span>
           <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(3) &amp;</span>
           <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(3) &amp;</span>

            <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                       <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
            <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
            <span class="n">point_dx4</span><span class="o">=</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

            <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
          <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

           <span class="p">)</span><span class="k">THEN</span>

<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
              <span class="k">PRINT</span> <span class="o">*</span>
              <span class="k">STOP</span>

<span class="k">            </span><span class="n">ENDIF</span>

            <span class="c">!convergence_factor( 1 + ix, 1 + iy, 1 + iz )= &amp;</span>
            <span class="c">! LOG( &amp;</span>
            <span class="c">! ABS( &amp;</span>
            <span class="c">! ( ABS(formul_dx%  get_HC( 1 + ix,   1 + iy,   1 + iz )) &amp;</span>
            <span class="c">! - ABS(formul_dx2% get_HC( 1 + 2*ix, 1 + 2*iy, 1 + 2*iz )))&amp;</span>
            <span class="c">!/( ABS(formul_dx2% get_HC( 1 + 2*ix, 1 + 2*iy, 1 + 2*iz )) &amp;</span>
            <span class="c">! - ABS(formul_dx4% get_HC( 1 + 4*ix, 1 + 4*iy, 1 + 4*iz ) )&amp;</span>
            <span class="c">! + 0*tiny_real ) &amp;</span>
            <span class="c">! ) &amp;</span>
            <span class="c">! )/ln2!/LOG(2.0)</span>

            <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
             <span class="nb">LOG</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
             <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
             <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                           <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)))</span> <span class="p">&amp;</span>
            <span class="o">/</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                   <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                       <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
             <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_HC</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                               <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
             <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span><span class="p">&amp;</span>
             <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops3</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_ct</span><span class="o">=</span> <span class="mi">3108</span>
      <span class="n">name_cauchy_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">&amp;</span>
                      <span class="o">//</span><span class="s2">&quot;cauchy_convergence_test_unknown.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing the arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                      <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

      <span class="n">shared_grid_loops4</span><span class="p">:</span> <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nz</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ny</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>

         <span class="c">! grid_dx( :, 1 + ix, 1 + iy, 1 + iz ) = &amp;</span>
         <span class="c">!            formul_dx%  get_grid_point(  &amp;</span>
         <span class="c">!                             1 + ix,   1 + iy,   1 + iz   )</span>
         <span class="c">! point_dx2= formul_dx2% get_grid_point( &amp;</span>
         <span class="c">!                             1 + 2*ix, 1 + 2*iy, 1 + 2*iz )</span>
         <span class="c">! point_dx4= formul_dx4% get_grid_point( &amp;</span>
         <span class="c">!                             1 + 4*ix, 1 + 4*iy, 1 + 4*iz )</span>
         <span class="c">!</span>
         <span class="c">! IF( grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(1) &amp;</span>
         <span class="c">!.OR. grid_dx( 1, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(1) &amp;</span>
         <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(2) &amp;</span>
         <span class="c">!.OR. grid_dx( 2, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(2) &amp;</span>
         <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx2(3) &amp;</span>
         <span class="c">!.OR. grid_dx( 3, 1 + ix, 1 + iy, 1 + iz ) /= point_dx4(3) &amp;</span>

          <span class="n">grid_dx</span><span class="p">(</span> <span class="p">:,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">=</span> <span class="p">&amp;</span>
                     <span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_grid_point</span><span class="p">(</span>  <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
          <span class="n">point_dx2</span><span class="o">=</span> <span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                    <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>
          <span class="n">point_dx4</span><span class="o">=</span> <span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_grid_point</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span>

          <span class="k">IF</span><span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>
        <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">-</span><span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="n">D</span><span class="o">-</span><span class="mi">10</span> <span class="p">&amp;</span>

         <span class="p">)</span><span class="k">THEN</span>

<span class="k">            PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;**ERROR! The grid functions in the Cauchy &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;convergence test are not evaluated at the &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="s2">&quot;same grid point at (ix,iy,iz)=(&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                     <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span><span class="p">,</span> <span class="s2">&quot;).&quot;</span>
            <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">point_dx4</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">point_dx4</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">),</span> <span class="n">point_dx2</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">point_dx4</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">PRINT</span> <span class="o">*</span>
            <span class="k">STOP</span>

<span class="k">          </span><span class="n">ENDIF</span>

          <span class="n">convergence_factor</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">ix</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iy</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="p">&amp;</span>
           <span class="nb">LOG</span><span class="p">(</span> <span class="p">&amp;</span>
           <span class="nb">ABS</span><span class="p">(</span> <span class="p">&amp;</span>
           <span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx</span><span class="p">%</span>  <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">denominator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)))&amp;</span>
          <span class="o">/</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx2</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">*</span> <span class="p">&amp;</span>
                                        <span class="n">denominator_ratio_dx</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">))</span> <span class="p">&amp;</span>
           <span class="o">-</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">formul_dx4</span><span class="p">%</span> <span class="n">get_HC_parts</span><span class="p">(</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ix</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iy</span><span class="p">,</span> <span class="p">&amp;</span>
                                <span class="mi">1</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">(</span><span class="n">numerator_ratio_dx</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">iz</span><span class="p">,</span> <span class="n">ref_lev</span> <span class="p">)</span> <span class="p">)&amp;</span>
           <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">)</span> <span class="p">&amp;</span>
           <span class="p">)</span> <span class="o">+</span> <span class="n">tiny_real</span> <span class="p">&amp;</span>
           <span class="p">)</span><span class="o">/</span><span class="nb">LOG</span><span class="p">(</span><span class="n">ratio_dx</span><span class="p">)</span>

          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span> <span class="n">shared_grid_loops4</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor computed.&quot;</span>
      <span class="k">PRINT</span> <span class="o">*</span>

      <span class="n">unit_cauchy_parts_ct</span><span class="o">=</span> <span class="mi">3110</span>
      <span class="n">name_cauchy_parts_ct</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">spacetime_path</span><span class="p">)</span> <span class="p">&amp;</span>
                            <span class="o">//</span><span class="s2">&quot;cauchy_convergence_test_unknown_parts.dat&quot;</span>

      <span class="k">INQUIRE</span><span class="p">(</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span> <span class="n">exist</span> <span class="p">)</span>

      <span class="k">IF</span><span class="p">(</span> <span class="n">exist</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;REPLACE&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">POSITION</span><span class="o">=</span> <span class="s2">&quot;REWIND&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        OPEN</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="k">FILE</span><span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
              <span class="n">STATUS</span><span class="o">=</span> <span class="s2">&quot;NEW&quot;</span><span class="p">,</span> <span class="n">FORM</span><span class="o">=</span> <span class="s2">&quot;FORMATTED&quot;</span><span class="p">,</span> <span class="p">&amp;</span>
              <span class="n">ACTION</span><span class="o">=</span> <span class="s2">&quot;WRITE&quot;</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span><span class="o">=</span> <span class="n">err_msg</span> <span class="p">)</span>
      <span class="n">ENDIF</span>
      <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">        PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when opening &quot;</span><span class="p">,</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                 <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
        <span class="k">STOP</span>
<span class="k">      </span><span class="n">ENDIF</span>
      <span class="c">!CALL test_status( ios, err_msg, &quot;...error when opening &quot; &amp;</span>
      <span class="c">!         // TRIM(name_cauchy_parts_ct) )</span>

      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Run ID [ccyymmdd-hhmmss.sss]: &quot;</span> <span class="o">//</span> <span class="n">run_id</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# Cauchy convergence test. &quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;# column:      1        2       3       4&quot;</span>
      <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="p">&amp;</span>
             <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)</span> <span class="p">&amp;</span>
      <span class="s2">&quot;#      x [km]       y [km]       z [km]       &quot;</span> <span class="p">&amp;</span>
      <span class="o">//</span><span class="s2">&quot;convergence factor [pure number]&quot;</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">abs_grid</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="n">min_abs_y</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="n">min_abs_z</span><span class="o">=</span> <span class="mi">1</span><span class="n">D</span><span class="o">+</span><span class="mi">20</span>
      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_y</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_y</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_y</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_y</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_y</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_abs_z</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              </span><span class="n">min_abs_z</span><span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="p">)</span>
              <span class="n">min_ix_z</span><span class="o">=</span> <span class="n">ix</span>
              <span class="n">min_iy_z</span><span class="o">=</span> <span class="n">iy</span>
              <span class="n">min_iz_z</span><span class="o">=</span> <span class="n">iz</span>
            <span class="n">ENDIF</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">DO </span><span class="n">iz</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nz</span><span class="p">,</span> <span class="mi">1</span>
        <span class="k">DO </span><span class="n">iy</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="mi">1</span>
          <span class="k">DO </span><span class="n">ix</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="mi">1</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_xy</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">IF</span><span class="p">(</span> <span class="p">.</span><span class="n">FALSE</span><span class="p">.</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">export_constraints_x</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="p">&amp;</span>
                <span class="p">(</span> <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">min_ix_z</span><span class="p">,</span> <span class="n">min_iy_z</span><span class="p">,</span> <span class="n">min_iz_z</span> <span class="p">)</span> <span class="p">&amp;</span>
                  <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span> <span class="o">/=</span> <span class="p">&amp;</span>
                  <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">min_ix_y</span><span class="p">,</span> <span class="n">min_iy_y</span><span class="p">,</span> <span class="n">min_iz_y</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              CYCLE</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="k">WRITE</span><span class="p">(</span> <span class="n">UNIT</span> <span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span><span class="p">,</span> <span class="n">IOSTAT</span> <span class="o">=</span> <span class="n">ios</span><span class="p">,</span> <span class="p">&amp;</span>
                   <span class="n">IOMSG</span> <span class="o">=</span> <span class="n">err_msg</span><span class="p">,</span> <span class="n">FMT</span> <span class="o">=</span> <span class="o">*</span> <span class="p">)&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">grid_dx</span><span class="p">(</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">),</span> <span class="p">&amp;</span>
                <span class="n">convergence_factor</span><span class="p">(</span> <span class="n">ix</span><span class="p">,</span> <span class="n">iy</span><span class="p">,</span> <span class="n">iz</span> <span class="p">)</span>
            <span class="k">IF</span><span class="p">(</span> <span class="n">ios</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span><span class="k">THEN</span>
<span class="k">              PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;...error when writing the arrays in &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                       <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">),</span> <span class="p">&amp;</span>
                       <span class="s2">&quot;. The error message is&quot;</span><span class="p">,</span> <span class="n">err_msg</span>
              <span class="k">STOP</span>
<span class="k">            </span><span class="n">ENDIF</span>
            <span class="c">!CALL test_status( ios, err_msg, &quot;...error in writing &quot; &amp;</span>
            <span class="c">!            // &quot;the arrays in &quot; // TRIM(name_cauchy_parts_ct) )</span>
          <span class="n">ENDDO</span>
        <span class="n">ENDDO</span>
      <span class="n">ENDDO</span>

      <span class="k">CLOSE</span><span class="p">(</span> <span class="n">UNIT</span><span class="o">=</span> <span class="n">unit_cauchy_parts_ct</span> <span class="p">)</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Convergence factor exported to formatted file &quot;</span><span class="p">,</span> <span class="p">&amp;</span>
                                                  <span class="nb">TRIM</span><span class="p">(</span><span class="n">name_cauchy_parts_ct</span><span class="p">)</span>
      <span class="k">PRINT</span> <span class="o">*</span>

    <span class="k">CASE </span><span class="n">DEFAULT</span>

      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot;** There is no well defined algorithm &quot;</span> <span class="p">&amp;</span>
               <span class="o">//</span> <span class="s2">&quot;corresponding to the number&quot;</span><span class="p">,</span> <span class="n">use_constraints</span>
      <span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s2">&quot; * Please set use_constraints to 1 or 2.&quot;</span>
      <span class="k">STOP</span>

<span class="k">    END SELECT </span><span class="n">choose_constraints</span>

    <span class="k">DEALLOCATE</span><span class="p">(</span> <span class="n">grid_dx</span> <span class="p">)</span>

  <span class="k">END SUBROUTINE </span><span class="n">cauchy_convergence_test_unknown</span>


<span class="k">END PROGRAM </span><span class="n">convergence_test</span>
</pre></div>

    </section>
    
    </div>
  </div>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>SPHINCS_ID was developed by Francesco Torsello<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2022-04-03 16:31:15           </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>